<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="theme-color" content="#0a0a0c" />
  <title>Perjalanan Kami ‚ù§</title>
  <style>
    * { 
      box-sizing: border-box; 
      margin: 0;
      padding: 0;
    }

    :root {
      --primary: #7aa2ff;
      --secondary: #9b7dff;
      --accent: #ff6b6b;
      --dark: #0a0a0c;
      --light: #eef0ff;
      --card-bg: rgba(16, 16, 28, 0.95);
    }

    /* ============ ANIMATIONS ============ */
    @keyframes float {
      0%, 100% { transform: translateY(0px) rotate(0deg); }
      50% { transform: translateY(-20px) rotate(5deg); }
    }

    @keyframes floatSlow {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-30px); }
    }

    @keyframes glow {
      0%, 100% { box-shadow: 0 0 20px rgba(122, 162, 255, 0.3); }
      50% { box-shadow: 0 0 40px rgba(155, 125, 255, 0.6); }
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(40px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @keyframes fadeOut {
      to { opacity: 0; pointer-events: none; }
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    @keyframes heartBeat {
      0%, 100% { transform: scale(1); }
      10%, 30% { transform: scale(1.2); }
      20%, 40% { transform: scale(1.1); }
    }

    @keyframes sparkle {
      0%, 100% { opacity: 0; transform: scale(0) rotate(0deg); }
      50% { opacity: 1; transform: scale(1) rotate(180deg); }
    }

    @keyframes slideInLeft {
      from {
        opacity: 0;
        transform: translateX(-60px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    @keyframes slideInRight {
      from {
        opacity: 0;
        transform: translateX(60px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    @keyframes ripple {
      0% {
        transform: scale(0);
        opacity: 1;
      }
      100% {
        transform: scale(4);
        opacity: 0;
      }
    }

    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      10%, 30%, 50%, 70%, 90% { transform: translateX(-10px); }
      20%, 40%, 60%, 80% { transform: translateX(10px); }
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }

    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes rainbow {
      0% { filter: hue-rotate(0deg); }
      100% { filter: hue-rotate(360deg); }
    }

    @keyframes wiggle {
      0%, 100% { transform: rotate(0deg); }
      25% { transform: rotate(-5deg); }
      75% { transform: rotate(5deg); }
    }

    @keyframes firework {
      0% {
        transform: scale(0);
        opacity: 1;
      }
      100% {
        transform: scale(3);
        opacity: 0;
      }
    }

    /* ============ BASE STYLES ============ */
    body {
      margin: 0;
      min-height: 100vh;
      background: radial-gradient(circle at 20% 50%, #1a1a2e, #0a0a0c);
      font-family: 'Georgia', 'Times New Roman', serif;
      color: var(--light);
      padding: 16px;
      overflow-x: hidden;
      position: relative;
      cursor: default;
      /* Mobile optimizations */
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      touch-action: manipulation;
    }

    /* Improve touch interactions */
    * {
      -webkit-tap-highlight-color: transparent;
    }
    
    button, a, .menu-card, .stat, .gallery-item {
      -webkit-tap-highlight-color: rgba(122, 162, 255, 0.2);
      touch-action: manipulation;
    }

    .cursor-trail {
      position: fixed;
      width: 10px;
      height: 10px;
      background: radial-gradient(circle, var(--primary), transparent);
      border-radius: 50%;
      pointer-events: none;
      z-index: 9999;
      animation: fadeOut 1s ease forwards;
    }

    /* ============ BACKGROUND EFFECTS ============ */
    .particles {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 1;
      overflow: hidden;
    }

    .particle {
      position: absolute;
      background: rgba(122, 162, 255, 0.4);
      border-radius: 50%;
      animation: float 8s infinite ease-in-out;
    }

    .stars {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 1;
    }

    .star {
      position: absolute;
      width: 2px;
      height: 2px;
      background: white;
      border-radius: 50%;
      animation: sparkle 3s infinite;
    }

    .bg-heart {
      position: absolute;
      font-size: 20px;
      opacity: 0.1;
      animation: floatSlow 15s infinite ease-in-out;
      pointer-events: none;
    }

    /* ============ LOADING SCREEN ============ */
    .loading {
      position: fixed;
      inset: 0;
      background: linear-gradient(135deg, #0a0a0c, #1a1a2e);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 30;
      animation: fadeOut 0.8s ease 1.5s forwards;
    }

    .loader {
      width: 60px;
      height: 60px;
      border: 4px solid rgba(122, 162, 255, 0.2);
      border-top-color: var(--primary);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-bottom: 20px;
    }

    .loading-text {
      font-size: 16px;
      opacity: 0.8;
      animation: pulse 2s infinite;
    }

    /* ============ PASSWORD GATE ============ */
    .overlay {
      position: fixed;
      inset: 0;
      background: rgba(8,8,12,.97);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 20;
      backdrop-filter: blur(15px);
      animation: fadeIn 0.5s ease;
    }

    .gate {
      width: 100%;
      max-width: 420px;
      background: linear-gradient(135deg, #1a1a28, #12121a);
      border-radius: 24px;
      padding: 40px 32px;
      text-align: center;
      box-shadow: 0 30px 90px rgba(0,0,0,.8);
      border: 1px solid rgba(122, 162, 255, 0.15);
      animation: fadeInUp 0.8s ease;
      position: relative;
      overflow: hidden;
    }

    .gate::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(122, 162, 255, 0.15) 0%, transparent 70%);
      animation: pulse 4s infinite;
    }

    .celebration-emoji {
      font-size: 70px;
      margin-bottom: 20px;
      animation: bounce 2s infinite;
      position: relative;
      z-index: 1;
    }

    .gate h2 {
      font-size: 28px;
      margin-bottom: 12px;
      background: linear-gradient(to right, var(--primary), var(--secondary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      position: relative;
      z-index: 1;
    }

    .gate p {
      margin-bottom: 30px;
      opacity: 0.9;
      font-size: 15px;
      position: relative;
      z-index: 1;
    }

    .password-input {
      width: 100%;
      padding: 16px 20px;
      border-radius: 12px;
      border: 2px solid rgba(122, 162, 255, 0.3);
      background: rgba(10, 10, 20, 0.8);
      color: var(--light);
      font-size: 16px;
      margin-bottom: 20px;
      transition: all 0.3s ease;
      position: relative;
      z-index: 1;
    }

    .password-input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 20px rgba(122, 162, 255, 0.3);
    }

    .toggle-password {
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      cursor: pointer;
      font-size: 20px;
      user-select: none;
      opacity: 0.6;
      transition: all 0.3s ease;
      z-index: 2;
    }

    .toggle-password:hover {
      opacity: 1;
      transform: translateY(-50%) scale(1.1);
    }

    .toggle-password:active {
      transform: translateY(-50%) scale(0.95);
    }

    .unlock-btn {
      width: 100%;
      padding: 16px;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 17px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 8px 20px rgba(122, 162, 255, 0.4);
      position: relative;
      overflow: hidden;
      z-index: 1;
    }

    .unlock-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 30px rgba(122, 162, 255, 0.5);
    }

    .unlock-btn:active {
      transform: translateY(0);
    }

    .error-msg {
      color: var(--accent);
      font-size: 14px;
      margin-top: 12px;
      opacity: 0;
      transition: opacity 0.3s ease;
      position: relative;
      z-index: 1;
    }

    .error-msg.show {
      opacity: 1;
      animation: shake 0.5s ease;
    }

    /* ============ USER SELECTION ============ */
    .user-selection {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
      margin: 30px 0;
      position: relative;
      z-index: 1;
    }

    .user-card {
      background: rgba(20, 20, 35, 0.8);
      border: 2px solid rgba(122, 162, 255, 0.2);
      border-radius: 16px;
      padding: 25px 15px;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .user-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, rgba(122, 162, 255, 0.1), rgba(155, 125, 255, 0.1));
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .user-card:hover::before {
      opacity: 1;
    }

    .user-card:hover {
      border-color: var(--primary);
      transform: translateY(-5px);
      box-shadow: 0 10px 30px rgba(122, 162, 255, 0.3);
    }

    .user-card.selected {
      border-color: var(--primary);
      background: rgba(122, 162, 255, 0.15);
      box-shadow: 0 0 30px rgba(122, 162, 255, 0.4);
    }

    .user-icon {
      font-size: 50px;
      margin-bottom: 10px;
    }

    .user-card h3 {
      font-size: 18px;
      margin-bottom: 5px;
      color: var(--light);
    }

    .user-card p {
      font-size: 13px;
      opacity: 0.7;
      margin: 0;
    }

    .password-section {
      animation: fadeInUp 0.5s ease;
    }

    .back-user-btn {
      width: 100%;
      padding: 12px;
      background: rgba(122, 162, 255, 0.1);
      color: var(--primary);
      border: 1px solid rgba(122, 162, 255, 0.3);
      border-radius: 10px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-top: 10px;
      position: relative;
      z-index: 1;
    }

    .back-user-btn:hover {
      background: rgba(122, 162, 255, 0.2);
      border-color: var(--primary);
    }

    /* ============ MAIN CONTAINER ============ */
    .container {
      max-width: 700px;
      margin: 0 auto;
      position: relative;
      z-index: 2;
      opacity: 0;
      animation: fadeIn 1s ease 2.3s forwards;
    }

    /* ============ HEADER ============ */
    .header {
      text-align: center;
      padding: 40px 20px 30px;
      animation: fadeInUp 1.2s ease;
    }

    .main-title {
      font-size: clamp(32px, 6vw, 48px);
      margin-bottom: 8px;
      background: linear-gradient(90deg, #9b7dff, #ffffff, #ff6b9d, #9b7dff, #ffffff, #ff6b9d);
      background-size: 300% 100%;
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      animation: gradientMove 5s ease infinite;
      cursor: pointer;
      transition: transform 0.3s ease;
    }

    .main-title:hover {
      transform: scale(1.05);
    }
    
    @keyframes gradientMove {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    .subtitle {
      font-size: clamp(18px, 3vw, 22px);
      opacity: 0.85;
      margin-bottom: 6px;
    }

    .date {
      font-size: 16px;
      opacity: 0.7;
      font-style: italic;
    }

    /* ============ STATS ============ */
    .stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 16px;
      margin: 40px 0;
      animation: slideInLeft 1s ease 0.3s both;
    }

    .stat {
      background: var(--card-bg);
      padding: 24px 20px;
      border-radius: 16px;
      text-align: center;
      border: 1px solid rgba(122, 162, 255, 0.2);
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .stat:hover {
      transform: translateY(-5px);
      border-color: var(--primary);
      box-shadow: 0 10px 30px rgba(122, 162, 255, 0.3);
    }

    .stat-number {
      font-size: 36px;
      font-weight: bold;
      background: linear-gradient(to right, var(--primary), var(--secondary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 8px;
    }

    .stat-label {
      font-size: 14px;
      opacity: 0.8;
    }

    /* ============ MENU GRID ============ */
    .menu-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 20px;
      margin: 40px 0;
      animation: fadeInUp 1s ease 0.6s both;
    }

    .menu-card {
      background: var(--card-bg);
      padding: 32px 24px;
      border-radius: 20px;
      text-align: center;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      border: 2px solid transparent;
      position: relative;
      overflow: hidden;
    }

    .menu-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .menu-card:hover {
      transform: translateY(-8px) scale(1.02);
      border-color: var(--primary);
      box-shadow: 0 20px 40px rgba(122, 162, 255, 0.4);
    }

    .menu-card:hover::before {
      opacity: 0.1;
    }

    .menu-card:active {
      transform: translateY(-4px) scale(0.98);
    }

    .menu-icon {
      font-size: 48px;
      margin-bottom: 16px;
      display: block;
      animation: float 3s infinite ease-in-out;
      position: relative;
      z-index: 1;
    }

    .menu-title {
      font-size: 20px;
      font-weight: 600;
      margin-bottom: 8px;
      position: relative;
      z-index: 1;
    }

    .menu-desc {
      font-size: 14px;
      opacity: 0.7;
      position: relative;
      z-index: 1;
    }

    /* ============ SECTIONS ============ */
    .section {
      display: none;
      animation: fadeInUp 0.6s ease;
      padding: 20px 0;
    }

    .section.active {
      display: block;
    }

    .section-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 32px;
      padding: 0 4px;
    }

    .back-btn {
      background: rgba(122, 162, 255, 0.15);
      border: 1px solid rgba(122, 162, 255, 0.3);
      color: var(--light);
      padding: 12px 20px;
      border-radius: 12px;
      font-size: 15px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .back-btn:hover {
      background: rgba(122, 162, 255, 0.25);
      transform: translateX(-4px);
    }
    
    .back-btn:active {
      transform: translateX(-2px) scale(0.98);
      background: rgba(122, 162, 255, 0.35);
    }

    .section-title {
      font-size: 28px;
      background: linear-gradient(to right, var(--primary), var(--secondary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    /* ============ CONTENT CARDS ============ */
    .content-card {
      background: var(--card-bg);
      padding: 32px 28px;
      border-radius: 20px;
      margin-bottom: 24px;
      border: 1px solid rgba(122, 162, 255, 0.15);
      line-height: 1.8;
    }

    .content-card p, .content-card h3, .content-card .quote,
    .love-list li, .timeline-item, .gallery-item {
      opacity: 0;
      transform: translateY(20px);
      transition: all 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    .content-card p.show, .content-card h3.show, .content-card .quote.show,
    .love-list li.show, .timeline-item.show, .gallery-item.show {
      opacity: 1;
      transform: translateY(0);
    }

    .content-card h3 {
      font-size: 22px;
      margin-bottom: 16px;
      color: var(--primary);
    }

    .content-card p {
      margin-bottom: 16px;
      font-size: 16px;
      opacity: 0.9;
    }

    .quote {
      background: rgba(122, 162, 255, 0.1);
      padding: 24px;
      border-radius: 12px;
      border-left: 4px solid var(--primary);
      font-style: italic;
      margin: 24px 0;
    }

    .reveal-btn {
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      color: white;
      border: none;
      padding: 14px 32px;
      border-radius: 12px;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 6px 20px rgba(122, 162, 255, 0.3);
      margin-top: 20px;
      position: relative;
      overflow: hidden;
    }

    .reveal-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(122, 162, 255, 0.4);
    }

    .ripple {
      position: absolute;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.5);
      animation: ripple 0.7s ease-out;
      pointer-events: none;
    }

    /* ============ LOVE LIST ============ */
    .love-list {
      list-style: none;
      padding: 0;
    }

    .love-list li {
      background: rgba(122, 162, 255, 0.08);
      padding: 20px;
      border-radius: 12px;
      margin-bottom: 16px;
      border-left: 4px solid var(--primary);
      font-size: 16px;
      transition: all 0.3s ease;
    }

    .love-list li:hover {
      background: rgba(122, 162, 255, 0.15);
      transform: translateX(8px);
    }

    /* ============ TIMELINE ============ */
    .timeline {
      position: relative;
      padding-left: 40px;
    }

    .timeline::before {
      content: '';
      position: absolute;
      left: 18px;
      top: 0;
      bottom: 0;
      width: 2px;
      background: linear-gradient(to bottom, var(--primary), var(--secondary));
    }

    .timeline-item {
      position: relative;
      margin-bottom: 32px;
      padding-left: 32px;
    }

    .timeline-item::before {
      content: 'üí´';
      position: absolute;
      left: -28px;
      top: 0;
      width: 36px;
      height: 36px;
      background: var(--card-bg);
      border: 2px solid var(--primary);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
    }

    .timeline-date {
      font-size: 14px;
      color: var(--primary);
      font-weight: 600;
      margin-bottom: 8px;
    }

    .timeline-content {
      background: rgba(122, 162, 255, 0.08);
      padding: 20px;
      border-radius: 12px;
      font-size: 15px;
    }

    /* ============ GALLERY ============ */
    .gallery-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 16px;
      margin-top: 24px;
    }

    .gallery-item {
      aspect-ratio: 1;
      background: var(--card-bg);
      border-radius: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 60px;
      cursor: pointer;
      transition: all 0.3s ease;
      border: 2px solid transparent;
      position: relative;
      overflow: hidden;
    }

    .gallery-item::before {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .gallery-item:hover {
      transform: scale(1.1) rotate(5deg);
      border-color: var(--primary);
      box-shadow: 0 10px 30px rgba(122, 162, 255, 0.4);
    }

    .gallery-item:hover::before {
      opacity: 0.2;
    }

    .gallery-item span {
      position: relative;
      z-index: 1;
    }

    /* ============ MEMORIES ============ */
    .memories-grid {
      display: grid;
      gap: 20px;
    }

    .memory-card {
      background: var(--card-bg);
      padding: 28px;
      border-radius: 20px;
      border: 1px solid rgba(122, 162, 255, 0.15);
      transition: all 0.3s ease;
    }

    .memory-card:hover {
      border-color: var(--primary);
      transform: translateY(-4px);
      box-shadow: 0 12px 30px rgba(122, 162, 255, 0.3);
    }

    .memory-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 16px;
    }

    .memory-icon {
      font-size: 32px;
    }

    .memory-title {
      font-size: 20px;
      font-weight: 600;
      color: var(--primary);
    }

    .memory-desc {
      font-size: 15px;
      line-height: 1.7;
      opacity: 0.9;
    }

    /* ============ MILESTONES ============ */
    .milestone-header {
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      font-size: 24px;
      margin-bottom: 24px;
      padding-left: 16px;
      border-left: 4px solid var(--primary);
    }

    /* ============ PENUTUP (ENDING) ============ */
    .ending-content {
      text-align: center;
      padding: 40px 0;
    }

    .big-heart {
      font-size: 120px;
      margin: 32px 0;
      opacity: 0;
      transform: scale(0);
      transition: all 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      cursor: pointer;
      display: inline-block;
    }

    .big-heart.show {
      opacity: 1;
      transform: scale(1);
      animation: heartBeat 1.5s infinite;
    }

    .big-heart:hover {
      transform: scale(1.2);
    }

    .sparkle {
      position: fixed;
      width: 8px;
      height: 8px;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      border-radius: 50%;
      pointer-events: none;
      animation: sparkle 1.5s ease forwards;
      z-index: 1000;
    }

    .final-message {
      font-size: clamp(24px, 4vw, 32px);
      font-weight: 600;
      margin: 24px 0;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .signature {
      font-size: 18px;
      opacity: 0.8;
      font-style: italic;
      margin-top: 32px;
    }

    /* ============ FINAL LETTER STYLES ============ */
    .final-letter-section {
      margin-top: 50px;
      padding-top: 40px;
      border-top: 2px solid rgba(122, 162, 255, 0.2);
    }

    .final-letter-locked {
      text-align: center;
      padding: 40px 20px;
    }

    .final-letter-unlocked {
      text-align: center;
      padding: 30px 20px;
      animation: fadeInUp 1s ease;
    }

    .letter-content {
      animation: fadeInUp 1.2s ease;
    }

    .letter-content p {
      font-size: 15px;
      line-height: 1.8;
    }

    .letter-content strong {
      color: var(--primary);
    }

    #letterPassword {
      transition: all 0.3s ease;
    }

    #letterPassword:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 20px rgba(122, 162, 255, 0.3);
    }

    .final-letter-locked button:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(122, 162, 255, 0.4);
    }

    .final-letter-locked button:active {
      transform: translateY(0);
    }

    /* ============ SECRET MESSAGE ============ */
    .secret-message {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0);
      background: linear-gradient(135deg, #1a1a28, #12121a);
      padding: 40px;
      border-radius: 24px;
      box-shadow: 0 30px 90px rgba(0, 0, 0, 0.9);
      border: 2px solid var(--primary);
      z-index: 25;
      max-width: 90%;
      width: 400px;
      text-align: center;
      opacity: 0;
      transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    .secret-message.show {
      transform: translate(-50%, -50%) scale(1);
      opacity: 1;
    }

    .secret-message h3 {
      font-size: 28px;
      margin-bottom: 16px;
      color: var(--primary);
    }

    .secret-message p {
      font-size: 16px;
      line-height: 1.8;
      margin-bottom: 24px;
    }

    .close-secret {
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      color: white;
      border: none;
      padding: 12px 28px;
      border-radius: 10px;
      cursor: pointer;
      font-size: 15px;
      transition: all 0.3s ease;
    }

    .close-secret:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(122, 162, 255, 0.4);
    }

    /* ============ MUSIC CONTROL - DIPINDAHKAN KE KIRI ATAS ============ */
    .music-control {
      position: fixed;
      top: 20px;
      left: 20px;
      z-index: 15;
      background: var(--card-bg);
      padding: 12px 18px;
      border-radius: 50px;
      border: 2px solid rgba(122, 162, 255, 0.3);
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 10px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
      backdrop-filter: blur(10px);
    }

    .music-control:hover {
      border-color: var(--primary);
      box-shadow: 0 6px 20px rgba(122, 162, 255, 0.4);
      transform: scale(1.05);
    }

    .music-icon {
      font-size: 20px;
    }

    .music-control.playing .music-icon {
      /* animation disabled */
    }

    .music-text {
      font-size: 13px;
      font-weight: 500;
    }

    /* ============ NOTIFICATION ============ */
    .notification {
      position: fixed;
      top: 80px;
      left: 50%;
      transform: translateX(-50%) translateY(-100px);
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      color: white;
      padding: 16px 28px;
      border-radius: 50px;
      font-size: 15px;
      font-weight: 500;
      box-shadow: 0 10px 30px rgba(122, 162, 255, 0.5);
      z-index: 26;
      opacity: 0;
      transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      pointer-events: none; /* Don't block clicks */
    }

    .notification.show {
      transform: translateX(-50%) translateY(0);
      opacity: 1;
    }

    /* ============ RESPONSIVE ============ */
    @media (max-width: 768px) {
      .header {
        padding: 30px 16px 20px;
      }

      .stats {
        grid-template-columns: repeat(3, 1fr);
        gap: 10px;
        margin: 30px 0;
      }

      .stat {
        padding: 18px 10px;
      }

      .stat-number {
        font-size: 26px;
      }

      .stat-label {
        font-size: 12px;
      }

      .menu-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 14px;
        margin: 30px 0;
      }

      .menu-card {
        padding: 24px 16px;
      }

      .menu-icon {
        font-size: 40px;
        margin-bottom: 10px;
      }

      .menu-label {
        font-size: 14px;
      }

      .content-card {
        padding: 24px 18px;
        margin: 20px 0;
      }

      .gallery-grid {
        grid-template-columns: repeat(3, 1fr);
        gap: 10px;
      }

      .gallery-item {
        font-size: 44px;
      }

      .big-heart {
        font-size: 70px;
      }

      .music-control {
        top: 10px;
        left: 10px;
        padding: 10px 14px;
        font-size: 14px;
      }

      .music-icon {
        font-size: 18px;
      }

      .music-text {
        font-size: 12px;
      }

      .notification {
        top: 70px;
        max-width: 85%;
        padding: 12px 18px;
        font-size: 14px;
      }

      /* Better touch targets for mobile */
      button, .menu-card, .stat, .gallery-item {
        min-height: 44px;
        -webkit-tap-highlight-color: rgba(122, 162, 255, 0.3);
      }
      
      .back-btn {
        padding: 14px 24px; /* Larger touch target on mobile */
        min-height: 48px;
      }

      /* Improve scrolling on mobile */
      body {
        -webkit-overflow-scrolling: touch;
        overflow-x: hidden;
      }
      
      /* Make cards more compact on mobile */
      .timeline-content h3 {
        font-size: 16px;
      }
      
      .timeline-content p {
        font-size: 13px;
      }

      /* Optimize forms for mobile */
      input, textarea, select {
        font-size: 16px; /* Prevents zoom on iOS */
      }
      
      /* Better spacing for password gate on mobile */
      .gate {
        padding: 32px 24px;
        margin: 0 10px;
      }
      
      .celebration-emoji {
        font-size: 60px;
      }
      
      .gate h2 {
        font-size: 24px;
      }
    }

    @media (max-width: 480px) {
      /* Single column layout for very small screens */
      .stats {
        grid-template-columns: 1fr;
        gap: 10px;
      }
      
      .stat {
        padding: 16px;
      }

      .menu-grid {
        grid-template-columns: 1fr;
        gap: 12px;
      }

      .timeline {
        padding-left: 30px;
      }

      .timeline::before {
        left: 14px;
      }

      .timeline-item::before {
        left: -24px;
        width: 32px;
        height: 32px;
        font-size: 14px;
      }
      
      /* Smaller text for tiny screens */
      .main-title {
        font-size: 28px;
      }
      
      .subtitle {
        font-size: 16px;
      }
      
      /* Better gallery layout */
      .gallery-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 8px;
      }
      
      .gallery-item {
        font-size: 40px;
      }
      
      /* Compact game cards */
      .game-menu-card {
        padding: 20px 16px;
      }
      
      /* Optimize modal for small screens */
      .modal-content {
        width: 95%;
        max-width: none;
        margin: 10px;
        padding: 20px 16px;
      }
      
      /* Better forms on small screens */
      .gate {
        padding: 24px 20px;
      }
      
      .password-input {
        font-size: 16px;
        padding: 14px 16px;
      }
      
      /* Reduce particle animations on mobile for better performance */
      .particle {
        display: none;
      }
      
      .star {
        display: none; /* Hide stars on small mobile for performance */
      }
      
      .bg-heart {
        font-size: 16px;
      }
    }

    /* ============ MOBILE LANDSCAPE ORIENTATION ============ */
    @media (max-width: 896px) and (orientation: landscape) {
      body {
        padding: 12px;
      }
      
      .header {
        padding: 20px 16px 16px;
      }
      
      .main-title {
        font-size: 32px;
      }
      
      .subtitle {
        font-size: 18px;
      }
      
      .stats {
        grid-template-columns: repeat(3, 1fr);
        gap: 10px;
        margin: 20px 0;
      }
      
      .stat {
        padding: 14px 10px;
      }
      
      .stat-number {
        font-size: 24px;
      }
      
      .menu-grid {
        grid-template-columns: repeat(3, 1fr);
        gap: 12px;
        margin: 20px 0;
      }
      
      .menu-card {
        padding: 20px 14px;
      }
      
      .content-card {
        padding: 20px 16px;
        margin: 16px 0;
      }
      
      .modal-content {
        max-height: 85vh;
        overflow-y: auto;
      }
    }

    /* ============ RAINBOW MODE ============ */
    body.rainbow-mode {
      animation: rainbow 5s linear infinite;
    }

    body.rainbow-mode .menu-card,
    body.rainbow-mode .content-card,
    body.rainbow-mode .stat {
      animation: rainbow 5s linear infinite;
    }

    /* ============ GAME STYLES ============ */
    .games-menu {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin: 20px 0;
    }

    .game-menu-card {
      background: linear-gradient(135deg, rgba(122, 162, 255, 0.1), rgba(155, 125, 255, 0.1));
      border: 2px solid rgba(122, 162, 255, 0.3);
      border-radius: 16px;
      padding: 30px 20px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .game-menu-card:hover {
      transform: translateY(-5px);
      border-color: rgba(122, 162, 255, 0.6);
      box-shadow: 0 10px 30px rgba(122, 162, 255, 0.3);
    }

    .game-menu-icon {
      font-size: 50px;
      display: block;
      margin-bottom: 15px;
    }

    .game-menu-title {
      font-size: 20px;
      margin-bottom: 10px;
      color: var(--light);
    }

    .game-menu-desc {
      font-size: 14px;
      opacity: 0.8;
      margin: 0;
    }

    .game-container {
      padding: 20px 0;
    }

    .game-header {
      display: flex;
      justify-content: space-around;
      margin-bottom: 30px;
      gap: 15px;
      flex-wrap: wrap;
    }

    .game-info {
      background: linear-gradient(135deg, rgba(122, 162, 255, 0.15), rgba(155, 125, 255, 0.15));
      padding: 12px 20px;
      border-radius: 12px;
      border: 1px solid rgba(122, 162, 255, 0.3);
      min-width: 100px;
      text-align: center;
    }

    .game-label {
      display: block;
      font-size: 12px;
      opacity: 0.7;
      margin-bottom: 5px;
    }

    .game-score,
    .game-time {
      font-size: 24px;
      font-weight: bold;
      background: linear-gradient(135deg, #e8b4d4, #d4a5c0);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .game-lives {
      font-size: 20px;
    }

    .game-board {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 15px;
      max-width: 400px;
      margin: 0 auto 30px;
      padding: 20px;
      background: rgba(16, 16, 28, 0.5);
      border-radius: 16px;
      border: 2px solid rgba(122, 162, 255, 0.2);
    }

    .game-hole {
      aspect-ratio: 1;
      background: radial-gradient(circle, rgba(10, 10, 12, 0.8), rgba(26, 26, 46, 0.9));
      border-radius: 50%;
      border: 3px solid rgba(122, 162, 255, 0.3);
      position: relative;
      cursor: pointer;
      transition: all 0.2s ease;
      box-shadow: inset 0 4px 10px rgba(0, 0, 0, 0.5);
    }

    .game-hole:hover {
      border-color: rgba(122, 162, 255, 0.6);
      transform: scale(1.05);
    }

    .game-heart {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0);
      font-size: 40px;
      animation: popUp 0.3s ease forwards;
      cursor: pointer;
      user-select: none;
    }

    @keyframes popUp {
      0% {
        transform: translate(-50%, -50%) scale(0);
      }
      50% {
        transform: translate(-50%, -50%) scale(1.2);
      }
      100% {
        transform: translate(-50%, -50%) scale(1);
      }
    }

    .game-heart.clicked {
      animation: heartPop 0.4s ease forwards;
    }

    @keyframes heartPop {
      0% {
        transform: translate(-50%, -50%) scale(1);
        opacity: 1;
      }
      50% {
        transform: translate(-50%, -50%) scale(1.5);
      }
      100% {
        transform: translate(-50%, -50%) scale(0);
        opacity: 0;
      }
    }

    .game-controls {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin-bottom: 20px;
    }

    .game-btn {
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      color: white;
      border: none;
      padding: 15px 30px;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(122, 162, 255, 0.3);
    }

    .game-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(122, 162, 255, 0.4);
    }

    .game-btn:active {
      transform: translateY(0);
    }

    .game-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .game-message {
      text-align: center;
      font-size: 18px;
      font-weight: bold;
      min-height: 30px;
      margin-bottom: 20px;
      background: linear-gradient(135deg, #e8b4d4, #d4a5c0);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .game-instructions {
      background: rgba(122, 162, 255, 0.1);
      padding: 20px;
      border-radius: 12px;
      border: 1px solid rgba(122, 162, 255, 0.2);
      margin-top: 20px;
    }

    .game-instructions h4 {
      margin-bottom: 15px;
      color: var(--light);
    }

    .game-instructions p {
      margin: 8px 0;
      opacity: 0.9;
      font-size: 14px;
    }

    /* Memory Card Game */
    .memory-board {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 15px;
      max-width: 500px;
      margin: 0 auto 30px;
      padding: 20px;
      background: rgba(16, 16, 28, 0.5);
      border-radius: 16px;
      border: 2px solid rgba(122, 162, 255, 0.2);
    }

    .memory-board .memory-card {
      aspect-ratio: 1;
      background: transparent;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      position: relative;
      transform-style: preserve-3d;
      transition: transform 0.6s;
      opacity: 1 !important; /* Override content-card opacity */
    }

    .memory-board .memory-card:hover:not(.flipped):not(.matched) {
      transform: scale(1.05);
    }

    .memory-board .memory-card.flipped {
      transform: rotateY(180deg);
    }

    .memory-board .memory-card.matched {
      opacity: 0.6;
      cursor: default;
      transform: rotateY(180deg);
    }

    .memory-card-front,
    .memory-card-back {
      position: absolute;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      backface-visibility: hidden;
      border-radius: 12px;
      font-size: 40px;
      border: 2px solid rgba(122, 162, 255, 0.4);
    }

    .memory-card-front {
      background: linear-gradient(135deg, rgba(122, 162, 255, 0.3), rgba(155, 125, 255, 0.3));
      border-color: rgba(122, 162, 255, 0.4);
    }

    .memory-card-back {
      background: linear-gradient(135deg, rgba(232, 180, 212, 0.3), rgba(212, 165, 192, 0.3));
      border-color: rgba(232, 180, 212, 0.6);
      transform: rotateY(180deg);
    }

    /* Quiz Game */
    .quiz-container {
      max-width: 600px;
      margin: 0 auto;
    }

    .quiz-progress {
      text-align: center;
      margin-bottom: 30px;
      font-size: 16px;
      opacity: 0.8;
    }

    .quiz-question {
      background: linear-gradient(135deg, rgba(122, 162, 255, 0.15), rgba(155, 125, 255, 0.15));
      padding: 30px;
      border-radius: 16px;
      border: 2px solid rgba(122, 162, 255, 0.3);
      margin-bottom: 30px;
      text-align: center;
      font-size: 20px;
      font-weight: 600;
      min-height: 100px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .quiz-options {
      display: grid;
      gap: 15px;
      margin-bottom: 30px;
    }

    .quiz-option {
      background: linear-gradient(135deg, rgba(122, 162, 255, 0.1), rgba(155, 125, 255, 0.1));
      border: 2px solid rgba(122, 162, 255, 0.3);
      padding: 20px;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: center;
      font-size: 16px;
    }

    .quiz-option:hover {
      border-color: rgba(122, 162, 255, 0.6);
      transform: translateX(5px);
      background: linear-gradient(135deg, rgba(122, 162, 255, 0.2), rgba(155, 125, 255, 0.2));
    }

    .quiz-option.correct {
      background: linear-gradient(135deg, rgba(107, 207, 127, 0.3), rgba(107, 207, 127, 0.2));
      border-color: rgba(107, 207, 127, 0.6);
      animation: pulse 0.5s ease;
    }

    .quiz-option.wrong {
      background: linear-gradient(135deg, rgba(255, 107, 107, 0.3), rgba(255, 107, 107, 0.2));
      border-color: rgba(255, 107, 107, 0.6);
      animation: shake 0.5s ease;
    }

    .quiz-option.disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .quiz-result {
      text-align: center;
      padding: 30px;
      background: linear-gradient(135deg, rgba(122, 162, 255, 0.15), rgba(155, 125, 255, 0.15));
      border-radius: 16px;
      border: 2px solid rgba(122, 162, 255, 0.3);
    }

    .quiz-result h3 {
      font-size: 28px;
      margin-bottom: 15px;
      background: linear-gradient(135deg, #e8b4d4, #d4a5c0);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .quiz-result p {
      font-size: 18px;
      margin-bottom: 20px;
      opacity: 0.9;
    }

    .quiz-score-display {
      font-size: 48px;
      font-weight: bold;
      margin: 20px 0;
      background: linear-gradient(135deg, #e8b4d4, #d4a5c0);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    /* Truth or Dare Game */
    .tod-container {
      max-width: 600px;
      margin: 0 auto;
    }

    .tod-choice-screen {
      text-align: center;
      padding: 40px 20px;
    }

    .tod-question {
      font-size: 28px;
      margin-bottom: 40px;
      color: var(--light);
    }

    .tod-buttons {
      display: flex;
      gap: 20px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .tod-btn {
      flex: 1;
      min-width: 150px;
      max-width: 200px;
      padding: 30px 20px;
      border: none;
      border-radius: 20px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
      font-size: 18px;
      font-weight: bold;
    }

    .truth-btn {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
    }

    .truth-btn:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 40px rgba(102, 126, 234, 0.6);
    }

    .dare-btn {
      background: linear-gradient(135deg, #f093fb, #f5576c);
      color: white;
      box-shadow: 0 10px 30px rgba(245, 87, 108, 0.4);
    }

    .dare-btn:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 40px rgba(245, 87, 108, 0.6);
    }

    .tod-btn-icon {
      font-size: 40px;
    }

    .tod-result-screen {
      text-align: center;
      padding: 40px 20px;
    }

    .tod-type-badge {
      display: inline-block;
      padding: 10px 30px;
      border-radius: 50px;
      font-size: 16px;
      font-weight: bold;
      margin-bottom: 30px;
      text-transform: uppercase;
    }

    .tod-type-badge.truth {
      background: linear-gradient(135deg, #667eea, #764ba2);
    }

    .tod-type-badge.dare {
      background: linear-gradient(135deg, #f093fb, #f5576c);
    }

    .tod-challenge {
      font-size: 24px;
      line-height: 1.6;
      padding: 40px 30px;
      background: linear-gradient(135deg, rgba(122, 162, 255, 0.15), rgba(155, 125, 255, 0.15));
      border-radius: 20px;
      border: 2px solid rgba(122, 162, 255, 0.3);
      margin-bottom: 30px;
      min-height: 150px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .tod-actions {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .tod-stats {
      display: flex;
      gap: 30px;
      justify-content: center;
      padding: 20px;
      background: rgba(122, 162, 255, 0.1);
      border-radius: 12px;
      font-size: 16px;
    }

    /* Spin the Wheel Game */
    .wheel-container {
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 30px;
      margin: 30px 0;
    }

    #wheelCanvas {
      max-width: 100%;
      height: auto;
      border-radius: 50%;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
      touch-action: none; /* Prevent scroll while spinning */
    }

    .wheel-spin-btn {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 100px;
      height: 100px;
      border-radius: 50%;
      border: none;
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 5px;
      box-shadow: 0 5px 20px rgba(102, 126, 234, 0.5);
      z-index: 10;
    }

    .wheel-spin-btn:hover:not(:disabled) {
      transform: translate(-50%, -50%) scale(1.1);
      box-shadow: 0 8px 30px rgba(102, 126, 234, 0.7);
    }

    .wheel-spin-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    .wheel-spin-icon {
      font-size: 30px;
    }

    .wheel-result {
      text-align: center;
      font-size: 22px;
      font-weight: bold;
      padding: 30px;
      background: linear-gradient(135deg, rgba(122, 162, 255, 0.15), rgba(155, 125, 255, 0.15));
      border-radius: 16px;
      border: 2px solid rgba(122, 162, 255, 0.3);
      min-height: 100px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 20px 0;
    }

    .wheel-stats {
      background: rgba(122, 162, 255, 0.1);
      padding: 20px;
      border-radius: 12px;
      margin: 20px 0;
    }

    .wheel-stats h4 {
      margin-bottom: 15px;
      color: var(--light);
    }

    #wheelStatsDisplay {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 10px;
    }

    .wheel-stat-item {
      padding: 10px;
      background: rgba(122, 162, 255, 0.15);
      border-radius: 8px;
      text-align: center;
      font-size: 14px;
    }

    /* Difficulty Selector */
    .difficulty-selector {
      margin-bottom: 30px;
      padding: 20px;
      background: linear-gradient(135deg, rgba(122, 162, 255, 0.1), rgba(155, 125, 255, 0.1));
      border-radius: 16px;
      border: 2px solid rgba(122, 162, 255, 0.3);
    }

    .difficulty-btn {
      padding: 20px 30px;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 16px;
      font-weight: bold;
      color: white;
      min-width: 120px;
    }

    .easy-btn {
      background: linear-gradient(135deg, #6bcf7f, #5fb574);
      box-shadow: 0 4px 15px rgba(107, 207, 127, 0.4);
    }

    .easy-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 20px rgba(107, 207, 127, 0.6);
    }

    .medium-btn {
      background: linear-gradient(135deg, #ffa726, #fb8c00);
      box-shadow: 0 4px 15px rgba(255, 167, 38, 0.4);
    }

    .medium-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 20px rgba(255, 167, 38, 0.6);
    }

    .hard-btn {
      background: linear-gradient(135deg, #ef5350, #e53935);
      box-shadow: 0 4px 15px rgba(239, 83, 80, 0.4);
    }

    .hard-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 20px rgba(239, 83, 80, 0.6);
    }

    /* ============ CATATAN BERSAMA STYLES ============ */
    .catatan-container {
      max-width: 800px;
      margin: 0 auto;
    }

    .catatan-input-area {
      background: linear-gradient(135deg, rgba(122, 162, 255, 0.1), rgba(155, 125, 255, 0.1));
      padding: 25px;
      border-radius: 20px;
      border: 2px solid rgba(122, 162, 255, 0.3);
      margin-bottom: 30px;
    }

    .catatan-input-area h3 {
      font-size: 20px;
      margin-bottom: 15px;
      color: var(--primary);
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .catatan-form {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .catatan-textarea {
      width: 100%;
      min-height: 100px;
      padding: 15px;
      border-radius: 12px;
      border: 2px solid rgba(122, 162, 255, 0.3);
      background: rgba(16, 16, 28, 0.8);
      color: var(--light);
      font-size: 15px;
      font-family: inherit;
      resize: vertical;
      transition: all 0.3s ease;
    }

    .catatan-textarea:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 20px rgba(122, 162, 255, 0.3);
    }

    .catatan-textarea::placeholder {
      opacity: 0.5;
    }

    .char-counter {
      text-align: right;
      font-size: 13px;
      opacity: 0.7;
      margin: 8px 5px;
      color: var(--light);
    }

    .char-counter.warning {
      color: #ffaa00;
      font-weight: bold;
    }

    .char-counter.danger {
      color: #ff6b6b;
      font-weight: bold;
    }

    .catatan-submit-btn {
      padding: 12px 30px;
      border-radius: 25px;
      border: none;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      color: white;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 16px;
      align-self: flex-end;
    }

    .catatan-submit-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(122, 162, 255, 0.4);
    }

    .catatan-submit-btn:active {
      transform: translateY(0);
    }

    .catatan-list {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .catatan-item {
      background: var(--card-bg);
      padding: 20px;
      border-radius: 16px;
      border: 1px solid rgba(122, 162, 255, 0.15);
      transition: all 0.3s ease;
      animation: slideInRight 0.5s ease;
      position: relative;
      overflow: visible;
    }

    .catatan-item::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 4px;
      height: 100%;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .catatan-item:hover {
      border-color: var(--primary);
      transform: translateX(5px);
      box-shadow: 0 8px 25px rgba(122, 162, 255, 0.2);
    }

    .catatan-item:hover::before {
      opacity: 1;
    }

    .catatan-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 12px;
      gap: 10px;
      position: relative;
      z-index: 1;
    }

    .catatan-author {
      font-size: 14px;
      font-weight: 600;
      color: var(--primary);
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .catatan-folder-badge {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      padding: 4px 10px;
      background: linear-gradient(135deg, rgba(155, 125, 255, 0.2), rgba(122, 162, 255, 0.2));
      border: 1px solid rgba(155, 125, 255, 0.3);
      border-radius: 12px;
      font-size: 12px;
      font-weight: 500;
      color: var(--secondary);
      margin-left: 8px;
    }

    .catatan-timestamp {
      font-size: 12px;
      opacity: 0.6;
      white-space: nowrap;
    }

    .catatan-text {
      font-size: 15px;
      line-height: 1.7;
      margin-bottom: 12px;
      white-space: pre-wrap;
      word-wrap: break-word;
    }

    .catatan-actions {
      display: flex;
      gap: 10px;
      justify-content: flex-end;
      padding-top: 10px;
      border-top: 1px solid rgba(122, 162, 255, 0.1);
    }

    .catatan-delete-btn {
      background: transparent;
      border: none;
      cursor: pointer;
      font-size: 18px;
      opacity: 0.6;
      transition: all 0.3s ease;
      padding: 5px 10px;
      border-radius: 8px;
    }

    .catatan-delete-btn:hover {
      opacity: 1;
      background: rgba(255, 107, 107, 0.2);
      transform: scale(1.1);
    }

    .catatan-empty {
      text-align: center;
      padding: 60px 20px;
      opacity: 0.6;
    }

    .catatan-empty-icon {
      font-size: 60px;
      margin-bottom: 15px;
    }

    .catatan-stats {
      display: flex;
      gap: 20px;
      justify-content: center;
      margin-bottom: 30px;
      flex-wrap: wrap;
    }

    .catatan-stat-item {
      background: linear-gradient(135deg, rgba(122, 162, 255, 0.15), rgba(155, 125, 255, 0.15));
      padding: 15px 25px;
      border-radius: 12px;
      text-align: center;
      border: 1px solid rgba(122, 162, 255, 0.2);
    }

    .catatan-stat-number {
      font-size: 24px;
      font-weight: bold;
      color: var(--primary);
    }

    .catatan-stat-label {
      font-size: 12px;
      opacity: 0.8;
      margin-top: 5px;
    }

    /* ============ NEW: Author Name Input ============ */
    .catatan-author-input {
      display: flex;
      gap: 10px;
      align-items: center;
      margin-bottom: 15px;
    }

    .catatan-author-input label {
      font-size: 14px;
      color: var(--primary);
      white-space: nowrap;
    }

    .catatan-author-select {
      flex: 1;
      padding: 10px 15px;
      border-radius: 10px;
      border: 2px solid rgba(122, 162, 255, 0.3);
      background: rgba(16, 16, 28, 0.8);
      color: var(--light);
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .catatan-author-select:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 15px rgba(122, 162, 255, 0.3);
    }

    /* ============ NEW: Folder/Category Input ============ */
    .catatan-folder-input {
      display: flex;
      gap: 10px;
      align-items: center;
      margin-bottom: 15px;
    }

    .catatan-folder-input label {
      font-size: 14px;
      color: var(--secondary);
      white-space: nowrap;
    }

    .catatan-folder-select {
      flex: 1;
      padding: 10px 15px;
      border-radius: 10px;
      border: 2px solid rgba(155, 125, 255, 0.3);
      background: rgba(16, 16, 28, 0.8);
      color: var(--light);
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .catatan-folder-select:focus {
      outline: none;
      border-color: var(--secondary);
      box-shadow: 0 0 15px rgba(155, 125, 255, 0.3);
    }

    .folder-input-wrapper {
      display: flex;
      gap: 8px;
      align-items: center;
      flex: 1;
    }

    .folder-add-quick-btn {
      padding: 10px 14px;
      background: linear-gradient(135deg, rgba(122, 162, 255, 0.2), rgba(155, 125, 255, 0.2));
      border: 2px solid rgba(122, 162, 255, 0.4);
      border-radius: 10px;
      cursor: pointer;
      font-size: 16px;
      transition: all 0.3s ease;
      color: var(--primary);
      font-weight: bold;
    }

    .folder-add-quick-btn:hover {
      background: linear-gradient(135deg, rgba(122, 162, 255, 0.3), rgba(155, 125, 255, 0.3));
      transform: translateY(-2px) scale(1.05);
      box-shadow: 0 5px 15px rgba(122, 162, 255, 0.4);
    }

    .folder-manage-btn {
      padding: 10px 14px;
      background: linear-gradient(135deg, rgba(155, 125, 255, 0.2), rgba(122, 162, 255, 0.2));
      border: 2px solid rgba(155, 125, 255, 0.4);
      border-radius: 10px;
      cursor: pointer;
      font-size: 16px;
      transition: all 0.3s ease;
    }

    .folder-manage-btn:hover {
      background: linear-gradient(135deg, rgba(155, 125, 255, 0.3), rgba(122, 162, 255, 0.3));
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(155, 125, 255, 0.3);
    }

    /* Quick Folder Add */
    .quick-folder-add {
      display: flex;
      gap: 8px;
      align-items: center;
      margin-bottom: 15px;
      padding: 12px;
      background: rgba(122, 162, 255, 0.05);
      border: 2px dashed rgba(122, 162, 255, 0.3);
      border-radius: 12px;
      animation: slideDown 0.3s ease;
    }

    .quick-folder-input {
      flex: 1;
      padding: 10px 15px;
      border-radius: 10px;
      border: 2px solid rgba(122, 162, 255, 0.3);
      background: rgba(16, 16, 28, 0.8);
      color: var(--light);
      font-size: 14px;
      transition: all 0.3s ease;
    }

    .quick-folder-input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 15px rgba(122, 162, 255, 0.3);
    }

    .quick-folder-create-btn {
      padding: 10px 16px;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      border: none;
      border-radius: 10px;
      color: white;
      cursor: pointer;
      font-size: 18px;
      font-weight: bold;
      transition: all 0.3s ease;
    }

    .quick-folder-create-btn:hover {
      transform: scale(1.1);
      box-shadow: 0 5px 15px rgba(122, 162, 255, 0.5);
    }

    .quick-folder-cancel-btn {
      padding: 10px 16px;
      background: rgba(255, 107, 107, 0.2);
      border: 2px solid rgba(255, 107, 107, 0.4);
      border-radius: 10px;
      color: var(--accent);
      cursor: pointer;
      font-size: 18px;
      font-weight: bold;
      transition: all 0.3s ease;
    }

    .quick-folder-cancel-btn:hover {
      background: rgba(255, 107, 107, 0.3);
      transform: scale(1.1);
    }

    /* ============ Folder Manager Modal ============ */
    .folder-manager-modal {
      position: fixed;
      inset: 0;
      background: rgba(8, 8, 12, 0.95);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 25;
      animation: fadeIn 0.3s ease;
      padding: 20px;
    }

    .folder-manager-content {
      background: linear-gradient(135deg, #1a1a28, #12121a);
      border-radius: 20px;
      padding: 30px;
      max-width: 500px;
      width: 100%;
      max-height: 80vh;
      overflow-y: auto;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.8);
    }

    .folder-manager-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 25px;
    }

    .folder-manager-header h3 {
      font-size: 22px;
      color: var(--secondary);
    }

    .folder-manager-close {
      background: transparent;
      border: none;
      font-size: 28px;
      cursor: pointer;
      opacity: 0.6;
      transition: all 0.3s ease;
      color: var(--light);
    }

    .folder-manager-close:hover {
      opacity: 1;
      transform: rotate(90deg);
    }

    .folder-create-area {
      background: rgba(155, 125, 255, 0.1);
      padding: 20px;
      border-radius: 12px;
      border: 2px dashed rgba(155, 125, 255, 0.3);
      margin-bottom: 25px;
    }

    .folder-create-area h4 {
      font-size: 16px;
      margin-bottom: 12px;
      color: var(--secondary);
    }

    .folder-create-form {
      display: flex;
      gap: 10px;
    }

    .folder-name-input {
      flex: 1;
      padding: 12px 15px;
      border-radius: 10px;
      border: 2px solid rgba(155, 125, 255, 0.3);
      background: rgba(16, 16, 28, 0.8);
      color: var(--light);
      font-size: 14px;
      transition: all 0.3s ease;
    }

    .folder-name-input:focus {
      outline: none;
      border-color: var(--secondary);
      box-shadow: 0 0 15px rgba(155, 125, 255, 0.3);
    }

    .folder-create-btn {
      padding: 12px 20px;
      background: linear-gradient(135deg, var(--secondary), var(--primary));
      border: none;
      border-radius: 10px;
      color: white;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      white-space: nowrap;
    }

    .folder-create-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(155, 125, 255, 0.4);
    }

    .folder-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .folder-list h4 {
      font-size: 16px;
      margin-bottom: 12px;
      color: var(--light);
      opacity: 0.8;
    }

    .folder-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: rgba(155, 125, 255, 0.1);
      padding: 15px;
      border-radius: 12px;
      border: 2px solid rgba(155, 125, 255, 0.2);
      transition: all 0.3s ease;
    }

    .folder-item:hover {
      border-color: rgba(155, 125, 255, 0.4);
      background: rgba(155, 125, 255, 0.15);
    }

    .folder-item-info {
      display: flex;
      align-items: center;
      gap: 12px;
      flex: 1;
    }

    .folder-item-icon {
      font-size: 24px;
    }

    .folder-item-details {
      flex: 1;
    }

    .folder-item-name {
      font-size: 16px;
      font-weight: bold;
      color: var(--light);
      margin-bottom: 4px;
    }

    .folder-item-count {
      font-size: 13px;
      opacity: 0.6;
    }

    .folder-item-actions {
      display: flex;
      gap: 8px;
    }

    .folder-action-btn {
      padding: 8px 12px;
      background: transparent;
      border: 2px solid rgba(155, 125, 255, 0.3);
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.3s ease;
    }

    .folder-action-btn:hover {
      background: rgba(155, 125, 255, 0.2);
      border-color: rgba(155, 125, 255, 0.5);
      transform: translateY(-2px);
    }

    .folder-action-btn.delete:hover {
      background: rgba(255, 107, 107, 0.2);
      border-color: rgba(255, 107, 107, 0.5);
    }

    .folder-empty-state {
      text-align: center;
      padding: 40px 20px;
      opacity: 0.5;
    }

    .folder-empty-state-icon {
      font-size: 48px;
      margin-bottom: 10px;
    }

    /* ============ NEW: Three Dots Menu ============ */
    .catatan-menu {
      position: relative;
    }

    .catatan-menu-btn {
      background: transparent;
      border: none;
      cursor: pointer;
      font-size: 20px;
      opacity: 0.6;
      transition: all 0.3s ease;
      padding: 5px 10px;
      border-radius: 8px;
      color: var(--light);
    }

    .catatan-menu-btn:hover {
      opacity: 1;
      background: rgba(122, 162, 255, 0.2);
    }

    .catatan-dropdown {
      position: absolute;
      top: 100%;
      right: 0;
      background: var(--card-bg);
      border: 2px solid rgba(122, 162, 255, 0.3);
      border-radius: 12px;
      padding: 8px;
      min-width: 150px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.8), 0 0 0 1px rgba(122, 162, 255, 0.5);
      z-index: 9999;
      display: none;
      animation: slideDown 0.3s ease;
      margin-top: 5px;
      backdrop-filter: blur(10px);
    }

    .catatan-dropdown.show {
      display: block;
    }

    .catatan-dropdown-item {
      padding: 10px 15px;
      cursor: pointer;
      border-radius: 8px;
      transition: all 0.2s ease;
      font-size: 14px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .catatan-dropdown-item:hover {
      background: rgba(122, 162, 255, 0.2);
    }

    .catatan-dropdown-item.delete:hover {
      background: rgba(255, 107, 107, 0.2);
      color: var(--accent);
    }

    /* Sub-menu for Edit */
    .catatan-dropdown-item.has-submenu {
      position: relative;
      justify-content: space-between;
    }

    .catatan-submenu {
      position: absolute;
      left: 100%;
      top: 0;
      background: var(--card-bg);
      border: 2px solid rgba(122, 162, 255, 0.3);
      border-radius: 12px;
      padding: 8px;
      min-width: 180px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.8), 0 0 0 1px rgba(122, 162, 255, 0.5);
      display: none;
      margin-left: 5px;
      z-index: 10000;
      backdrop-filter: blur(10px);
    }

    .catatan-dropdown-item.has-submenu:hover .catatan-submenu {
      display: block;
    }

    .catatan-submenu-item {
      padding: 10px 15px;
      cursor: pointer;
      border-radius: 8px;
      transition: all 0.2s ease;
      font-size: 14px;
      display: flex;
      align-items: center;
      gap: 8px;
      white-space: nowrap;
    }

    .catatan-submenu-item:hover {
      background: rgba(122, 162, 255, 0.2);
    }

    /* Mobile: submenu muncul di bawah instead of samping */
    @media (max-width: 768px) {
      .catatan-submenu {
        position: relative;
        left: 0;
        margin-left: 0;
        margin-top: 5px;
        display: none;
      }

      .catatan-dropdown-item.has-submenu.active .catatan-submenu {
        display: block;
      }
    }

    /* ============ NEW: Filters ============ */
    .catatan-filters {
      background: linear-gradient(135deg, rgba(122, 162, 255, 0.08), rgba(155, 125, 255, 0.08));
      padding: 20px;
      border-radius: 16px;
      border: 1px solid rgba(122, 162, 255, 0.2);
      margin-bottom: 25px;
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
      align-items: center;
    }

    .filter-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
      flex: 1;
      min-width: 150px;
    }

    .filter-group label {
      font-size: 13px;
      opacity: 0.8;
      font-weight: 600;
    }

    .filter-select {
      padding: 10px 15px;
      border-radius: 10px;
      border: 2px solid rgba(122, 162, 255, 0.3);
      background: rgba(16, 16, 28, 0.8);
      color: var(--light);
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .filter-select:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 15px rgba(122, 162, 255, 0.3);
    }

    .filter-reset-btn {
      padding: 10px 20px;
      border-radius: 10px;
      border: 2px solid rgba(122, 162, 255, 0.3);
      background: transparent;
      color: var(--primary);
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 14px;
      font-weight: 600;
      align-self: flex-end;
    }

    .filter-reset-btn:hover {
      background: rgba(122, 162, 255, 0.2);
      border-color: var(--primary);
    }

    /* ============ NEW: Load More Button ============ */
    .load-more-container {
      text-align: center;
      margin-top: 25px;
      padding: 20px;
    }

    .load-more-btn {
      padding: 12px 30px;
      border-radius: 25px;
      border: 2px solid var(--primary);
      background: transparent;
      color: var(--primary);
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 15px;
    }

    .load-more-btn:hover {
      background: var(--primary);
      color: white;
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(122, 162, 255, 0.4);
    }

    .load-more-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .load-more-info {
      font-size: 13px;
      opacity: 0.6;
      margin-top: 10px;
    }

    /* ============ NEW: Edit Modal ============ */
    .edit-modal {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.9);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      padding: 20px;
      animation: fadeIn 0.3s ease;
    }

    .edit-modal-content {
      background: linear-gradient(135deg, #1a1a28, #12121a);
      padding: 30px;
      border-radius: 20px;
      max-width: 600px;
      width: 100%;
      border: 2px solid rgba(122, 162, 255, 0.3);
      animation: slideInRight 0.3s ease;
    }

    .edit-modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .edit-modal-header h3 {
      color: var(--primary);
      margin: 0;
    }

    .edit-modal-close {
      background: transparent;
      border: none;
      font-size: 28px;
      cursor: pointer;
      color: #fff;
      opacity: 0.6;
      transition: opacity 0.3s ease;
    }

    .edit-modal-close:hover {
      opacity: 1;
    }

    .edit-modal-textarea {
      width: 100%;
      min-height: 150px;
      padding: 15px;
      border-radius: 12px;
      border: 2px solid rgba(122, 162, 255, 0.3);
      background: rgba(16, 16, 28, 0.8);
      color: var(--light);
      font-size: 15px;
      font-family: inherit;
      resize: vertical;
      margin-bottom: 20px;
    }

    .edit-modal-textarea:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 20px rgba(122, 162, 255, 0.3);
    }

    .edit-modal-actions {
      display: flex;
      gap: 10px;
      justify-content: flex-end;
    }

    .edit-modal-btn {
      padding: 12px 25px;
      border-radius: 12px;
      border: none;
      cursor: pointer;
      font-size: 14px;
      font-weight: bold;
      transition: all 0.3s ease;
    }

    .edit-modal-btn.cancel {
      background: transparent;
      border: 2px solid rgba(255, 255, 255, 0.3);
      color: var(--light);
    }

    .edit-modal-btn.cancel:hover {
      background: rgba(255, 255, 255, 0.1);
    }

    .edit-modal-btn.save {
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      color: white;
    }

    .edit-modal-btn.save:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(122, 162, 255, 0.4);
    }

    /* ============ Author Badge in Catatan ============ */
    .catatan-author-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 12px;
      background: linear-gradient(135deg, rgba(122, 162, 255, 0.2), rgba(155, 125, 255, 0.2));
      border-radius: 20px;
      font-size: 13px;
      font-weight: 600;
      border: 1px solid rgba(122, 162, 255, 0.3);
    }


    /* ============ FOLDER VIEW CARDS ============ */
    .folder-view-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      gap: 16px;
      margin-bottom: 10px;
    }

    .folder-view-card {
      background: linear-gradient(135deg, rgba(155, 125, 255, 0.12), rgba(122, 162, 255, 0.08));
      border: 2px solid rgba(155, 125, 255, 0.25);
      border-radius: 18px;
      padding: 22px 16px 18px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      position: relative;
      overflow: hidden;
    }

    .folder-view-card::before {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, rgba(155, 125, 255, 0.15), rgba(122, 162, 255, 0.15));
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .folder-view-card:hover {
      transform: translateY(-5px) scale(1.02);
      border-color: var(--secondary);
      box-shadow: 0 12px 35px rgba(155, 125, 255, 0.35);
    }

    .folder-view-card:hover::before { opacity: 1; }
    .folder-view-card:active { transform: translateY(-2px) scale(0.99); }

    .folder-view-icon {
      font-size: 42px;
      margin-bottom: 10px;
      position: relative;
      z-index: 1;
      display: block;
    }

    .folder-view-name {
      font-size: 14px;
      font-weight: 700;
      color: var(--light);
      margin-bottom: 6px;
      position: relative;
      z-index: 1;
      word-break: break-word;
      line-height: 1.3;
    }

    .folder-view-count {
      font-size: 12px;
      color: var(--secondary);
      opacity: 0.85;
      position: relative;
      z-index: 1;
      background: rgba(155, 125, 255, 0.15);
      border-radius: 20px;
      padding: 3px 10px;
      display: inline-block;
    }

    .folder-view-card.no-folder {
      background: linear-gradient(135deg, rgba(122, 162, 255, 0.1), rgba(100, 100, 140, 0.08));
      border-color: rgba(122, 162, 255, 0.2);
    }

    .folder-view-card.no-folder:hover {
      border-color: var(--primary);
      box-shadow: 0 12px 35px rgba(122, 162, 255, 0.3);
    }

    /* ============ BREADCRUMB ============ */
    .catatan-breadcrumb {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 20px;
      padding: 10px 16px;
      background: rgba(122, 162, 255, 0.07);
      border: 1px solid rgba(122, 162, 255, 0.15);
      border-radius: 12px;
      flex-wrap: wrap;
    }

    .breadcrumb-item {
      font-size: 14px;
      color: var(--primary);
      cursor: pointer;
      opacity: 0.75;
      transition: opacity 0.2s;
      font-weight: 600;
    }

    .breadcrumb-item:hover { opacity: 1; text-decoration: underline; }

    .breadcrumb-sep { font-size: 13px; opacity: 0.4; }

    .breadcrumb-current {
      font-size: 14px;
      color: var(--light);
      font-weight: 700;
    }

    /* ============ VIEW TOGGLE ============ */
    .catatan-view-toggle {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
    }

    .view-toggle-btn {
      flex: 1;
      padding: 10px 16px;
      border-radius: 12px;
      border: 2px solid rgba(122, 162, 255, 0.25);
      background: transparent;
      color: var(--light);
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      opacity: 0.6;
    }

    .view-toggle-btn.active {
      background: linear-gradient(135deg, rgba(122, 162, 255, 0.2), rgba(155, 125, 255, 0.2));
      border-color: var(--primary);
      opacity: 1;
      box-shadow: 0 4px 15px rgba(122, 162, 255, 0.2);
    }

    .view-toggle-btn:hover:not(.active) {
      opacity: 0.85;
      border-color: rgba(122, 162, 255, 0.5);
    }


    /* ============ MILESTONE LOCKED CARD ============ */
    .menu-card.milestone-locked {
      opacity: 0.45;
      cursor: default;
      filter: grayscale(0.4);
      pointer-events: none;
      border-style: dashed;
      border-color: rgba(122, 162, 255, 0.2);
    }

    .menu-card.milestone-locked .menu-icon {
      filter: grayscale(1);
      opacity: 0.5;
    }


  </style>
</head>

<body>
  <!-- ============ LOADING SCREEN ============ -->
  <div class="loading">
    <div class="loader"></div>
    <div class="loading-text">Memuat Kenangan Indah...</div>
  </div>

  <!-- ============ USER SELECTION GATE ============ -->
  <div class="overlay" id="overlay">
    <div class="gate">
      <div class="celebration-emoji">‚ù§Ô∏è</div>
      <h2>Siapa Kamu?</h2>
      <p>Pilih identitasmu untuk melanjutkan perjalanan kita ‚ú®</p>
      
      <!-- User Selection -->
      <div class="user-selection">
        <div class="user-card" onclick="selectUser('BF')" id="userBF">
          <div class="user-icon">üíô</div>
          <h3>Boyfriend</h3>
          <p>The Amazing Guy</p>
        </div>
        <div class="user-card" onclick="selectUser('GF')" id="userGF">
          <div class="user-icon">üíñ</div>
          <h3>Girlfriend</h3>
          <p>The Beautiful Girl</p>
        </div>
      </div>
      
      <!-- Password Input (will show after user selection) -->
      <div class="password-section" id="passwordSection" style="display: none; margin-top: 20px;">
        <p style="margin-bottom: 15px; opacity: 0.8;">Halo <span id="selectedUserName"></span>! Masukkan password:</p>
        <div style="position: relative; display: inline-block; width: 100%; max-width: 280px;">
          <input 
            type="password" 
            class="password-input" 
            id="passwordInput" 
            placeholder="Masukkan password..."
            autocomplete="off"
          />
          <span class="toggle-password" onclick="togglePasswordVisibility('passwordInput', this)">
            üëÅÔ∏è
          </span>
        </div>
        <button class="unlock-btn" onclick="checkPassword()">Masuk</button>
        <button class="back-user-btn" onclick="backToUserSelection()">‚Üê Ganti User</button>
        <div class="error-msg" id="errorMsg">Password salah, coba lagi! üíî</div>
      </div>
    </div>
  </div>

  <!-- ============ BACKGROUND EFFECTS ============ -->
  <div class="particles" id="particles"></div>
  <div class="stars" id="stars"></div>

  <!-- ============ MUSIC CONTROL - DIPINDAHKAN KE KIRI ATAS ============ -->
  <div class="music-control" onclick="toggleMusic()" id="musicControl">
    <span class="music-icon">üéµ</span>
    <span class="music-text">Musik</span>
  </div>

  <!-- ============ NOTIFICATION ============ -->
  <div class="notification" id="notification"></div>

  <!-- ============ SECRET MESSAGE ============ -->
  <div class="secret-message" id="secretMsg">
    <h3>üéÆ Konami Code Activated!</h3>
    <p>Kamu nemu Easter Egg super rahasia! üéä<br><br>
    Cintaku padamu sama kaya level dalam game - terus naik dan gak ada batas! üíïüéÆ</p>
    <button class="close-secret" onclick="closeSecret()">Tutup</button>
  </div>

  <!-- ============ MAIN CONTAINER ============ -->
  <div class="container">
    <!-- ============ HEADER ============ -->
    <div class="header">
      <h1 class="main-title" id="mainTitle">Our Journey Together ‚ù§</h1>
      <p class="subtitle">Setiap Hari Adalah Petualangan Baru</p>
      <p class="date" id="dateDisplay">Perjalanan Tanpa Akhir ‚ú®</p>
    </div>

    <!-- ============ STATS ============ -->
    <div class="stats">
      <div class="stat" data-stat="days">
        <div class="stat-number">0</div>
        <div class="stat-label">Hari Bersama</div>
      </div>
      <div class="stat" data-stat="memories">
        <div class="stat-number">‚àû</div>
        <div class="stat-label">Kenangan Indah</div>
      </div>
      <div class="stat" data-stat="love">
        <div class="stat-number">100%</div>
        <div class="stat-label">Tingkat Cinta</div>
      </div>
    </div>

    <!-- ============ MAIN MENU ============ -->
    <div class="menu-grid" id="menu">
      <div class="menu-card" onclick="openSection('anniversary')">
        <span class="menu-icon">üéâ</span>
        <h3 class="menu-title">Milestones</h3>
        <p class="menu-desc">Momen-momen spesial kita</p>
      </div>

      <div class="menu-card" onclick="openSection('game')">
        <span class="menu-icon">üéÆ</span>
        <h3 class="menu-title">Heart Catcher</h3>
        <p class="menu-desc">Main game bareng yuk!</p>
      </div>

      <div class="menu-card" onclick="openSection('catatan')">
        <span class="menu-icon">üìù</span>
        <h3 class="menu-title">Catatan Bersama</h3>
        <p class="menu-desc">Tulis & bagikan catatan real-time</p>
      </div>
    </div>

    <!-- ============ ANNIVERSARY MENU ============ -->
    <div class="section" id="anniversary">
      <div class="section-header">
        <button class="back-btn" onclick="goBack()">
          <span>‚Üê</span>
          <span>Kembali</span>
        </button>
        <h2 class="section-title">üéâ Milestones</h2>
      </div>

      <div class="menu-grid">
        <div class="menu-card" onclick="openSection('onemonth')">
          <span class="menu-icon">üíï</span>
          <h3 class="menu-title">1 Month</h3>
          <p class="menu-desc">9 Jan - 9 Feb 2026</p>
        </div>

        <div class="menu-card milestone-locked">
          <span class="menu-icon">üîí</span>
          <h3 class="menu-title" style="opacity:0.45;">‚Ä¢ ‚Ä¢ ‚Ä¢</h3>
          <p class="menu-desc" style="opacity:0.35;">Segera hadir...</p>
        </div>

        <div class="menu-card milestone-locked">
          <span class="menu-icon">üîí</span>
          <h3 class="menu-title" style="opacity:0.45;">‚Ä¢ ‚Ä¢ ‚Ä¢</h3>
          <p class="menu-desc" style="opacity:0.35;">Segera hadir...</p>
        </div>
      </div>
    </div>

    <!-- ============ 1 MONTH ANNIVERSARY SUB-MENU ============ -->
    <div class="section" id="onemonth">
      <div class="section-header">
        <button class="back-btn" onclick="goBack()">
          <span>‚Üê</span>
          <span>Kembali</span>
        </button>
        <h2 class="section-title">üíï 1 Month Anniversary</h2>
      </div>

      <div class="menu-grid">
        <div class="menu-card" onclick="openSection('surat')">
          <span class="menu-icon">üíå</span>
          <h3 class="menu-title">Surat Untuk Kamu</h3>
          <p class="menu-desc">Perasaan dari hati</p>
        </div>

        <div class="menu-card" onclick="openSection('alasan')">
          <span class="menu-icon">üíï</span>
          <h3 class="menu-title">Kenapa Aku Cinta</h3>
          <p class="menu-desc">Hal yang membuatku jatuh cinta</p>
        </div>

        <div class="menu-card" onclick="openSection('kenangan')">
          <span class="menu-icon">üì∏</span>
          <h3 class="menu-title">Momen Spesial</h3>
          <p class="menu-desc">Kenangan bulan pertama</p>
        </div>

        <div class="menu-card" onclick="openSection('timeline')">
          <span class="menu-icon">‚è∞</span>
          <h3 class="menu-title">Timeline Kita</h3>
          <p class="menu-desc">Perjalanan 32 hari pertama</p>
        </div>

        <div class="menu-card" onclick="openSection('galeri')">
          <span class="menu-icon">üé®</span>
          <h3 class="menu-title">Galeri Emoji</h3>
          <p class="menu-desc">Koleksi emoji favorit kita</p>
        </div>

        <div class="menu-card" onclick="openSection('penutup')">
          <span class="menu-icon">üíù</span>
          <h3 class="menu-title">Pesan Spesial</h3>
          <p class="menu-desc">Surat terakhir untukmu</p>
        </div>
      </div>
    </div>

    <!-- ============ SURAT CINTA SECTION ============ -->
    <div class="section" id="surat">
      <div class="section-header">
        <button class="back-btn" onclick="goBack()">
          <span>‚Üê</span>
          <span>Kembali</span>
        </button>
        <h2 class="section-title">üíå Surat Untuk Kamu</h2>
      </div>

      <div class="content-card">
        <p>Sayang,</p>
        
        <p>Nggak kerasa ya, satu bulan. Kedengerannya sebentar, tapi entah kenapa rasanya panjang dan penuh. Dalam satu bulan ini, kamu jadi kebiasaan baru yang paling aku tunggu. Dari hal kecil sampai hal yang nggak penting tapi jadi penting karena ada kamu di situ.</p>
        
        <p>Aku suka caramu hadir, nggak ribut, nggak maksa, tapi cukup buat bikin hari-hariku beda. Kadang cuma ngobrol singkat, kadang diem bareng, tapi entah kenapa selalu terasa pas. Kamu bikin aku ngerasa nyaman jadi diri sendiri, tanpa harus sok kuat atau sok sempurna.</p>

        <div class="quote">
          "Satu bulan ini juga ngajarin aku kalau perasaan itu bukan soal janji besar, tapi soal konsistensi kecil. Tentang saling dengerin, saling ngerti, dan tetap milih satu sama lain bahkan di hari yang capek."
        </div>

        <p>Terima kasih sudah datang dan bertahan sejauh ini.</p>

        <p>Selamat satu bulan, sayang.<br>Semoga perayaan kecil ini cuma jeda kecil dari cerita panjang yang akan kita jalani.</p>

        <p class="signature">Dengan cinta,<br>Cowok kamu yang paling ganteng ‚ù§Ô∏è</p>

        <button class="reveal-btn" onclick="reveal(this)">Baca Semua ‚ú®</button>
      </div>
    </div>

    <!-- ============ ALASAN CINTA SECTION ============ -->
    <div class="section" id="alasan">
      <div class="section-header">
        <button class="back-btn" onclick="goBack()">
          <span>‚Üê</span>
          <span>Kembali</span>
        </button>
        <h2 class="section-title">üíï Kenapa Aku Cinta Kamu</h2>
      </div>

      <div class="content-card">
        <h3>Hal-hal yang membuatku jatuh cinta...</h3>
        
        <ul class="love-list">
          <li>üòä Senyummu yang bisa bikin hariku cerah bahkan di hari tergelap</li>
          <li>üòÇ Tawamu yang lucu dan bikin aku gak bisa berhenti ikut ketawa</li>
          <li>ü§ó Cara kamu peduli sama aku, bahkan hal-hal kecil yang aku sendiri lupa</li>
          <li>üåü Cara kamu dukung aku dalam setiap hal yang aku lakuin</li>
          <li>‚ù§Ô∏è Ketulusan hatimu yang aku rasakan setiap hari</li>
          <li>üåà Cara kamu bikin hidup aku lebih berwarna</li>
          <li>‚ú® Simply being you - karena kamu itu special</li>
        </ul>

        <button class="reveal-btn" onclick="reveal(this)">Lihat Semua Alasan üíù</button>
      </div>
    </div>

    <!-- ============ KENANGAN SECTION ============ -->
    <div class="section" id="kenangan">
      <div class="section-header">
        <button class="back-btn" onclick="goBack()">
          <span>‚Üê</span>
          <span>Kembali</span>
        </button>
        <h2 class="section-title">üì∏ Momen Spesial</h2>
      </div>

      <div class="content-card">
        <h3 class="milestone-header">Momen-momen Tak Terlupakan</h3>
        
        <div class="memories-grid">
          <div class="memory-card">
            <div class="memory-header">
              <span class="memory-icon">üí´</span>
              <h4 class="memory-title">Percakapan Pertama</h4>
            </div>
            <p class="memory-desc">Saat pertama kali kita ngobrol, aku udah tau ada yang beda. Obrolan yang natural dan bikin aku pengen terus kenal kamu lebih jauh.</p>
          </div>

          <div class="memory-card">
            <div class="memory-header">
              <span class="memory-icon">üíò</span>
              <h4 class="memory-title">Hari Pertama</h4>
            </div>
            <p class="memory-desc">9 Januari 2026 - Hari dimana kita resmi jadi couple. Hari yang paling aku tunggu dan gak akan pernah aku lupain.</p>
          </div>

          <div class="memory-card">
            <div class="memory-header">
              <span class="memory-icon">üí™</span>
              <h4 class="memory-title">Setiap Hari</h4>
            </div>
            <p class="memory-desc">Setiap hari penuh dengan penyemangatan - cara kamu selalu ada buat aku, jadi support system terbaik.</p>
          </div>

          <div class="memory-card">
            <div class="memory-header">
              <span class="memory-icon">üìû</span>
              <h4 class="memory-title">Video Call Pertama</h4>
            </div>
            <p class="memory-desc">Minggu ke-3 - Akhirnya bisa VC bareng, denger suara kamu langsung, liat senyum kamu real-time. Momen yang bikin makin kangen.</p>
          </div>

          <div class="memory-card">
            <div class="memory-header">
              <span class="memory-icon">üì±</span>
              <h4 class="memory-title">Kiriman Video</h4>
            </div>
            <p class="memory-desc">Kirim-kiriman video lucu di IG dan TikTok, spam reels tengah malam, ketawa sendiri sambil ngebayangin reaksi kamu.</p>
          </div>

          <div class="memory-card">
            <div class="memory-header">
              <span class="memory-icon">üòÇ</span>
              <h4 class="memory-title">Momen Receh</h4>
            </div>
            <p class="memory-desc">Semua joke garing kita, candaan receh yang cuma kita berdua yang ketawa, dan chat-chat random yang bikin hari jadi seru.</p>
          </div>
        </div>

        <button class="reveal-btn" onclick="reveal(this)">Kenang Bersama üéä</button>
      </div>
    </div>

    <!-- ============ TIMELINE SECTION ============ -->
    <div class="section" id="timeline">
      <div class="section-header">
        <button class="back-btn" onclick="goBack()">
          <span>‚Üê</span>
          <span>Kembali</span>
        </button>
        <h2 class="section-title">‚è∞ Timeline Kita</h2>
      </div>

      <div class="content-card">
        <div class="timeline">
          <div class="timeline-item">
            <div class="timeline-date">Sebelum Januari 2026</div>
            <div class="timeline-content">
              Awal-awal kenal, masih awkward tapi seru. Mulai chat-chatan dan aku udah mulai tertarik.
            </div>
          </div>

          <div class="timeline-item">
            <div class="timeline-date">9 Januari 2026</div>
            <div class="timeline-content">
              üéâ JADIAN! Akhirnya kita resmi couple. Best decision ever.
            </div>
          </div>

          <div class="timeline-item">
            <div class="timeline-date">Minggu Pertama</div>
            <div class="timeline-content">
              Masih canggung-canggung gimana gitu, tapi seru. Chat terus, kirim-kiriman meme random.
            </div>
          </div>

          <div class="timeline-item">
            <div class="timeline-date">Minggu Kedua</div>
            <div class="timeline-content">
              Udah mulai nyaman, chat makin banyak.
            </div>
          </div>

          <div class="timeline-item">
            <div class="timeline-date">Minggu Ketiga & Keempat</div>
            <div class="timeline-content">
              VC pertama! Akhirnya bisa liat dan denger kamu langsung. Worth the wait banget. Udah makin kompak aja, spam notif terus.
            </div>
          </div>

          <div class="timeline-item">
            <div class="timeline-date">9 Februari 2026</div>
            <div class="timeline-content">
              üéä 1 BULAN ANNIVERSARY! Bikin website ini special buat kamu. Cheers to many more months ahead!
            </div>
          </div>
        </div>

        <button class="reveal-btn" onclick="reveal(this)">Lihat Perjalanan üöÄ</button>
      </div>
    </div>

    <!-- ============ GALERI SECTION ============ -->
    <div class="section" id="galeri">
      <div class="section-header">
        <button class="back-btn" onclick="goBack()">
          <span>‚Üê</span>
          <span>Kembali</span>
        </button>
        <h2 class="section-title">üé® Galeri Emoji</h2>
      </div>

      <div class="content-card">
        <h3>Emoji yang merepresentasikan kita:</h3>
        
        <div class="gallery-grid">
          <div class="gallery-item" title="Ketawa bareng"><span>üòÇ</span></div>
          <div class="gallery-item" title="Shock moment"><span>ü´®</span></div>
          <div class="gallery-item" title="Awkward tapi lucu"><span>üòÖ</span></div>
          <div class="gallery-item" title="Happy vibes"><span>üòÅ</span></div>
          <div class="gallery-item" title="Godain kamu"><span>üòã</span></div>
          <div class="gallery-item" title="Drama queen"><span>üò≠</span></div>
          <div class="gallery-item" title="Nge-flirt mode"><span>üòâ</span></div>
          <div class="gallery-item" title="Ganteng mode ON"><span>üòé</span></div>
          <div class="gallery-item" title="Cinta sejati"><span>‚ù§Ô∏è</span></div>
          <div class="gallery-item" title="Couple goals"><span>üíë</span></div>
          <div class="gallery-item" title="Cium sayang"><span>üòò</span></div>
          <div class="gallery-item" title="Kenangan indah"><span>üì∏</span></div>
        </div>

        <button class="reveal-btn" onclick="reveal(this)">Explore Galeri üé≠</button>
      </div>
    </div>

    <!-- ============ GAME SECTION ============ -->
    <div class="section" id="game">
      <div class="section-header">
        <button class="back-btn" onclick="goBack()">
          <span>‚Üê</span>
          <span>Kembali</span>
        </button>
        <h2 class="section-title">üéÆ Mini Games</h2>
      </div>

      <div class="content-card">
        <p style="text-align: center; margin-bottom: 30px;">Pilih game yang mau kamu mainkan! üéØ</p>
        
        <div class="games-menu">
          <div class="game-menu-card" onclick="openGame('heartcatcher')">
            <span class="game-menu-icon">üíï</span>
            <h3 class="game-menu-title">Heart Catcher</h3>
            <p class="game-menu-desc">Tangkap hati sebanyak-banyaknya!</p>
          </div>

          <div class="game-menu-card" onclick="openGame('memory')">
            <span class="game-menu-icon">üÉè</span>
            <h3 class="game-menu-title">Memory Cards</h3>
            <p class="game-menu-desc">Cocokkan kartu yang sama!</p>
          </div>

          <div class="game-menu-card" onclick="openGame('quiz')">
            <span class="game-menu-icon">‚ùì</span>
            <h3 class="game-menu-title">Love Quiz</h3>
            <p class="game-menu-desc">Seberapa kenal kamu sama aku?</p>
          </div>

          <div class="game-menu-card" onclick="openGame('truthordare')">
            <span class="game-menu-icon">üí≠</span>
            <h3 class="game-menu-title">Truth or Dare</h3>
            <p class="game-menu-desc">Truth or dare couple edition!</p>
          </div>

          <div class="game-menu-card" onclick="openGame('spinwheel')">
            <span class="game-menu-icon">üé°</span>
            <h3 class="game-menu-title">Spin the Wheel</h3>
            <p class="game-menu-desc">Putar roda untuk tantangan!</p>
          </div>
        </div>
      </div>
    </div>

    <!-- ============ HEART CATCHER GAME ============ -->
    <div class="section" id="heartcatcher">
      <div class="section-header">
        <button class="back-btn" onclick="backToGames()">
          <span>‚Üê</span>
          <span>Kembali</span>
        </button>
        <h2 class="section-title">üíï Heart Catcher</h2>
      </div>

      <div class="content-card">
        <div class="game-container">
          <div class="game-header">
            <div class="game-info">
              <span class="game-label">Score:</span>
              <span class="game-score" id="gameScore">0</span>
            </div>
            <div class="game-info">
              <span class="game-label">Time:</span>
              <span class="game-time" id="gameTime">30</span>s
            </div>
            <div class="game-info">
              <span class="game-label">Lives:</span>
              <span class="game-lives" id="gameLives">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</span>
            </div>
          </div>

          <div class="game-board" id="gameBoard">
            <div class="game-hole"></div>
            <div class="game-hole"></div>
            <div class="game-hole"></div>
            <div class="game-hole"></div>
            <div class="game-hole"></div>
            <div class="game-hole"></div>
            <div class="game-hole"></div>
            <div class="game-hole"></div>
            <div class="game-hole"></div>
          </div>

          <div class="game-controls">
            <button class="game-btn" id="gameStartBtn" onclick="startGame()">üéÆ Mulai Game</button>
            <button class="game-btn" id="gameResetBtn" onclick="resetGame()" style="display:none;">üîÑ Main Lagi</button>
          </div>

          <div class="game-message" id="gameMessage"></div>

          <div class="game-instructions">
            <h4>üìñ Cara Main:</h4>
            <p>‚Ä¢ Klik hati üíï yang muncul sebelum hilang!</p>
            <p>‚Ä¢ Jangan klik üíî broken heart (nyawa berkurang!)</p>
            <p>‚Ä¢ Kumpulkan score sebanyak mungkin dalam 30 detik!</p>
            <p>‚Ä¢ Semakin tinggi score, semakin romantis kamu! üòç</p>
          </div>
        </div>
      </div>
    </div>

    <!-- ============ MEMORY CARD GAME ============ -->
    <div class="section" id="memory">
      <div class="section-header">
        <button class="back-btn" onclick="backToGames()">
          <span>‚Üê</span>
          <span>Kembali</span>
        </button>
        <h2 class="section-title">üÉè Memory Cards</h2>
      </div>

      <div class="content-card">
        <div class="game-container">
          <!-- Difficulty Selector -->
          <div class="difficulty-selector" id="memoryDifficultySelector">
            <h4 style="text-align: center; margin-bottom: 20px;">Pilih Tingkat Kesulitan:</h4>
            <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
              <button class="difficulty-btn easy-btn" onclick="startMemoryGame('easy')">
                <span style="font-size: 24px;">üòä</span><br>EASY<br><small>4 pasang</small>
              </button>
              <button class="difficulty-btn medium-btn" onclick="startMemoryGame('medium')">
                <span style="font-size: 24px;">üòé</span><br>MEDIUM<br><small>6 pasang</small>
              </button>
              <button class="difficulty-btn hard-btn" onclick="startMemoryGame('hard')">
                <span style="font-size: 24px;">üòà</span><br>HARD<br><small>8 pasang</small>
              </button>
            </div>
          </div>

          <div class="game-header">
            <div class="game-info">
              <span class="game-label">Moves:</span>
              <span class="game-score" id="memoryMoves">0</span>
            </div>
            <div class="game-info">
              <span class="game-label">Matches:</span>
              <span class="game-time" id="memoryMatches">0/8</span>
            </div>
            <div class="game-info">
              <span class="game-label">Time:</span>
              <span class="game-lives" id="memoryTime">0s</span>
            </div>
          </div>

          <div class="memory-board" id="memoryBoard"></div>

          <div class="game-message" id="memoryMessage"></div>

          <div class="game-controls">
            <button class="game-btn" id="memoryResetBtn" onclick="resetMemoryGame()" style="display:none;">üîÑ Main Lagi</button>
          </div>

          <div class="game-instructions">
            <h4>üìñ Cara Main:</h4>
            <p>‚Ä¢ Pilih difficulty level terlebih dahulu</p>
            <p>‚Ä¢ Klik 2 kartu untuk membukanya</p>
            <p>‚Ä¢ Cari pasangan kartu yang sama</p>
            <p>‚Ä¢ Cocokkan semua kartu dengan gerakan seminimal mungkin!</p>
            <p>‚Ä¢ Semakin sedikit moves, semakin bagus! üèÜ</p>
          </div>
        </div>
      </div>
    </div>

    <!-- ============ LOVE QUIZ GAME ============ -->
    <div class="section" id="quiz">
      <div class="section-header">
        <button class="back-btn" onclick="backToGames()">
          <span>‚Üê</span>
          <span>Kembali</span>
        </button>
        <h2 class="section-title">‚ùì Love Quiz</h2>
      </div>

      <div class="content-card">
        <div class="game-container">
          <div class="quiz-container" id="quizContainer">
            <div class="quiz-progress">
              <span id="quizProgress">Pertanyaan <span id="quizCurrent">1</span>/<span id="quizTotal">5</span></span>
            </div>

            <div class="quiz-question" id="quizQuestion"></div>

            <div class="quiz-options" id="quizOptions"></div>

            <div class="quiz-result" id="quizResult" style="display:none;">
              <h3 id="quizResultTitle"></h3>
              <p id="quizResultMessage"></p>
              <div class="quiz-score-display" id="quizScoreDisplay"></div>
              <button class="game-btn" onclick="resetQuiz()">üîÑ Main Lagi</button>
            </div>
          </div>

          <div class="game-instructions">
            <h4>üìñ Tentang Quiz:</h4>
            <p>‚Ä¢ Jawab 5 pertanyaan tentang kita berdua</p>
            <p>‚Ä¢ Pilih jawaban yang menurutmu paling benar</p>
            <p>‚Ä¢ Lihat seberapa kenal kamu sama aku! üíï</p>
          </div>
        </div>
      </div>
    </div>

    <!-- ============ TRUTH OR DARE GAME ============ -->
    <div class="section" id="truthordare">
      <div class="section-header">
        <button class="back-btn" onclick="backToGames()">
          <span>‚Üê</span>
          <span>Kembali</span>
        </button>
        <h2 class="section-title">üí≠ Truth or Dare</h2>
      </div>

      <div class="content-card">
        <div class="game-container">
          <div class="tod-container">
            <div class="tod-choice-screen" id="todChoiceScreen">
              <h3 class="tod-question">Pilih salah satu!</h3>
              <div class="tod-buttons">
                <button class="tod-btn truth-btn" onclick="selectTruthOrDare('truth')">
                  <span class="tod-btn-icon">üí¨</span>
                  <span class="tod-btn-text">TRUTH</span>
                </button>
                <button class="tod-btn dare-btn" onclick="selectTruthOrDare('dare')">
                  <span class="tod-btn-icon">‚ö°</span>
                  <span class="tod-btn-text">DARE</span>
                </button>
              </div>
            </div>

            <div class="tod-result-screen" id="todResultScreen" style="display:none;">
              <div class="tod-type-badge" id="todTypeBadge"></div>
              <div class="tod-challenge" id="todChallenge"></div>
              <div class="tod-actions">
                <button class="game-btn" onclick="completeTod()">‚úÖ Selesai</button>
                <button class="game-btn" onclick="skipTod()">‚è≠Ô∏è Skip</button>
              </div>
              <div class="tod-stats">
                <span>Completed: <strong id="todCompleted">0</strong></span>
                <span>Skipped: <strong id="todSkipped">0</strong></span>
              </div>
            </div>
          </div>

          <div class="game-instructions">
            <h4>üìñ Cara Main:</h4>
            <p>‚Ä¢ Pilih TRUTH untuk pertanyaan jujur</p>
            <p>‚Ä¢ Pilih DARE untuk tantangan seru</p>
            <p>‚Ä¢ Jawab dengan jujur atau lakukan tantangannya!</p>
            <p>‚Ä¢ Bisa dimainkan bareng atau sendiri üíï</p>
          </div>
        </div>
      </div>
    </div>

    <!-- ============ SPIN THE WHEEL GAME ============ -->
    <div class="section" id="spinwheel">
      <div class="section-header">
        <button class="back-btn" onclick="backToGames()">
          <span>‚Üê</span>
          <span>Kembali</span>
        </button>
        <h2 class="section-title">üé° Spin the Wheel</h2>
      </div>

      <div class="content-card">
        <div class="game-container">
          <div class="wheel-container">
            <canvas id="wheelCanvas" width="400" height="400"></canvas>
            <button class="wheel-spin-btn" id="wheelSpinBtn" onclick="spinWheel()">
              <span class="wheel-spin-icon">üé°</span>
              <span>SPIN!</span>
            </button>
          </div>

          <div class="wheel-result" id="wheelResult"></div>

          <div class="game-controls">
            <button class="game-btn" onclick="resetWheelStats()">üîÑ Reset Stats</button>
          </div>

          <div class="wheel-stats">
            <h4>üìä Statistics:</h4>
            <div id="wheelStatsDisplay"></div>
          </div>

          <div class="game-instructions">
            <h4>üìñ Cara Main:</h4>
            <p>‚Ä¢ Klik tombol SPIN untuk putar roda</p>
            <p>‚Ä¢ Tunggu roda berhenti</p>
            <p>‚Ä¢ Lakukan tantangan yang keluar!</p>
            <p>‚Ä¢ Semakin banyak spin, semakin seru! üéâ</p>
          </div>
        </div>
      </div>
    </div>

    <!-- ============ CATATAN BERSAMA SECTION ============ -->
    <div class="section" id="catatan">
      <div class="section-header">
        <button class="back-btn" onclick="goBack()">
          <span>‚Üê</span>
          <span>Kembali</span>
        </button>
        <h2 class="section-title">üìù Catatan Bersama</h2>
      </div>

      <div class="content-card">
        <div class="catatan-container">
          <!-- Stats -->
          <div class="catatan-stats">
            <div class="catatan-stat-item">
              <div class="catatan-stat-number" id="totalCatatan">0</div>
              <div class="catatan-stat-label">Total Catatan</div>
            </div>
            <div class="catatan-stat-item">
              <div class="catatan-stat-number">üîÑ</div>
              <div class="catatan-stat-label">Real-time Sync</div>
            </div>
          </div>

          <!-- Input Area -->
          <div class="catatan-input-area">
            <h3>‚úçÔ∏è Tulis Catatan Baru</h3>
            <div class="catatan-form">
              <!-- NEW: Folder/Category Input - REDESIGNED -->
              <div class="catatan-folder-input">
                <label>üìÅ Folder:</label>
                <div class="folder-input-wrapper">
                  <select id="catatanFolder" class="catatan-folder-select">
                    <option value="">-- Random --</option>
                  </select>
                  <button class="folder-add-quick-btn" onclick="toggleQuickFolderAdd()" title="Tambah Folder Cepat">
                    ‚ûï
                  </button>
                  <button class="folder-manage-btn" onclick="openFolderManager()" title="Kelola Semua Folder">
                    üìÇ
                  </button>
                </div>
              </div>
              
              <!-- Quick Folder Add (Hidden by default) -->
              <div class="quick-folder-add" id="quickFolderAdd" style="display: none;">
                <input 
                  type="text" 
                  id="quickFolderName" 
                  class="quick-folder-input" 
                  placeholder="Nama folder baru..." 
                  maxlength="30"
                />
                <button class="quick-folder-create-btn" onclick="createFolderQuick()">
                  ‚úì
                </button>
                <button class="quick-folder-cancel-btn" onclick="toggleQuickFolderAdd()">
                  ‚úï
                </button>
              </div>
              
              <textarea 
                id="catatanText" 
                class="catatan-textarea" 
                placeholder="Tulis catatan, pesan, atau apapun yang ingin kamu bagikan... üí≠"
                maxlength="2000"
              ></textarea>
              <div class="char-counter" id="catatanCharCounter">
                <span id="catatanCharCount">0</span> / 2000 karakter
              </div>
              <button class="catatan-submit-btn" onclick="addCatatan()">
                üì§ Kirim Catatan
              </button>
            </div>
          </div>

          <!-- View Toggle -->
          <div class="catatan-view-toggle">
            <button class="view-toggle-btn active" id="btnViewFolder" onclick="switchCatatanView('folder')">
              üìÅ Lihat per Folder
            </button>
            <button class="view-toggle-btn" id="btnViewAll" onclick="switchCatatanView('all')">
              üìã Semua Catatan
            </button>
          </div>

          <!-- Folder View (default) -->
          <div id="folderViewArea">
            <!-- Breadcrumb (tampil saat di dalam folder) -->
            <div class="catatan-breadcrumb" id="catatanBreadcrumb" style="display:none;">
              <span class="breadcrumb-item" onclick="backToFolderView()">üìÅ Semua Folder</span>
              <span class="breadcrumb-sep">‚Ä∫</span>
              <span class="breadcrumb-current" id="breadcrumbFolderName"></span>
            </div>
            <!-- Grid folder cards -->
            <div class="folder-view-grid" id="folderViewGrid"></div>
            <!-- Catatan dalam folder (tersembunyi sampai folder diklik) -->
            <div id="folderCatatanArea" style="display:none;">
              <div class="catatan-list" id="folderCatatanList"></div>
              <div class="load-more-container" id="loadMoreContainerFolder" style="display:none;">
                <button class="load-more-btn" id="loadMoreBtnFolder" onclick="loadMoreFolderCatatan()">
                  üì• Muat Lebih Banyak
                </button>
                <div class="load-more-info" id="loadMoreInfoFolder"></div>
              </div>
            </div>
          </div>

          <!-- All Catatan View (dengan filter) -->
          <div id="allCatatanArea" style="display:none;">
            <!-- Filters -->
            <div class="catatan-filters">
              <div class="filter-group">
                <label>üìÖ Bulan</label>
                <select id="filterMonth" class="filter-select" onchange="applyFilters()">
                  <option value="">Semua Bulan</option>
                  <option value="01">Januari</option>
                  <option value="02">Februari</option>
                  <option value="03">Maret</option>
                  <option value="04">April</option>
                  <option value="05">Mei</option>
                  <option value="06">Juni</option>
                  <option value="07">Juli</option>
                  <option value="08">Agustus</option>
                  <option value="09">September</option>
                  <option value="10">Oktober</option>
                  <option value="11">November</option>
                  <option value="12">Desember</option>
                </select>
              </div>

              <div class="filter-group">
                <label>üìÜ Tahun</label>
                <select id="filterYear" class="filter-select" onchange="applyFilters()">
                  <option value="">Semua Tahun</option>
                </select>
              </div>

              <div class="filter-group">
                <label>üë§ Penulis</label>
                <select id="filterAuthor" class="filter-select" onchange="applyFilters()">
                  <option value="">Semua</option>
                  <option value="BF">BF</option>
                  <option value="GF">GF</option>
                </select>
              </div>

              <div class="filter-group">
                <label>üìÅ Folder</label>
                <select id="filterFolder" class="filter-select" onchange="applyFilters()">
                  <option value="">Semua Folder</option>
                </select>
              </div>

              <button class="filter-reset-btn" onclick="resetFilters()">
                üîÑ Reset
              </button>
            </div>

            <!-- List Catatan -->
            <div class="catatan-list" id="catatanList">
              <div class="catatan-empty">
                <div class="catatan-empty-icon">üì≠</div>
                <p>Belum ada catatan. Yuk tulis catatan pertama!</p>
              </div>
            </div>

            <!-- Load More -->
            <div class="load-more-container" id="loadMoreContainer" style="display: none;">
              <button class="load-more-btn" id="loadMoreBtn" onclick="loadMoreCatatan()">
                üì• Muat Lebih Banyak
              </button>
              <div class="load-more-info" id="loadMoreInfo"></div>
            </div>
          </div>

          <!-- NEW: Load More Button -->
          <div class="load-more-container" id="loadMoreContainer" style="display: none;">
            <button class="load-more-btn" id="loadMoreBtn" onclick="loadMoreCatatan()">
              üì• Muat Lebih Banyak
            </button>
            <div class="load-more-info" id="loadMoreInfo"></div>
          </div>
        </div>

        <div class="game-instructions" style="margin-top: 30px;">
          <h4>üí° Tentang Catatan Bersama:</h4>
          <p>‚Ä¢ Catatan dikelompokkan per Folder ‚Äî klik folder untuk lihat isinya</p>
          <p>‚Ä¢ Gunakan tombol üìã Semua Catatan untuk lihat & filter semua catatan sekaligus</p>
          <p>‚Ä¢ Tambah folder baru via tombol ‚ûï di samping dropdown Folder</p>
          <p>‚Ä¢ Klik ‚ãÆ (titik tiga) pada catatan untuk Copy, Edit, atau Hapus</p>
          <p>‚Ä¢ Semua catatan tersinkron secara real-time dengan Firebase</p>
          <p>‚Ä¢ Tekan Ctrl+Enter untuk kirim catatan lebih cepat</p>
        </div>
      </div>
    </div>

    <!-- ============ PENUTUP SECTION ============ -->
    <div class="section" id="penutup">
      <div class="section-header">
        <button class="back-btn" onclick="goBack()">
          <span>‚Üê</span>
          <span>Kembali</span>
        </button>
        <h2 class="section-title">üíù Penutup</h2>
      </div>

      <div class="content-card ending-content">
        <p>Dari semua kata yang bisa aku ucapkan,<br>
        yang paling penting adalah...</p>

        <div class="big-heart" id="heart" onclick="showHeart()">‚ù§Ô∏è</div>

        <p class="final-message">I LOVE YOU</p>

        <div class="quote">
          "Setiap hari bersamamu adalah petualangan baru. Masih banyak hari, bulan, dan tahun yang akan kita lalui bersama. Terima kasih udah jadi bagian dari hidup cowok ganteng ini üòé. Mari kita terus berjalan bersama, Sayang!"
        </div>

        <p class="signature">Dengan cinta,<br>Pacarmu yang paling ganteng ‚ù§Ô∏è</p>

        <button class="reveal-btn" onclick="reveal(this)">Klik Hati di Atas! üíï</button>
        
        <!-- Surat Terakhir dengan Password -->
        <div class="final-letter-section" style="margin-top: 40px;">
          <div class="final-letter-locked" id="letterLocked">
            <div style="font-size: 60px; margin-bottom: 15px;">üîí</div>
            <h3 style="margin-bottom: 15px; color: var(--primary);">Surat Terakhir</h3>
            <p style="opacity: 0.8; margin-bottom: 20px;">Masukkan kata kunci untuk membuka surat terakhir</p>
            <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap; align-items: center;">
              <div style="position: relative; display: inline-block;">
                <input type="password" id="letterPassword" placeholder="Kata kunci..." 
                  style="padding: 12px 45px 12px 20px; border-radius: 25px; border: 2px solid rgba(122, 162, 255, 0.3); 
                  background: rgba(16, 16, 28, 0.8); color: var(--light); font-size: 16px; min-width: 200px; 
                  text-align: center;" onkeypress="if(event.key==='Enter') unlockFinalLetter()">
                <span class="toggle-password" onclick="togglePasswordVisibility('letterPassword', this)">
                  üëÅÔ∏è
                </span>
              </div>
              <button onclick="unlockFinalLetter()" 
                style="padding: 12px 30px; border-radius: 25px; border: none; 
                background: linear-gradient(135deg, var(--primary), var(--secondary)); 
                color: white; font-weight: bold; cursor: pointer; transition: all 0.3s ease;">
                Buka üîì
              </button>
            </div>
            <p id="letterHint" style="margin-top: 15px; font-size: 13px; opacity: 0; color: var(--accent);">
              Hint: Kata yang ada di dalam surat üíï
            </p>
          </div>
          
          <div class="final-letter-unlocked" id="letterUnlocked" style="display: none;">
            <div style="font-size: 50px; margin-bottom: 15px; animation: heartBeat 1.5s infinite;">üíå</div>
            <h3 style="margin-bottom: 20px; color: var(--primary);">Surat Terakhir Untukmu</h3>
            <div class="letter-content" style="background: rgba(16, 16, 28, 0.6); padding: 30px; border-radius: 16px; 
              border: 2px solid rgba(122, 162, 255, 0.2); text-align: left; line-height: 1.8; max-width: 600px; margin: 0 auto;">
              <p style="margin-bottom: 15px;">Sayanggg, Hehe</p>
              
              <p style="margin-bottom: 15px;">Ini sedikit pikiran kuu yaa, biar ku tuangkan disini...</p>
              
              <p style="margin-bottom: 10px;"><strong>Kamu....</strong></p>
              <p style="margin-bottom: 15px;">Masih belum bisa sepenuhnya jadi diri kamu sendiri saat sama akuu kannüòÅ<br>
              Kenapaaa?</p>
              
              <p style="margin-bottom: 15px;">Aku mikirnya sihh, kemungkinan kamu masihh belum terbiasa yaa? Canggungg? Hmm it's okeyy, sama kokk<br>
              Akuu juga kadang canggung, ketahan gitu mau ngapain takut ada yangg nguawor gitukan kelakuankuüòÇ sekarang juga masihh belajar nihh supaya bisa lebih santaiüôÇ‚Äç‚ÜïÔ∏è kita belajar sama sama yaaaüòâ</p>
              
              <p style="margin-bottom: 10px;"><strong>Sama ini juga...</strong></p>
              <p style="margin-bottom: 10px;">Kamu takut akuu ilfill yahhh? Hehe<br>Gini sayangg....</p>
              <p style="margin-bottom: 15px; font-style: italic; color: var(--primary);">"Aku mencintai langit bukan hanya saat ia biru, tapi juga ketika ia muram; sebab mencinta berarti menerima segala cuaca yang datang bersamanya."</p>
              
              <p style="margin-bottom: 10px;">Maksudnya gimanaaa?<br>Gini...</p>
              <p style="margin-bottom: 15px;">Aku mencintai muu, artinya aku juga harus mencintai semua tentang muu.<br>
              Semua egomu, semua keinginanmu.... Dan dll lah, aku males kebanyakan ngetiküòÖ</p>
              
              <p style="margin-bottom: 15px;">Tapi intinya... <strong style="color: var(--accent);">inginku</strong> yaaa sayangg, kamu nggak perlu nyembunyiin diri kamuu, keluarin aja, aku bakal terima, karna itu kamu... Orang yangg akuu cintaaa. AseekkküòÇ<br>
              Tapi beda kalau aku cemburu yakk, gabisa itu nerima nerima, cihhüòë</p>
              
              <p style="margin-bottom: 15px;">Semisal kamu mau ngerubah diri jadi lebih baik nih, gpp juga sihh, bagus bagus aja, tapi jangan dipaksa yaa sayangg. Yang aku mau itu melihat senyum mu yangg tuluss bukan senyum karna dipaksakan. Aseekkk wkwküò≠</p>
              
              <p style="margin-bottom: 15px;">Dah itu aja, semoga apa yang ingin aku sampaikan, tersampaikan dengan baik kepadamu.</p>
              
              <p style="margin-bottom: 20px;"><strong>Dan yahhh, pokoknya aku sayang kamuüòã</strong></p>
              
              <p style="font-size: 13px; opacity: 0.7; font-style: italic;">Edit : maap ya tulisannya acak2an, ini aku yang nulis sendiri soalnya, yang sebelum2 nya itu pake AIüòÖ<br>
              Tapi itu tanda yangg, artinya aku menuangkan lebih banyak ketulusan disini (yang sebelumnya tulus juga yakk, tapi lebihh tulusan disini gitu looüôÇ‚Äç‚ÜïÔ∏è)</p>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>

  <!-- ============ AUDIO ============ -->
  <!-- Background Music Audio Player -->
  <audio id="bgMusic" loop preload="auto" playsinline crossorigin="anonymous">
    <!-- Main Song: Nadhif Basalamah - Kota Ini Tak Sama Tanpamu -->
    <source src="music/Nadhif Basalamah - kota ini tak sama tanpamu  Karaoke - Lirik - Instrumental.mp3" type="audio/mpeg">
    <!-- Fallback 1: Soft Romantic Instrumental (kalau file utama ga load) -->
    <source src="https://assets.mixkit.co/music/preview/mixkit-beautiful-dream-493.mp3" type="audio/mpeg">
    <!-- Fallback 2: Romantic Piano -->
    <source src="https://assets.mixkit.co/music/preview/mixkit-romantic-piano-365.mp3" type="audio/mpeg">
  </audio>

  <!-- ============ JAVASCRIPT ============ -->
  <script>
    // ============ CONSTANTS ============
    const PASSWORD = 'loveu'; // Ganti dengan password yang kamu mau
    const RELATIONSHIP_START_DATE = new Date('2026-01-09'); // Tanggal mulai: 9 Januari 2026
    const overlay = document.getElementById('overlay');
    const passwordInput = document.getElementById('passwordInput');
    const errorMsg = document.getElementById('errorMsg');
    const bgMusic = document.getElementById('bgMusic');
    const musicControl = document.getElementById('musicControl');
    const notification = document.getElementById('notification');
    const secretMsg = document.getElementById('secretMsg');
    const mainTitle = document.getElementById('mainTitle');

    // ============ AUTO-UPDATE DAYS COUNTER ============
    function updateDaysCounter() {
      const now = new Date();
      const diffTime = Math.abs(now - RELATIONSHIP_START_DATE);
      const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
      
      const daysElement = document.querySelector('[data-stat="days"] .stat-number');
      if (daysElement) {
        daysElement.textContent = diffDays;
      }
    }
    
    // Update immediately and then every hour
    updateDaysCounter();
    setInterval(updateDaysCounter, 3600000); // Update setiap 1 jam

    // ============ BACKGROUND PARTICLES ============
    function createParticles() {
      const particlesContainer = document.getElementById('particles');
      for (let i = 0; i < 20; i++) {
        const particle = document.createElement('div');
        particle.className = 'particle';
        particle.style.width = Math.random() * 8 + 4 + 'px';
        particle.style.height = particle.style.width;
        particle.style.left = Math.random() * 100 + '%';
        particle.style.top = Math.random() * 100 + '%';
        particle.style.animationDelay = Math.random() * 8 + 's';
        particle.style.animationDuration = Math.random() * 4 + 6 + 's';
        particlesContainer.appendChild(particle);
      }
    }

    // ============ STARS ============
    function createStars() {
      const starsContainer = document.getElementById('stars');
      for (let i = 0; i < 100; i++) {
        const star = document.createElement('div');
        star.className = 'star';
        star.style.left = Math.random() * 100 + '%';
        star.style.top = Math.random() * 100 + '%';
        star.style.animationDelay = Math.random() * 3 + 's';
        starsContainer.appendChild(star);
      }
    }

    // ============ FLOATING HEARTS ============
    function createBgHearts() {
      const hearts = ['‚ù§Ô∏è', 'üíï', 'üíñ', 'üíó', 'üíù', 'üíò'];
      for (let i = 0; i < 15; i++) {
        const heart = document.createElement('div');
        heart.className = 'bg-heart';
        heart.textContent = hearts[Math.floor(Math.random() * hearts.length)];
        heart.style.left = Math.random() * 100 + '%';
        heart.style.top = Math.random() * 100 + '%';
        heart.style.animationDelay = Math.random() * 15 + 's';
        heart.style.animationDuration = Math.random() * 5 + 12 + 's';
        document.body.appendChild(heart);
      }
    }

    // ============ TOGGLE PASSWORD VISIBILITY ============
    function togglePasswordVisibility(inputId, iconElement) {
      const input = document.getElementById(inputId);
      
      if (input.type === 'password') {
        input.type = 'text';
        iconElement.textContent = 'üôà'; // Mata tertutup = sedang show password
        iconElement.style.animation = 'pulse 0.3s ease';
        setTimeout(() => {
          iconElement.style.animation = '';
        }, 300);
      } else {
        input.type = 'password';
        iconElement.textContent = 'üëÅÔ∏è'; // Mata terbuka = password hidden
        iconElement.style.animation = 'pulse 0.3s ease';
        setTimeout(() => {
          iconElement.style.animation = '';
        }, 300);
      }
    }

    // ============ PASSWORD CHECK ============
    // ============ USER SELECTION ============
    let currentUser = null;

    function selectUser(user) {
      currentUser = user;
      
      // Save to localStorage
      localStorage.setItem('selectedUser', user);
      
      // Update UI
      document.querySelectorAll('.user-card').forEach(card => {
        card.classList.remove('selected');
      });
      document.getElementById('user' + user).classList.add('selected');
      
      // Show password section
      document.getElementById('passwordSection').style.display = 'block';
      document.getElementById('selectedUserName').textContent = user === 'BF' ? 'Boyfriend' : 'Girlfriend';
      
      // Focus password input
      setTimeout(() => {
        document.getElementById('passwordInput').focus();
      }, 300);
    }

    function backToUserSelection() {
      currentUser = null;
      document.getElementById('passwordSection').style.display = 'none';
      document.getElementById('passwordInput').value = '';
      document.querySelectorAll('.user-card').forEach(card => {
        card.classList.remove('selected');
      });
    }

    function checkPassword() {
      if (!currentUser) {
        showNotification('‚ö†Ô∏è Pilih user terlebih dahulu!');
        return;
      }

      const input = passwordInput.value.toLowerCase().trim();
      
      if (input === PASSWORD) {
        overlay.style.animation = 'fadeOut 0.8s ease forwards';
        setTimeout(() => {
          overlay.style.display = 'none';
        }, 800);
        
        const userName = currentUser === 'BF' ? 'Boyfriend' : 'Girlfriend';
        showNotification(`üéâ Welcome, ${userName}! üíï`);
        createConfetti();
        
        // Try to auto-play music after unlock (mobile-friendly)
        tryAutoPlayAfterUnlock();
      } else {
        errorMsg.classList.add('show');
        passwordInput.value = '';
        passwordInput.style.animation = 'shake 0.5s ease';
        
        setTimeout(() => {
          errorMsg.classList.remove('show');
          passwordInput.style.animation = '';
        }, 2000);
      }
    }

    // Enter key untuk password
    passwordInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') checkPassword();
    });

    // ============ NOTIFICATION ============
    function showNotification(message) {
      notification.textContent = message;
      notification.classList.add('show');
      
      setTimeout(() => {
        notification.classList.remove('show');
      }, 3000);
    }

    // ============ MUSIC CONTROL ============
    let isMusicPlaying = false;
    let audioInitialized = false;

    // Initialize audio on first user interaction (mobile-friendly)
    function initAudio() {
      if (!audioInitialized) {
        try {
          bgMusic.load();
          bgMusic.volume = 0.3; // Set volume to 30% (lebih kecil)
          audioInitialized = true;
          console.log('Audio initialized successfully');
        } catch (e) {
          console.error('Audio initialization failed:', e);
          showNotification('‚ö†Ô∏è Audio tidak dapat dimuat');
        }
      }
    }

    function toggleMusic() {
      // Make sure audio is initialized
      initAudio();
      
      if (isMusicPlaying) {
        bgMusic.pause();
        musicControl.classList.remove('playing');
        musicControl.innerHTML = '<span class="music-icon">üîá</span><span class="music-text">Musik</span>';
        isMusicPlaying = false;
        showNotification('üéµ Musik di-pause');
      } else {
        // Try to play with better error handling and user feedback
        showNotification('üéµ Memuat musik...');
        const playPromise = bgMusic.play();
        
        if (playPromise !== undefined) {
          playPromise.then(() => {
            musicControl.classList.add('playing');
            musicControl.innerHTML = '<span class="music-icon">üéµ</span><span class="music-text">Playing</span>';
            isMusicPlaying = true;
            showNotification('üéµ Musik diputar!');
            console.log('Music playing successfully');
          }).catch(err => {
            console.error('Audio play failed:', err);
            showNotification('‚ö†Ô∏è Klik tombol musik sekali lagi untuk memutar');
            // Reset state
            isMusicPlaying = false;
            musicControl.classList.remove('playing');
            
            // Auto-retry once after user gesture
            setTimeout(() => {
              const retryPromise = bgMusic.play();
              if (retryPromise !== undefined) {
                retryPromise.then(() => {
                  musicControl.classList.add('playing');
                  musicControl.innerHTML = '<span class="music-icon">üéµ</span><span class="music-text">Playing</span>';
                  isMusicPlaying = true;
                  showNotification('üéµ Musik berhasil diputar!');
                }).catch(e => {
                  console.error('Retry failed:', e);
                });
              }
            }, 500);
          });
        }
      }
    }

    // Multiple trigger points for mobile compatibility
    let musicAttempted = false;
    
    // Try on any click
    document.addEventListener('click', function autoPlayClick() {
      if (!musicAttempted) {
        musicAttempted = true;
        initAudio();
        
        // Small delay then try to play
        setTimeout(() => {
          bgMusic.play().then(() => {
            musicControl.classList.add('playing');
            musicControl.innerHTML = '<span class="music-icon">üéµ</span><span class="music-text">Playing</span>';
            isMusicPlaying = true;
          }).catch(() => {
            console.log('Autoplay blocked - user needs to click music button');
          });
        }, 100);
      }
    }, { once: true });
    
    // Try on touchstart for mobile
    document.addEventListener('touchstart', function autoPlayTouch() {
      initAudio();
    }, { once: true, passive: true });
    
    // Try after password unlock
    function tryAutoPlayAfterUnlock() {
      initAudio();
      setTimeout(() => {
        if (!isMusicPlaying) {
          bgMusic.play().then(() => {
            musicControl.classList.add('playing');
            musicControl.innerHTML = '<span class="music-icon">üéµ</span><span class="music-text">Playing</span>';
            isMusicPlaying = true;
          }).catch(() => {
            console.log('Need manual music start');
          });
        }
      }, 500);
    }

    // ============ EASTER EGGS ============
    let clickCount = 0;
    let cursorTrailEnabled = false;
    let rainbowEnabled = false;

    document.addEventListener('click', (e) => {
      clickCount++;

      // Clicks sama dengan jumlah hari bersama
      const now = new Date();
      const diffTime = Math.abs(now - RELATIONSHIP_START_DATE);
      const currentDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
      
      if (clickCount === currentDays) {
        showNotification(`üéä ${currentDays} Clicks = ${currentDays} Hari Bersama! üíï`);
        createMassiveConfetti();
      }

      // 50 clicks = cursor trail
      if (clickCount === 50) {
        cursorTrailEnabled = true;
        showNotification('‚ú® Cursor trail activated! üåü');
      }

      // 100 clicks = rainbow mode (toggle on/off)
      if (clickCount === 100) {
        rainbowEnabled = !rainbowEnabled;
        if (rainbowEnabled) {
          document.body.classList.add('rainbow-mode');
          showNotification('üåà RAINBOW MODE ACTIVATED! üé®');
        } else {
          document.body.classList.remove('rainbow-mode');
          showNotification('‚ö™ Rainbow mode OFF');
        }
        clickCount = 0; // Reset untuk bisa toggle lagi
      }

      // Cursor trail
      if (cursorTrailEnabled) {
        const trail = document.createElement('div');
        trail.className = 'cursor-trail';
        trail.style.left = e.pageX + 'px';
        trail.style.top = e.pageY + 'px';
        document.body.appendChild(trail);
        
        setTimeout(() => trail.remove(), 1000);
      }
    });

    // ============ KONAMI CODE ============
    let konamiCode = [];
    const konamiSequence = ['ArrowUp', 'ArrowUp', 'ArrowDown', 'ArrowDown', 
                            'ArrowLeft', 'ArrowRight', 'ArrowLeft', 'ArrowRight', 
                            'b', 'a'];

    document.addEventListener('keydown', (e) => {
      konamiCode.push(e.key);
      konamiCode = konamiCode.slice(-10);
      
      if (konamiCode.join('') === konamiSequence.join('')) {
        secretMsg.classList.add('show');
        createMassiveConfetti();
        showNotification('üéÆ KONAMI CODE! Extra love unlocked! üíï');
        konamiCode = [];
      }
    });

    // ============ TITLE EASTER EGG ============
    let titleClickCount = 0;
    mainTitle.addEventListener('click', () => {
      titleClickCount++;
      
      if (titleClickCount === 5) {
        mainTitle.textContent = 'Aku Sayang Banget Sama Kamu! üíï';
        createConfetti();
        setTimeout(() => {
          mainTitle.textContent = 'Untuk Kamu, Sayangku ‚ù§';
          titleClickCount = 0;
        }, 3000);
      }
    });

    // ============ STATS EASTER EGG ============
    document.querySelectorAll('.stat').forEach(stat => {
      stat.addEventListener('click', function() {
        const type = this.dataset.stat;
        
        // Get current days dynamically
        const now = new Date();
        const diffTime = Math.abs(now - RELATIONSHIP_START_DATE);
        const currentDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
        
        const messages = {
          days: `üìÖ ${currentDays} hari yang unforgettable!`,
          memories: 'üí≠ Setiap detik bersamamu adalah kenangan!',
          love: '‚ù§Ô∏è Love meter: MAXIMUM!'
        };
        showNotification(messages[type]);
        this.style.animation = 'pulse 0.5s ease';
        createHeartBurst(this);
        setTimeout(() => {
          this.style.animation = '';
        }, 500);
      });
    });

    // ============ NEW EASTER EGGS ============
    
    // Triple Click anywhere
    let tripleClickTimer;
    let tripleClickCount = 0;
    document.addEventListener('click', (e) => {
      tripleClickCount++;
      clearTimeout(tripleClickTimer);
      
      if (tripleClickCount === 3) {
        createHeartAnimation(e.pageX, e.pageY);
        showNotification('üíñ Triple Love! üíñ');
        tripleClickCount = 0;
      }
      
      tripleClickTimer = setTimeout(() => {
        tripleClickCount = 0;
      }, 500);
    });

    // Shake device/window
    let shakeCount = 0;
    let lastX = 0, lastY = 0, lastZ = 0;
    
    if (window.DeviceMotionEvent) {
      window.addEventListener('devicemotion', (e) => {
        const acc = e.accelerationIncludingGravity;
        const deltaX = Math.abs(acc.x - lastX);
        const deltaY = Math.abs(acc.y - lastY);
        const deltaZ = Math.abs(acc.z - lastZ);
        
        if (deltaX + deltaY + deltaZ > 30) {
          shakeCount++;
          if (shakeCount >= 3) {
            createMassiveConfetti();
            showNotification('üì≥ Shake detected! Love is in the air! üíï');
            shakeCount = 0;
          }
        }
        
        lastX = acc.x;
        lastY = acc.y;
        lastZ = acc.z;
      });
    }

    // Secret word typing
    let typedWord = '';
    const secretWords = {
      'iloveyou': 'üíï I Love You Too! Forever and always! üíï',
      'sayang': '‚ù§Ô∏è Sayang banget sama kamu juga! ‚ù§Ô∏è',
      'journey': '‚ú® Perjalanan indah kita bersama! üéä',
      'forever': '‚ôæÔ∏è Forever and ever, my love! ‚ôæÔ∏è',
      'kiss': 'üíã *Sending virtual kisses* üíã',
      'hug': 'ü§ó *Big warm hug for you* ü´Ç'
    };

    // Toggle rainbow mode dengan ESC key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        rainbowEnabled = !rainbowEnabled;
        if (rainbowEnabled) {
          document.body.classList.add('rainbow-mode');
          showNotification('üåà RAINBOW MODE ON! (Press ESC to toggle) üé®');
        } else {
          document.body.classList.remove('rainbow-mode');
          showNotification('‚ö™ Rainbow mode OFF (Press ESC to toggle)');
        }
      }
    });

    document.addEventListener('keypress', (e) => {
      typedWord += e.key.toLowerCase();
      typedWord = typedWord.slice(-20);
      
      for (let word in secretWords) {
        if (typedWord.includes(word)) {
          showNotification(secretWords[word]);
          createConfetti();
          typedWord = '';
          break;
        }
      }
    });

    // Long press on title
    let pressTimer;
    mainTitle.addEventListener('mousedown', () => {
      pressTimer = setTimeout(() => {
        mainTitle.style.animation = 'heartBeat 1s ease infinite';
        showNotification('üíì You\'re holding my heart! üíì');
      }, 2000);
    });

    mainTitle.addEventListener('mouseup', () => {
      clearTimeout(pressTimer);
      mainTitle.style.animation = '';
    });

    mainTitle.addEventListener('touchstart', () => {
      pressTimer = setTimeout(() => {
        mainTitle.style.animation = 'heartBeat 1s ease infinite';
        showNotification('üíì You\'re holding my heart! üíì');
      }, 2000);
    });

    mainTitle.addEventListener('touchend', () => {
      clearTimeout(pressTimer);
      mainTitle.style.animation = '';
    });

    // Scroll Easter Egg
    let scrollCount = 0;
    let lastScrollTop = 0;
    window.addEventListener('scroll', () => {
      const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
      
      if (Math.abs(scrollTop - lastScrollTop) > 100) {
        scrollCount++;
        if (scrollCount >= 10) {
          showNotification('üé¢ Scrolling through our memories! üí´');
          createConfetti();
          scrollCount = 0;
        }
      }
      lastScrollTop = scrollTop;
    });

    // Time-based Easter Eggs
    const now = new Date();
    const hour = now.getHours();
    
    setTimeout(() => {
      if (hour >= 0 && hour < 6) {
        showNotification('üåô Masih begadang? Sweet dreams my love! üò¥');
      } else if (hour >= 6 && hour < 12) {
        showNotification('‚òÄÔ∏è Good morning sayang! Have a great day! üíï');
      } else if (hour >= 12 && hour < 18) {
        showNotification('üå§Ô∏è Good afternoon! Hope you\'re having a wonderful day! üíñ');
      } else {
        showNotification('üåÜ Good evening! Thinking of you! üíï');
      }
    }, 5000);

    // Click all stats in sequence
    let statsSequence = [];
    document.querySelectorAll('.stat').forEach((stat, index) => {
      stat.addEventListener('click', () => {
        statsSequence.push(index);
        statsSequence = statsSequence.slice(-3);
        
        if (statsSequence.join('') === '012') {
          showNotification('üéØ Perfect sequence! Days ‚Üí Memories ‚Üí Love! üíù');
          createMassiveConfetti();
          statsSequence = [];
        }
      });
    });

    // Hover over subtitle
    const subtitle = document.querySelector('.subtitle');
    let hoverCount = 0;
    if (subtitle) {
      subtitle.addEventListener('mouseenter', () => {
        hoverCount++;
        if (hoverCount === 3) {
          subtitle.textContent = '‚ú® You found me! ‚ú®';
          createConfetti();
          setTimeout(() => {
            subtitle.textContent = 'Setiap Hari Adalah Petualangan Baru';
            hoverCount = 0;
          }, 2000);
        }
      });
    }

    // Double click on date
    const dateEl = document.querySelector('.date');
    if (dateEl) {
      dateEl.addEventListener('dblclick', () => {
        dateEl.style.animation = 'rainbow 3s linear infinite';
        showNotification('üìÖ Best day of my life! üíï');
        setTimeout(() => {
          dateEl.style.animation = '';
        }, 3000);
      });
    }

    // Click speed test
    let speedClicks = [];
    document.addEventListener('click', () => {
      const now = Date.now();
      speedClicks.push(now);
      speedClicks = speedClicks.filter(time => now - time < 1000);
      
      if (speedClicks.length >= 10) {
        showNotification('‚ö° WOW! Super fast clicker! You\'re amazing! üåü');
        createMassiveConfetti();
        speedClicks = [];
      }
    });

    // Midnight surprise
    const checkMidnight = () => {
      const now = new Date();
      if (now.getHours() === 0 && now.getMinutes() === 0) {
        showNotification('üåü It\'s midnight! Another day to love you! üíï');
        createMassiveConfetti();
      }
    };
    setInterval(checkMidnight, 60000);

    // Random surprise every 5 minutes
    setInterval(() => {
      const surprises = [
        'üíù Random love reminder: You\'re amazing!',
        '‚ú® Just thinking about you! üí≠',
        'üåü You make every day special! üíñ',
        'üíï Missing you right now! ü•∞',
        'üéà Surprise! You\'re the best! üí´'
      ];
      const randomSurprise = surprises[Math.floor(Math.random() * surprises.length)];
      showNotification(randomSurprise);
    }, 300000);


    function createHeartBurst(element) {
      const rect = element.getBoundingClientRect();
      for (let i = 0; i < 5; i++) {
        const heart = document.createElement('div');
        heart.textContent = '‚ù§Ô∏è';
        heart.style.cssText = `
          position: fixed;
          left: ${rect.left + rect.width/2}px;
          top: ${rect.top}px;
          font-size: 20px;
          pointer-events: none;
          z-index: 1000;
          animation: burstUp${i} 1.5s ease forwards;
        `;
        document.body.appendChild(heart);
        setTimeout(() => heart.remove(), 1500);
      }
    }

    const burstStyle = document.createElement('style');
    burstStyle.textContent = `
      @keyframes burstUp0 { to { transform: translate(-30px, -80px); opacity: 0; } }
      @keyframes burstUp1 { to { transform: translate(-15px, -100px); opacity: 0; } }
      @keyframes burstUp2 { to { transform: translate(0px, -110px); opacity: 0; } }
      @keyframes burstUp3 { to { transform: translate(15px, -100px); opacity: 0; } }
      @keyframes burstUp4 { to { transform: translate(30px, -80px); opacity: 0; } }
    `;
    document.head.appendChild(burstStyle);

    // ============ RIPPLE EFFECT ============
    document.querySelectorAll('button').forEach(button => {
      button.addEventListener('click', createRipple);
    });

    function createRipple(e) {
      const button = e.currentTarget;
      const ripple = document.createElement('span');
      ripple.className = 'ripple';
      
      const rect = button.getBoundingClientRect();
      const size = Math.max(rect.width, rect.height);
      const x = e.clientX - rect.left - size / 2;
      const y = e.clientY - rect.top - size / 2;
      
      ripple.style.width = ripple.style.height = size + 'px';
      ripple.style.left = x + 'px';
      ripple.style.top = y + 'px';
      
      button.appendChild(ripple);
      setTimeout(() => ripple.remove(), 700);
    }

    // ============ SECTION NAVIGATION ============
    // Navigation history stack
    const navigationHistory = [];

    function openSection(id) {
      // Save current view to history
      const currentView = document.querySelector('.section.active, #menu[style*="display: grid"]');
      if (currentView) {
        if (currentView.id === 'menu') {
          navigationHistory.push('menu');
        } else {
          navigationHistory.push(currentView.id);
        }
      }

      // Hide current view
      if (document.getElementById('menu').style.display !== 'none') {
        document.getElementById('menu').style.animation = 'fadeOut 0.4s ease forwards';
      }
      document.querySelectorAll('.section.active').forEach(s => {
        s.style.animation = 'fadeOut 0.4s ease forwards';
      });
      
      setTimeout(() => {
        document.getElementById('menu').style.display = 'none';
        document.querySelectorAll('.section').forEach(s => {
          s.style.display = 'none';
          s.classList.remove('active');
        });
        
        const sec = document.getElementById(id);
        sec.style.display = 'block';
        sec.classList.add('active');
        
        setTimeout(() => {
          const firstEl = sec.querySelector('p, .memory-card, .milestone-header');
          if (firstEl) firstEl.classList.add('show');
        }, 400);
      }, 400);
    }

    function goBack() {
      // Get previous view from history
      const previousView = navigationHistory.pop();
      
      // Hide current view
      document.querySelectorAll('.section').forEach(s => {
        s.style.animation = 'fadeOut 0.4s ease forwards';
      });
      
      setTimeout(() => {
        document.querySelectorAll('.section').forEach(s => {
          s.style.display = 'none';
          s.style.animation = '';
          s.classList.remove('active');
          s.querySelectorAll('p, h3, .quote, .love-list li, .timeline-item, .gallery-item, .memory-card').forEach(el => el.classList.remove('show'));
        });
        
        // Show previous view
        if (previousView === 'menu' || !previousView) {
          const menu = document.getElementById('menu');
          menu.style.display = 'grid';
          menu.style.animation = 'fadeInUp 0.6s ease forwards';
        } else {
          const sec = document.getElementById(previousView);
          sec.style.display = 'block';
          sec.classList.add('active');
          sec.style.animation = 'fadeInUp 0.6s ease forwards';
        }
      }, 400);
    }

    function reveal(btn) {
      const section = btn.parentElement;
      const elements = section.querySelectorAll('p, h3, .quote, .love-list li, .timeline-item, .gallery-item, .memory-card');
      
      elements.forEach((el, index) => {
        setTimeout(() => {
          el.classList.add('show');
        }, index * 120);
      });
      
      btn.style.animation = 'pulse 0.6s ease';
      setTimeout(() => {
        btn.style.animation = '';
      }, 600);
    }

    // ============ FINAL LETTER UNLOCK ============
    let letterAttempts = 0;
    const LETTER_PASSWORD = 'inginnya'; // Kata kunci untuk membuka surat
    
    function unlockFinalLetter() {
      const input = document.getElementById('letterPassword');
      const password = input.value.toLowerCase().trim();
      const hintElement = document.getElementById('letterHint');
      
      if (password === LETTER_PASSWORD) {
        // Password benar - buka surat
        document.getElementById('letterLocked').style.display = 'none';
        document.getElementById('letterUnlocked').style.display = 'block';
        
        // Animasi reveal
        const letterContent = document.querySelector('.letter-content');
        letterContent.style.animation = 'fadeInUp 1s ease';
        
        // Confetti celebration
        createConfetti();
        showNotification('üíå Surat berhasil dibuka!');
        
        // Scroll to letter
        setTimeout(() => {
          document.getElementById('letterUnlocked').scrollIntoView({ behavior: 'smooth', block: 'center' });
        }, 300);
        
      } else {
        // Password salah
        letterAttempts++;
        input.value = '';
        input.style.animation = 'shake 0.5s ease';
        setTimeout(() => {
          input.style.animation = '';
        }, 500);
        
        if (letterAttempts === 1) {
          showNotification('‚ùå Kata kunci salah! Coba lagi...');
        } else if (letterAttempts === 2) {
          showNotification('üí≠ Hmm... Pikirkan kata yang ada di surat ini');
          hintElement.style.opacity = '0.6';
        } else if (letterAttempts >= 3) {
          showNotification('üí° Hint: Kata yang sering dipakai saat menyampaikan keinginan');
          hintElement.style.opacity = '1';
          hintElement.style.animation = 'pulse 2s infinite';
        }
      }
    }

    function showHeart() {
      const heart = document.getElementById('heart');
      heart.classList.add('show');
      
      const heartRect = heart.getBoundingClientRect();
      const heartCenterX = heartRect.left + heartRect.width / 2;
      const heartCenterY = heartRect.top + heartRect.height / 2;
      
      for (let i = 0; i < 20; i++) {
        const sparkle = document.createElement('div');
        sparkle.className = 'sparkle';
        const angle = (i * 18) * Math.PI / 180;
        const distance = 80;
        sparkle.style.left = (heartCenterX + Math.cos(angle) * distance) + 'px';
        sparkle.style.top = (heartCenterY + Math.sin(angle) * distance) + 'px';
        sparkle.style.animationDelay = (i * 0.08) + 's';
        document.body.appendChild(sparkle);
        
        setTimeout(() => sparkle.remove(), 2000);
      }
      
      createMassiveConfetti();
      showNotification('‚ù§Ô∏è I LOVE YOU TOO! Selamanya! üéâ');
    }

    function createConfetti() {
      const colors = ['#7aa2ff', '#9b7dff', '#ff6b6b', '#ffd93d', '#6bcf7f'];
      
      for (let i = 0; i < 50; i++) {
        const confetti = document.createElement('div');
        confetti.style.cssText = `
          position: fixed;
          width: 10px;
          height: 10px;
          background: ${colors[Math.floor(Math.random() * colors.length)]};
          top: -10px;
          left: ${Math.random() * 100}%;
          opacity: 1;
          transform: rotate(${Math.random() * 360}deg);
          animation: confettiFall ${2 + Math.random() * 2}s ease-out forwards;
          z-index: 1000;
          pointer-events: none;
        `;
        document.body.appendChild(confetti);
        
        setTimeout(() => confetti.remove(), 4000);
      }
    }

    function createMassiveConfetti() {
      for (let i = 0; i < 3; i++) {
        setTimeout(() => createConfetti(), i * 300);
      }
    }

    const style = document.createElement('style');
    style.textContent = `
      @keyframes confettiFall {
        to {
          top: 100vh;
          transform: rotate(${Math.random() * 720}deg);
          opacity: 0;
        }
      }
    `;
    document.head.appendChild(style);

    function closeSecret() {
      secretMsg.classList.remove('show');
    }

    // ============ GALLERY INTERACTION ============
    document.querySelectorAll('.gallery-item').forEach(item => {
      item.addEventListener('click', function() {
        this.style.animation = 'heartBeat 0.8s ease';
        const emoji = this.textContent;
        showNotification(`${emoji} ${this.title}`);
        createConfetti();
        
        setTimeout(() => {
          this.style.animation = '';
        }, 800);
      });
    });

    // ============ DOUBLE TAP ============
    let lastTap = 0;
    document.addEventListener('touchend', (e) => {
      const currentTime = new Date().getTime();
      const tapLength = currentTime - lastTap;
      
      if (tapLength < 300 && tapLength > 0) {
        createHeartAnimation(e.changedTouches[0].pageX, e.changedTouches[0].pageY);
      }
      lastTap = currentTime;
    });

    function createHeartAnimation(x, y) {
      const heart = document.createElement('div');
      heart.textContent = '‚ù§Ô∏è';
      heart.style.cssText = `
        position: absolute;
        left: ${x}px;
        top: ${y}px;
        font-size: 30px;
        pointer-events: none;
        animation: floatUp 2s ease forwards;
        z-index: 1000;
      `;
      document.body.appendChild(heart);
      
      setTimeout(() => heart.remove(), 2000);
    }

    const floatUpStyle = document.createElement('style');
    floatUpStyle.textContent = `
      @keyframes floatUp {
        to {
          transform: translateY(-100px);
          opacity: 0;
        }
      }
    `;
    document.head.appendChild(floatUpStyle);

    // ============ GAME NAVIGATION ============
    function openGame(gameId) {
      document.getElementById('game').style.animation = 'fadeOut 0.4s ease forwards';
      
      setTimeout(() => {
        document.getElementById('game').style.display = 'none';
        const gameSection = document.getElementById(gameId);
        gameSection.style.display = 'block';
        gameSection.classList.add('active');
        gameSection.style.animation = 'fadeInUp 0.6s ease forwards';
        
        // Auto-start quiz when opened
        if (gameId === 'quiz') {
          setTimeout(() => startQuiz(), 100);
        }
        
        // Init wheel when spinwheel opened
        if (gameId === 'spinwheel') {
          setTimeout(() => initWheel(), 100);
        }
      }, 400);
    }

    function backToGames() {
      document.querySelectorAll('#heartcatcher, #memory, #quiz').forEach(s => {
        s.style.animation = 'fadeOut 0.4s ease forwards';
      });
      
      setTimeout(() => {
        document.querySelectorAll('#heartcatcher, #memory, #quiz').forEach(s => {
          s.style.display = 'none';
          s.style.animation = '';
          s.classList.remove('active');
        });
        
        const gameMenu = document.getElementById('game');
        gameMenu.style.display = 'block';
        gameMenu.style.animation = 'fadeInUp 0.6s ease forwards';
      }, 400);
    }

    // ============ HEART CATCHER GAME ============
    let gameScore = 0;
    let gameTime = 30;
    let gameLives = 3;
    let gameActive = false;
    let gameTimer = null;
    let heartTimer = null;
    let currentHearts = [];
    let gameLevel = 1;
    let gameSpawnSpeed = 800;
    let gameHighScore = localStorage.getItem('heartCatcherHighScore') || 0;
    let gamePowerUps = { shield: false, doublePoints: false, slowTime: false };
    let gameCombo = 0;

    const gameScoreEl = document.getElementById('gameScore');
    const gameTimeEl = document.getElementById('gameTime');
    const gameLivesEl = document.getElementById('gameLives');
    const gameBoard = document.getElementById('gameBoard');
    const gameStartBtn = document.getElementById('gameStartBtn');
    const gameResetBtn = document.getElementById('gameResetBtn');
    const gameMessage = document.getElementById('gameMessage');
    const gameHoles = document.querySelectorAll('.game-hole');

    function startGame() {
      gameScore = 0;
      gameTime = 30;
      gameLives = 3;
      gameActive = true;
      currentHearts = [];
      gameLevel = 1;
      gameSpawnSpeed = 800;
      gamePowerUps = { shield: false, doublePoints: false, slowTime: false };
      gameCombo = 0;
      
      updateGameUI();
      gameStartBtn.style.display = 'none';
      gameResetBtn.style.display = 'none';
      gameMessage.innerHTML = `Catch the hearts! üíï<br><small>High Score: ${gameHighScore}</small>`;
      
      gameHoles.forEach(hole => {
        hole.innerHTML = '';
      });
      
      gameTimer = setInterval(() => {
        gameTime--;
        gameTimeEl.textContent = gameTime;
        
        // Level up every 10 seconds
        if (gameTime % 10 === 0 && gameTime > 0) {
          gameLevel++;
          gameSpawnSpeed = Math.max(400, gameSpawnSpeed - 100);
          clearInterval(heartTimer);
          heartTimer = setInterval(spawnHeart, gameSpawnSpeed);
          showNotification(`üÜô Level ${gameLevel}! Speed increased!`);
        }
        
        if (gameTime <= 0 || gameLives <= 0) {
          endGame();
        }
      }, 1000);
      
      spawnHeart();
      heartTimer = setInterval(spawnHeart, gameSpawnSpeed);
    }

    function spawnHeart() {
      if (!gameActive) return;
      
      const randomHole = Math.floor(Math.random() * gameHoles.length);
      const hole = gameHoles[randomHole];
      
      if (hole.querySelector('.game-heart')) return;
      
      // 15% broken heart, 5% power-up
      const rand = Math.random();
      let heartEmoji, heartType;
      
      if (rand < 0.05 && !gamePowerUps.doublePoints) {
        heartEmoji = '‚≠ê'; // Double points power-up
        heartType = 'powerup-double';
      } else if (rand < 0.08 && !gamePowerUps.shield) {
        heartEmoji = 'üõ°Ô∏è'; // Shield power-up
        heartType = 'powerup-shield';
      } else if (rand < 0.10) {
        heartEmoji = 'üíé'; // Bonus points
        heartType = 'bonus';
      } else if (rand < 0.25) {
        heartEmoji = 'üíî'; // Broken heart
        heartType = 'broken';
      } else {
        heartEmoji = 'üíï'; // Normal heart
        heartType = 'normal';
      }
      
      const heart = document.createElement('div');
      heart.className = 'game-heart';
      heart.textContent = heartEmoji;
      heart.dataset.type = heartType;
      
      heart.addEventListener('click', () => {
        if (!gameActive) return;
        
        heart.classList.add('clicked');
        
        if (heartType === 'broken') {
          if (gamePowerUps.shield) {
            gamePowerUps.shield = false;
            showNotification('üõ°Ô∏è Shield protected you!');
          } else {
            gameLives--;
            updateGameUI();
            showNotification('üíî Ouch! Kena broken heart!');
            gameCombo = 0;
          }
          
          if (gameLives <= 0) {
            endGame();
          }
        } else if (heartType === 'powerup-double') {
          gamePowerUps.doublePoints = true;
          showNotification('‚≠ê DOUBLE POINTS for 5 seconds!');
          setTimeout(() => {
            gamePowerUps.doublePoints = false;
            showNotification('‚≠ê Double points ended!');
          }, 5000);
        } else if (heartType === 'powerup-shield') {
          gamePowerUps.shield = true;
          showNotification('üõ°Ô∏è SHIELD activated! Protected from next hit!');
        } else if (heartType === 'bonus') {
          const bonusPoints = 50;
          gameScore += bonusPoints;
          gameScoreEl.textContent = gameScore;
          showNotification('üíé +50 BONUS!');
          createConfetti();
        } else {
          // Normal heart
          gameCombo++;
          let points = 10;
          if (gamePowerUps.doublePoints) points *= 2;
          if (gameCombo >= 5) points += 5; // Combo bonus
          
          gameScore += points;
          gameScoreEl.textContent = gameScore;
          
          if (gameCombo >= 5) {
            showNotification(`üî• ${gameCombo}x COMBO! +${points} points!`);
          }
          
          if (gameScore % 100 === 0) {
            showNotification('üéâ 100 points milestone! +1 Life!');
            gameLives = Math.min(3, gameLives + 1);
            updateGameUI();
          }
        }
        
        setTimeout(() => {
          heart.remove();
        }, 400);
      });
      
      hole.appendChild(heart);
      
      setTimeout(() => {
        if (heart.parentElement && !heart.classList.contains('clicked')) {
          heart.remove();
          if (heartType === 'normal') {
            gameCombo = 0; // Reset combo if missed
          }
        }
      }, 1500);
    }

    function updateGameUI() {
      gameScoreEl.textContent = gameScore;
      gameTimeEl.textContent = gameTime;
      
      let livesDisplay = '';
      for (let i = 0; i < gameLives; i++) {
        livesDisplay += '‚ù§Ô∏è';
      }
      for (let i = gameLives; i < 3; i++) {
        livesDisplay += 'üñ§';
      }
      
      // Add power-up indicators
      if (gamePowerUps.shield) livesDisplay += ' üõ°Ô∏è';
      if (gamePowerUps.doublePoints) livesDisplay += ' ‚≠ê';
      
      gameLivesEl.textContent = livesDisplay;
    }

    function endGame() {
      gameActive = false;
      clearInterval(gameTimer);
      clearInterval(heartTimer);
      
      gameHoles.forEach(hole => {
        hole.innerHTML = '';
      });
      
      // Update high score
      let isNewHighScore = false;
      if (gameScore > gameHighScore) {
        gameHighScore = gameScore;
        localStorage.setItem('heartCatcherHighScore', gameHighScore);
        isNewHighScore = true;
      }
      
      let resultMessage = '';
      if (gameLives <= 0) {
        resultMessage = `üíî Game Over! Score: ${gameScore}<br>High Score: ${gameHighScore}`;
      } else if (isNewHighScore) {
        resultMessage = `üèÜ NEW HIGH SCORE! ${gameScore}! üéâ<br>Previous: ${gameHighScore}`;
        createMassiveConfetti();
      } else if (gameScore >= 200) {
        resultMessage = `üèÜ AMAZING! Score: ${gameScore}!<br>High Score: ${gameHighScore} üòçüíï`;
        createMassiveConfetti();
      } else if (gameScore >= 150) {
        resultMessage = `‚≠ê Great Job! Score: ${gameScore}!<br>High Score: ${gameHighScore} üéâ`;
        createConfetti();
      } else if (gameScore >= 100) {
        resultMessage = `üëç Good! Score: ${gameScore}!<br>High Score: ${gameHighScore} üíñ`;
      } else {
        resultMessage = `üí™ Score: ${gameScore}<br>High Score: ${gameHighScore}. Keep trying! üòä`;
      }
      
      gameMessage.innerHTML = resultMessage;
      gameResetBtn.style.display = 'inline-block';
      
      showNotification(resultMessage.replace(/<br>/g, ' '));
    }

    function resetGame() {
      gameResetBtn.style.display = 'none';
      gameStartBtn.style.display = 'inline-block';
      gameMessage.innerHTML = `Click Start to Play!<br><small>High Score: ${gameHighScore}</small>`;
      gameScore = 0;
      gameTime = 30;
      gameLives = 3;
      updateGameUI();
    }

    // ============ MEMORY CARD GAME ============
    const memoryEmojis = {
      easy: ['‚ù§Ô∏è', 'üíï', 'üíñ', 'üíó'],
      medium: ['‚ù§Ô∏è', 'üíï', 'üíñ', 'üíó', 'üíù', 'üíò'],
      hard: ['‚ù§Ô∏è', 'üíï', 'üíñ', 'üíó', 'üíù', 'üíò', 'üåπ', 'üíê']
    };
    let memoryCards = [];
    let memoryFlipped = [];
    let memoryMatches = 0;
    let memoryMoves = 0;
    let memoryActive = false;
    let memoryStartTime = 0;
    let memoryTimerInterval = null;
    let memoryDifficulty = 'medium';
    let memoryBestTimes = JSON.parse(localStorage.getItem('memoryBestTimes')) || { easy: null, medium: null, hard: null };
    let memoryAchievements = JSON.parse(localStorage.getItem('memoryAchievements')) || {
      perfectEasy: false,
      perfectMedium: false,
      perfectHard: false,
      speedster: false,
      master: false
    };

    function startMemoryGame(difficulty = 'medium') {
      // Get elements when function is called
      const memoryBoard = document.getElementById('memoryBoard');
      const memoryMovesEl = document.getElementById('memoryMoves');
      const memoryMatchesEl = document.getElementById('memoryMatches');
      const memoryTimeEl = document.getElementById('memoryTime');
      const memoryStartBtn = document.getElementById('memoryStartBtn');
      const memoryResetBtn = document.getElementById('memoryResetBtn');
      const memoryMessage = document.getElementById('memoryMessage');
      
      if (!memoryBoard) {
        console.error('memoryBoard not found');
        return;
      }
      
      memoryDifficulty = difficulty;
      memoryMatches = 0;
      memoryMoves = 0;
      memoryFlipped = [];
      memoryActive = true;
      memoryStartTime = Date.now();
      
      const emojiSet = memoryEmojis[difficulty];
      const totalPairs = emojiSet.length;
      
      if (memoryMovesEl) memoryMovesEl.textContent = '0';
      if (memoryMatchesEl) memoryMatchesEl.textContent = `0/${totalPairs}`;
      if (memoryTimeEl) memoryTimeEl.textContent = '0s';
      if (memoryMessage) {
        const bestTime = memoryBestTimes[difficulty];
        memoryMessage.innerHTML = `Difficulty: ${difficulty.toUpperCase()} üÉè<br>${bestTime ? `Best: ${bestTime}s` : 'No record yet'}`;
      }
      
      if (memoryStartBtn) memoryStartBtn.style.display = 'none';
      if (memoryResetBtn) memoryResetBtn.style.display = 'none';
      
      // Show difficulty selector
      const diffSelector = document.getElementById('memoryDifficultySelector');
      if (diffSelector) diffSelector.style.display = 'none';
      
      // Create card pairs
      memoryCards = [...emojiSet, ...emojiSet]
        .sort(() => Math.random() - 0.5)
        .map((emoji, index) => ({
          id: index,
          emoji: emoji,
          matched: false
        }));
      
      // Render cards
      memoryBoard.innerHTML = '';
      memoryCards.forEach((card, index) => {
        const cardEl = document.createElement('div');
        cardEl.className = 'memory-card';
        cardEl.dataset.id = index;
        cardEl.innerHTML = `
          <div class="memory-card-front">‚ùì</div>
          <div class="memory-card-back">${card.emoji}</div>
        `;
        cardEl.addEventListener('click', () => flipMemoryCard(index));
        memoryBoard.appendChild(cardEl);
      });
      
      // Adjust grid columns based on difficulty
      if (difficulty === 'easy') {
        memoryBoard.style.gridTemplateColumns = 'repeat(4, 1fr)';
      } else if (difficulty === 'medium') {
        memoryBoard.style.gridTemplateColumns = 'repeat(4, 1fr)';
      } else {
        memoryBoard.style.gridTemplateColumns = 'repeat(4, 1fr)';
      }
      
      // Start timer
      memoryTimerInterval = setInterval(() => {
        const elapsed = Math.floor((Date.now() - memoryStartTime) / 1000);
        if (memoryTimeEl) memoryTimeEl.textContent = elapsed + 's';
      }, 1000);
    }

    function flipMemoryCard(index) {
      const memoryBoard = document.getElementById('memoryBoard');
      const memoryMovesEl = document.getElementById('memoryMoves');
      const memoryMatchesEl = document.getElementById('memoryMatches');
      
      if (!memoryActive) return;
      if (memoryFlipped.length >= 2) return;
      if (memoryFlipped.includes(index)) return;
      if (memoryCards[index].matched) return;
      if (!memoryBoard) return;
      
      const cardEl = memoryBoard.children[index];
      if (!cardEl) return;
      
      cardEl.classList.add('flipped');
      memoryFlipped.push(index);
      
      if (memoryFlipped.length === 2) {
        memoryMoves++;
        if (memoryMovesEl) memoryMovesEl.textContent = memoryMoves;
        
        const [first, second] = memoryFlipped;
        const firstCard = memoryCards[first];
        const secondCard = memoryCards[second];
        
        if (firstCard.emoji === secondCard.emoji) {
          // Match!
          setTimeout(() => {
            memoryCards[first].matched = true;
            memoryCards[second].matched = true;
            if (memoryBoard.children[first]) memoryBoard.children[first].classList.add('matched');
            if (memoryBoard.children[second]) memoryBoard.children[second].classList.add('matched');
            memoryFlipped = [];
            
            memoryMatches++;
            const totalPairs = memoryEmojis[memoryDifficulty].length;
            if (memoryMatchesEl) memoryMatchesEl.textContent = memoryMatches + '/' + totalPairs;
            showNotification('üíñ Match! Bagus!');
            
            if (memoryMatches === totalPairs) {
              endMemoryGame();
            }
          }, 500);
        } else {
          // No match
          setTimeout(() => {
            if (memoryBoard.children[first]) memoryBoard.children[first].classList.remove('flipped');
            if (memoryBoard.children[second]) memoryBoard.children[second].classList.remove('flipped');
            memoryFlipped = [];
          }, 1000);
        }
      }
    }

    function endMemoryGame() {
      const memoryMessage = document.getElementById('memoryMessage');
      const memoryResetBtn = document.getElementById('memoryResetBtn');
      const diffSelector = document.getElementById('memoryDifficultySelector');
      
      memoryActive = false;
      clearInterval(memoryTimerInterval);
      
      const totalTime = Math.floor((Date.now() - memoryStartTime) / 1000);
      const totalPairs = memoryEmojis[memoryDifficulty].length;
      const perfectMoves = totalPairs; // Perfect = minimum moves
      
      // Check for new best time
      let isNewBest = false;
      if (!memoryBestTimes[memoryDifficulty] || totalTime < memoryBestTimes[memoryDifficulty]) {
        memoryBestTimes[memoryDifficulty] = totalTime;
        localStorage.setItem('memoryBestTimes', JSON.stringify(memoryBestTimes));
        isNewBest = true;
      }
      
      // Check achievements
      let achievementUnlocked = '';
      if (memoryMoves === perfectMoves && !memoryAchievements[`perfect${memoryDifficulty.charAt(0).toUpperCase() + memoryDifficulty.slice(1)}`]) {
        memoryAchievements[`perfect${memoryDifficulty.charAt(0).toUpperCase() + memoryDifficulty.slice(1)}`] = true;
        achievementUnlocked = `üèÜ Achievement: Perfect ${memoryDifficulty.toUpperCase()}!`;
      }
      
      if (totalTime < 30 && !memoryAchievements.speedster) {
        memoryAchievements.speedster = true;
        achievementUnlocked = '‚ö° Achievement: SPEEDSTER!';
      }
      
      if (memoryAchievements.perfectEasy && memoryAchievements.perfectMedium && memoryAchievements.perfectHard && !memoryAchievements.master) {
        memoryAchievements.master = true;
        achievementUnlocked = 'üëë Achievement: MEMORY MASTER!';
      }
      
      localStorage.setItem('memoryAchievements', JSON.stringify(memoryAchievements));
      
      let resultMessage = '';
      if (isNewBest) {
        resultMessage = `üèÜ NEW BEST TIME! ${totalTime}s!<br>Moves: ${memoryMoves}`;
        createMassiveConfetti();
      } else if (memoryMoves <= perfectMoves + 2) {
        resultMessage = `üèÜ PERFECT! Moves: ${memoryMoves}, Time: ${totalTime}s!<br>Best: ${memoryBestTimes[memoryDifficulty]}s üåü`;
        createMassiveConfetti();
      } else if (memoryMoves <= perfectMoves + 5) {
        resultMessage = `‚≠ê Great! Moves: ${memoryMoves}, Time: ${totalTime}s!<br>Best: ${memoryBestTimes[memoryDifficulty]}s üéâ`;
        createConfetti();
      } else {
        resultMessage = `üëç Good! Moves: ${memoryMoves}, Time: ${totalTime}s!<br>Best: ${memoryBestTimes[memoryDifficulty]}s üí™`;
      }
      
      if (achievementUnlocked) {
        resultMessage += `<br><br>${achievementUnlocked}`;
        createConfetti();
      }
      
      if (memoryMessage) memoryMessage.innerHTML = resultMessage;
      if (memoryResetBtn) memoryResetBtn.style.display = 'inline-block';
      if (diffSelector) diffSelector.style.display = 'flex';
      
      showNotification(resultMessage.replace(/<br>/g, ' ').replace(/<[^>]*>/g, ''));
    }

    function resetMemoryGame() {
      const memoryBoard = document.getElementById('memoryBoard');
      const memoryStartBtn = document.getElementById('memoryStartBtn');
      const memoryResetBtn = document.getElementById('memoryResetBtn');
      const memoryMessage = document.getElementById('memoryMessage');
      
      if (memoryResetBtn) memoryResetBtn.style.display = 'none';
      if (memoryStartBtn) memoryStartBtn.style.display = 'inline-block';
      if (memoryMessage) memoryMessage.innerHTML = 'Select difficulty and click Start!';
      if (memoryBoard) memoryBoard.innerHTML = '';
    }

    // ============ LOVE QUIZ GAME ============
    const quizAllQuestions = [
      {
        question: "Apa yang paling aku suka dari kamu?",
        options: ["Senyumanmu yang selalu indah üòä", "Kelucuanmu yang menggemaskan ü•∞", "Cara kamu dengerin aku serius üíô", "Perhatianmu yang selalu detail üí´", "Literally semua yang di atas wkwk üíï"],
        correct: 4
      },
      {
        question: "Kapan aku paling senang?",
        options: ["Pas kita ngobrol sampai lupa waktu üí¨", "Pas liat kamu ketawa lepas üòÑ", "Pas kita bareng & ngelakuin hal random üéâ", "Pas kamu cerita tentang harimu ü•∞", "Semua momen itu lah, males milih üòÇüíï"],
        correct: 4
      },
      {
        question: "Apa yang paling bikin aku suka sama kamu?",
        options: ["Cara kamu ngomong yang ekspresif üòÑ", "Tingkah random kamu yang menghibur ü§™", "Energi positif yang kamu punya üåü", "Ya kamu lucu aja sih üòÇüíï"],
        correct: 3
      },
      {
        question: "Hal favorit yang kita lakuin bareng?",
        options: ["Ngobrol sambil makan bareng üçú", "Ngobrol sampai larut malam üåô", "Becanda & ketawa garing bareng üòÑ", "Ya semuanya dong, paket komplit üíØüòé"],
        correct: 3
      },
      {
        question: "Harapan aku buat kita ke depannya?",
        options: ["Makin kenal satu sama lain üíô", "Bisa traveling bareng kemana-mana ‚úàÔ∏è", "Bisa lewatin semua naik turun bareng ü§ù", "Build future bareng step by step üí´"],
        correct: 3
      },
      {
        question: "Apa yang bikin kamu special di mataku?",
        options: ["Cara kamu treat orang sekitar ü§ó", "Kamu genuine & nggak pernah fake üíØ", "Cara kamu ngerti tanpa aku jelasin üí´", "Ambisi & passion kamu ke goals üéØ"],
        correct: 1
      },
      {
        question: "Kapan aku pertama kali sadar aku suka kamu?",
        options: ["Pas kamu do something sweet tanpa disuruh üòç", "Pas kita ngobrol dalam tentang life üí¨", "Pas aku ngerasa paling nyaman sama kamu üíó", "Pas kamu nunjukin support ke aku ü•∞", "Dari dulu kali, cuma baru sadar aja ü§°üíï"],
        correct: 4
      },
      {
        question: "Apa yang paling aku appreciate dari kamu?",
        options: ["Kamu selalu honest sama aku üíô", "Kamu supportive di semua hal ü§ù", "Cara kamu effort buat aku üåü", "Kamu ngerti boundaries & respect aku üíö"],
        correct: 1
      },
      {
        question: "Kenapa aku pilih kamu?",
        options: ["Vibe kita yang instantly click üèÜ", "Kamu bikin aku jadi versi terbaik üíñ", "Chemistry kita yang undeniable üòä", "Kamu get my weird side üíô"],
        correct: 1
      },
      {
        question: "Apa mimpi aku buat kita berdua?",
        options: ["Grow bareng jadi orang sukses üíï", "Grow together sambil tetep fun üå±", "Build something meaningful bareng üíº", "Travel the world bareng someday ‚úàÔ∏è"],
        correct: 1
      }
    ];

    let quizQuestions = [];
    let quizCurrentQuestion = 0;
    let quizScore = 0;
    let quizAnswered = false;
    let quizHighScores = JSON.parse(localStorage.getItem('quizHighScores')) || [];
    let quizStreak = 0;

    const quizContainer = document.getElementById('quizContainer');
    const quizProgress = document.getElementById('quizProgress');
    const quizCurrent = document.getElementById('quizCurrent');
    const quizTotal = document.getElementById('quizTotal');
    const quizQuestion = document.getElementById('quizQuestion');
    const quizOptions = document.getElementById('quizOptions');
    const quizResult = document.getElementById('quizResult');
    const quizResultTitle = document.getElementById('quizResultTitle');
    const quizResultMessage = document.getElementById('quizResultMessage');
    const quizScoreDisplay = document.getElementById('quizScoreDisplay');

    function startQuiz() {
      if (!quizQuestion || !quizOptions) return;
      
      // Select random 5 questions from all questions
      quizQuestions = [...quizAllQuestions]
        .sort(() => Math.random() - 0.5)
        .slice(0, 5);
      
      quizCurrentQuestion = 0;
      quizScore = 0;
      quizAnswered = false;
      quizStreak = 0;
      
      if (quizTotal) quizTotal.textContent = quizQuestions.length;
      showQuizQuestion();
    }

    function showQuizQuestion() {
      if (!quizQuestion || !quizOptions) return;
      
      if (quizCurrentQuestion >= quizQuestions.length) {
        showQuizResult();
        return;
      }
      
      if (quizResult) quizResult.style.display = 'none';
      const q = quizQuestions[quizCurrentQuestion];
      
      if (quizCurrent) quizCurrent.textContent = quizCurrentQuestion + 1;
      quizQuestion.textContent = q.question;
      
      quizOptions.innerHTML = '';
      q.options.forEach((option, index) => {
        const optionEl = document.createElement('div');
        optionEl.className = 'quiz-option';
        optionEl.textContent = option;
        optionEl.addEventListener('click', () => selectQuizAnswer(index));
        quizOptions.appendChild(optionEl);
      });
      
      quizAnswered = false;
    }

    function selectQuizAnswer(selectedIndex) {
      if (quizAnswered) return;
      
      quizAnswered = true;
      const q = quizQuestions[quizCurrentQuestion];
      const options = quizOptions.querySelectorAll('.quiz-option');
      
      options.forEach((opt, idx) => {
        opt.classList.add('disabled');
        if (idx === q.correct) {
          opt.classList.add('correct');
        }
        if (idx === selectedIndex && idx !== q.correct) {
          opt.classList.add('wrong');
        }
      });
      
      if (selectedIndex === q.correct) {
        quizScore++;
        quizStreak++;
        let message = '‚úÖ Benar! Kamu kenal aku banget! üíï';
        if (quizStreak >= 3) {
          message = `üî• ${quizStreak}x STREAK! Amazing! ‚ú®`;
        }
        showNotification(message);
      } else {
        quizStreak = 0;
        showNotification('‚ùå Hmm, belum tepat. Belajar lagi ya! üòä');
      }
      
      setTimeout(() => {
        quizCurrentQuestion++;
        showQuizQuestion();
      }, 2000);
    }

    function showQuizResult() {
      if (!quizQuestion || !quizOptions || !quizResult) return;
      
      quizQuestion.style.display = 'none';
      quizOptions.style.display = 'none';
      if (quizProgress) quizProgress.style.display = 'none';
      quizResult.style.display = 'block';
      
      // Save high score
      const percentage = Math.round((quizScore / quizQuestions.length) * 100);
      quizHighScores.push({ score: quizScore, total: quizQuestions.length, percentage, date: new Date().toLocaleDateString() });
      quizHighScores.sort((a, b) => b.percentage - a.percentage);
      quizHighScores = quizHighScores.slice(0, 5); // Keep top 5
      localStorage.setItem('quizHighScores', JSON.stringify(quizHighScores));
      
      if (quizScoreDisplay) quizScoreDisplay.textContent = `${quizScore}/${quizQuestions.length} (${percentage}%)`;
      
      let rank = '';
      if (percentage === 100) {
        if (quizResultTitle) quizResultTitle.textContent = 'üèÜ PERFECT SCORE!';
        if (quizResultMessage) quizResultMessage.innerHTML = `Kamu kenal aku banget! Kita emang soulmate! üíï‚ú®<br><small>Top Score: ${quizHighScores[0].percentage}%</small>`;
        createMassiveConfetti();
        rank = 'Soulmate üíï';
      } else if (quizScore >= 4) {
        if (quizResultTitle) quizResultTitle.textContent = '‚≠ê Hebat!';
        if (quizResultMessage) quizResultMessage.innerHTML = `Kamu udah kenal aku dengan baik! Makin sayang deh! üíñ<br><small>Top Score: ${quizHighScores[0].percentage}%</small>`;
        createConfetti();
        rank = 'Sweet Heart ‚ù§Ô∏è';
      } else if (quizScore >= 3) {
        if (quizResultTitle) quizResultTitle.textContent = 'üëç Lumayan!';
        if (quizResultMessage) quizResultMessage.innerHTML = `Kita masih belajar kenal satu sama lain ya! üòä<br><small>Top Score: ${quizHighScores[0].percentage}%</small>`;
        rank = 'Getting There üí´';
      } else {
        if (quizResultTitle) quizResultTitle.textContent = 'üí™ Keep Learning!';
        if (quizResultMessage) quizResultMessage.innerHTML = `Gapapa, kita masih punya banyak waktu buat kenal lebih dalam! üíï<br><small>Top Score: ${quizHighScores[0].percentage}%</small>`;
        rank = 'Newbie üå±';
      }
      
      showNotification(`Quiz selesai! Rank: ${rank} üéâ`);
    }

    function resetQuiz() {
      if (!quizQuestion || !quizOptions || !quizResult) return;
      
      quizQuestion.style.display = 'flex';
      quizOptions.style.display = 'grid';
      if (quizProgress) quizProgress.style.display = 'block';
      quizResult.style.display = 'none';
      startQuiz();
    }

    // ============ TRUTH OR DARE GAME ============
    const truthQuestions = [
      "Apa hal paling romantis yang pernah kamu bayangkan kita lakukan bareng?",
      "Kapan pertama kali kamu sadar kamu suka sama aku?",
      "Apa yang paling kamu suka dari relationship kita?",
      "Cerita satu hal tentang aku yang bikin kamu jatuh cinta",
      "Apa yang kamu harapkan untuk kita 5 tahun ke depan?",
      "Hal apa yang paling bikin kamu kangen sama aku?",
      "Apa momen paling berkesan kita berdua?",
      "Cerita tentang mimpi yang melibatkan aku",
      "Apa yang pertama kali kamu notice dari aku?",
      "Kalau bisa ngulang satu momen bareng aku, momen apa?",
      "Apa lagu yang mengingatkan kamu sama aku?",
      "Hal apa yang pengen kamu bilang ke aku tapi belum?",
      "Apa nickname favorit kamu buat aku?",
      "Kapan kamu merasa paling dekat sama aku?",
      "Apa yang bikin kamu yakin aku orangnya?",
      "Cerita satu secret yang cuma kamu dan aku yang tau",
      "Apa date impian kamu sama aku?",
      "Hal apa tentang aku yang bikin kamu tersenyum?",
      "Apa yang paling kamu appreciate dari aku?",
      "Kalau bisa, kamu mau ngubah apa dari relationship kita?",
      "Cerita momen ketika kamu proud sama aku",
      "Apa kebiasaan aku yang paling kamu suka?",
      "Kapan terakhir kali kamu ngerasa super happy karena aku?",
      "Apa hal termanis yang pernah aku lakukan menurutmu?",
      "Cerita satu sifat aku yang bikin kamu kagum",
      "Apa yang kamu suka dari cara aku ngomong?",
      "Kapan kamu ngerasa paling nyaman sama aku?",
      "Apa gift terbaik yang pernah kamu dapet dari aku?",
      "Cerita tentang hal kecil yang aku lakukan yang kamu remember",
      "Apa yang bikin kamu yakin kita cocok?",
      "Kalau ada 3 wish buat relationship kita, apa aja?",
      "Apa yang paling kamu suka dari personality aku?",
      "Cerita momen kita yang bikin kamu ketawa paling keras",
      "Apa yang kamu pelajari dari relationship sama aku?",
      "Hal apa yang pengen kamu lakuin bareng aku?",
      "Apa quotes atau kata-kata yang menggambarkan perasaanmu ke aku?",
      "Cerita satu hal random tentang aku yang kamu inget",
      "Apa yang bikin aku beda dari orang lain di hidupmu?",
      "Kapan kamu ngerasa 'this is it, this is my person'?",
      "Apa arti aku dalam hidupmu sekarang?"
    ];

    const dareChallenges = [
      "Kirim voice note bilang 'I love you' dengan 3 bahasa berbeda!",
      "Screenshot chat favorit kita dan explain kenapa!",
      "Bikin playlist 5 lagu yang menggambarkan perasaan kamu",
      "Tulis puisi pendek (4 baris) tentang kita",
      "Kirim foto kamu lagi senyum sekarang!",
      "Cerita joke paling garing kamu ke aku",
      "Dance challenge! Record dan kirim ke aku",
      "Gambar potret aku (stick figure juga boleh) dan kirim!",
      "Nyanyi lagu romantis 30 detik dan record",
      "Bikin video bilang 3 hal yang kamu suka dari aku",
      "Share satu hal embarrassing yang pernah kamu alami",
      "Pose romantic dan kirim fotonya!",
      "Buat caption Instagram tentang kita (sweet caption!)",
      "Tirukan suara aku sebaik mungkin dan record",
      "Kirim selfie dengan ekspresi paling romantic",
      "Text 'Good morning sayang' dalam 5 bahasa",
      "Bikin daftar 10 alasan kenapa kamu sayang sama aku",
      "Record kamu bilang 'Kamu yang terbaik!' 5x",
      "Kirim meme couple yang relate sama kita",
      "Compliment aku dengan cara paling kreatif!",
      "Bikin TikTok/Reels couple challenge dan tag aku",
      "Tulis surat cinta singkat dengan tulisan tangan",
      "Kirim foto makanan favorit kamu dan bilang 'tapi kamu lebih sweet'",
      "Record kamu nyanyi lagu favorit kita",
      "Bikin video editan foto kita berdua (simple aja)",
      "Kirim 10 emoji yang menggambarkan perasaanmu ke aku",
      "Screenshot lockscreen HP kamu dan kirim",
      "Bikin status romantis tentang aku di sosmed",
      "Record kamu bilang compliment dalam bahasa Inggris",
      "Kirim foto childhood kamu dan ceritain kenangan lucu",
      "Bikin acrostic poem dari namaku",
      "Voice note kamu cerita kenapa kamu sayang aku (1 menit)",
      "Kirim playlist workout/study kamu buat aku",
      "Screenshot profile sosmed kamu yang ada fotonya aku",
      "Bikin video 'a day in my life missing you'",
      "Kirim quote romantis favorit kamu",
      "Record kamu nge-rap tentang kita (freestyle!)",
      "Bikin collage dari 9 foto kenangan kita",
      "Kirim voice note kamu ketawa selama 10 detik (genuine!)",
      "Text 'Aku cinta kamu' dengan emoji yang creative"
    ];

    let todCompleted = 0;
    let todSkipped = 0;

    function selectTruthOrDare(type) {
      const choiceScreen = document.getElementById('todChoiceScreen');
      const resultScreen = document.getElementById('todResultScreen');
      const typeBadge = document.getElementById('todTypeBadge');
      const challenge = document.getElementById('todChallenge');
      
      choiceScreen.style.display = 'none';
      resultScreen.style.display = 'block';
      
      let selectedChallenge;
      if (type === 'truth') {
        selectedChallenge = truthQuestions[Math.floor(Math.random() * truthQuestions.length)];
        typeBadge.textContent = 'üí¨ TRUTH';
        typeBadge.className = 'tod-type-badge truth';
      } else {
        selectedChallenge = dareChallenges[Math.floor(Math.random() * dareChallenges.length)];
        typeBadge.textContent = '‚ö° DARE';
        typeBadge.className = 'tod-type-badge dare';
      }
      
      challenge.textContent = selectedChallenge;
    }

    function completeTod() {
      todCompleted++;
      document.getElementById('todCompleted').textContent = todCompleted;
      showNotification('üéâ Great job! Challenge completed!');
      createConfetti();
      backToTodChoice();
    }

    function skipTod() {
      todSkipped++;
      document.getElementById('todSkipped').textContent = todSkipped;
      showNotification('‚è≠Ô∏è Skipped! Try the next one!');
      backToTodChoice();
    }

    function backToTodChoice() {
      document.getElementById('todChoiceScreen').style.display = 'block';
      document.getElementById('todResultScreen').style.display = 'none';
    }

    // ============ SPIN THE WHEEL GAME ============
    const wheelOptions = [
      { text: "Kirim voice note manis üíå", color: "#FF6B9D" },
      { text: "Share playlist lagu üéµ", color: "#9B7DFF" },
      { text: "Video call 5 menit üì±", color: "#FF6B9D" },
      { text: "Kirim 3 foto tersenyum üòä", color: "#9B7DFF" },
      { text: "Cerita momen favorit üí≠", color: "#FF6B9D" },
      { text: "Compliment challenge üíñ", color: "#9B7DFF" },
      { text: "Dance video 30 detik üíÉ", color: "#FF6B9D" },
      { text: "Nyanyi lagu romantis üé§", color: "#9B7DFF" },
      { text: "Bikin poem 4 baris ‚úçÔ∏è", color: "#FF6B9D" },
      { text: "Screenshot chat sweet üí¨", color: "#9B7DFF" },
      { text: "Gambar portrait aku üé®", color: "#FF6B9D" },
      { text: "List 10 hal manis üìù", color: "#9B7DFF" },
      { text: "Kirim childhood photo üë∂", color: "#FF6B9D" },
      { text: "Voice note 1 menit ‚ù§Ô∏è", color: "#9B7DFF" },
      { text: "Selfie dengan pose lucu ü§™", color: "#FF6B9D" },
      { text: "Share meme couple üòÇ", color: "#9B7DFF" },
      { text: "Bikin status romantis üíï", color: "#FF6B9D" },
      { text: "Record joke garing ü•¥", color: "#9B7DFF" },
      { text: "Kirim lockscreen kamu üì±", color: "#FF6B9D" },
      { text: "3 alasan sayang aku üíó", color: "#9B7DFF" },
      { text: "Tiru suara aku üó£Ô∏è", color: "#FF6B9D" },
      { text: "Quote romantis favorit üìñ", color: "#9B7DFF" },
      { text: "Video mukbang bareng üçú", color: "#FF6B9D" },
      { text: "Kirim good morning 5 bahasa üåç", color: "#9B7DFF" }
    ];

    let wheelSpinCount = {};
    let wheelSpinning = false;
    let wheelCanvas, wheelCtx;
    let wheelAngle = 0;

    function initWheel() {
      wheelCanvas = document.getElementById('wheelCanvas');
      if (!wheelCanvas) return;
      
      wheelCtx = wheelCanvas.getContext('2d');
      wheelOptions.forEach(opt => {
        if (!wheelSpinCount[opt.text]) wheelSpinCount[opt.text] = 0;
      });
      
      drawWheel();
      updateWheelStats();
    }

    function drawWheel() {
      if (!wheelCtx || !wheelCanvas) return;
      
      const centerX = wheelCanvas.width / 2;
      const centerY = wheelCanvas.height / 2;
      const radius = 180;
      const sliceAngle = (2 * Math.PI) / wheelOptions.length;
      
      wheelCtx.clearRect(0, 0, wheelCanvas.width, wheelCanvas.height);
      
      wheelOptions.forEach((option, i) => {
        const startAngle = wheelAngle + i * sliceAngle;
        const endAngle = startAngle + sliceAngle;
        
        // Draw slice
        wheelCtx.beginPath();
        wheelCtx.arc(centerX, centerY, radius, startAngle, endAngle);
        wheelCtx.lineTo(centerX, centerY);
        wheelCtx.fillStyle = option.color;
        wheelCtx.fill();
        wheelCtx.strokeStyle = '#fff';
        wheelCtx.lineWidth = 2;
        wheelCtx.stroke();
        
        // Draw text
        wheelCtx.save();
        wheelCtx.translate(centerX, centerY);
        wheelCtx.rotate(startAngle + sliceAngle / 2);
        wheelCtx.textAlign = 'center';
        wheelCtx.fillStyle = '#fff';
        wheelCtx.font = 'bold 12px Arial';
        wheelCtx.fillText(option.text, radius / 1.5, 0);
        wheelCtx.restore();
      });
      
      // Draw pointer
      wheelCtx.beginPath();
      wheelCtx.moveTo(centerX, 20);
      wheelCtx.lineTo(centerX - 15, 0);
      wheelCtx.lineTo(centerX + 15, 0);
      wheelCtx.closePath();
      wheelCtx.fillStyle = '#FFD93D';
      wheelCtx.fill();
      wheelCtx.strokeStyle = '#333';
      wheelCtx.lineWidth = 2;
      wheelCtx.stroke();
    }

    function spinWheel() {
      if (wheelSpinning) return;
      
      wheelSpinning = true;
      document.getElementById('wheelSpinBtn').disabled = true;
      document.getElementById('wheelResult').textContent = 'Spinning... üé°';
      
      const spinDuration = 3000;
      const spinRotations = 5 + Math.random() * 3;
      const finalAngle = spinRotations * 2 * Math.PI + Math.random() * 2 * Math.PI;
      const startTime = Date.now();
      
      function animate() {
        const elapsed = Date.now() - startTime;
        const progress = Math.min(elapsed / spinDuration, 1);
        const easeOut = 1 - Math.pow(1 - progress, 3);
        
        wheelAngle = finalAngle * easeOut;
        drawWheel();
        
        if (progress < 1) {
          requestAnimationFrame(animate);
        } else {
          wheelSpinning = false;
          document.getElementById('wheelSpinBtn').disabled = false;
          determineWinner();
        }
      }
      
      animate();
    }

    function determineWinner() {
      const normalizedAngle = (2 * Math.PI - (wheelAngle % (2 * Math.PI))) % (2 * Math.PI);
      const sliceAngle = (2 * Math.PI) / wheelOptions.length;
      const winningIndex = Math.floor(normalizedAngle / sliceAngle);
      const winner = wheelOptions[winningIndex];
      
      wheelSpinCount[winner.text]++;
      
      document.getElementById('wheelResult').innerHTML = `
        <div style="font-size: 28px; margin-bottom: 10px;">üéâ</div>
        <div>${winner.text}</div>
      `;
      
      updateWheelStats();
      showNotification(`üé° ${winner.text}`);
      createConfetti();
    }

    function updateWheelStats() {
      const statsDisplay = document.getElementById('wheelStatsDisplay');
      if (!statsDisplay) return;
      
      statsDisplay.innerHTML = '';
      
      // Filter: cuma tampilkan yang udah pernah didapet (count > 0)
      const unlockedChallenges = wheelOptions.filter(opt => wheelSpinCount[opt.text] > 0);
      
      if (unlockedChallenges.length === 0) {
        statsDisplay.innerHTML = '<div style="text-align: center; opacity: 0.6; padding: 20px;">Spin the wheel to unlock challenges! üé°</div>';
        return;
      }
      
      unlockedChallenges.forEach(opt => {
        const div = document.createElement('div');
        div.className = 'wheel-stat-item';
        div.innerHTML = `<div style="font-size: 12px; opacity: 0.8;">${opt.text}</div><div style="font-size: 18px; font-weight: bold;">${wheelSpinCount[opt.text]}x</div>`;
        statsDisplay.appendChild(div);
      });
      
      // Tambah info berapa yang udah didapet
      const totalUnlocked = unlockedChallenges.length;
      const totalChallenges = wheelOptions.length;
      const infoDiv = document.createElement('div');
      infoDiv.style.cssText = 'text-align: center; margin-top: 15px; opacity: 0.7; font-size: 13px;';
      infoDiv.textContent = `üèÜ Unlocked: ${totalUnlocked}/${totalChallenges} challenges`;
      statsDisplay.appendChild(infoDiv);
    }

    function resetWheelStats() {
      wheelOptions.forEach(opt => {
        wheelSpinCount[opt.text] = 0;
      });
      updateWheelStats();
      document.getElementById('wheelResult').textContent = 'Stats reset! Spin the wheel! üé°';
      showNotification('üìä Statistics reset!');
    }

    // Auto-init wheel when section opens
    document.addEventListener('DOMContentLoaded', () => {
      setTimeout(() => {
        if (document.getElementById('wheelCanvas')) {
          initWheel();
        }
      }, 500);
    });

    // ============ INITIALIZATION ============
    createParticles();
    createStars();
    createBgHearts();

    // Enable audio after first user interaction (untuk bypass autoplay restriction)
    const enableAudioOnInteraction = () => {
      initAudio();
      // Remove listener after first interaction
      document.removeEventListener('click', enableAudioOnInteraction);
      document.removeEventListener('touchstart', enableAudioOnInteraction);
    };
    document.addEventListener('click', enableAudioOnInteraction);
    document.addEventListener('touchstart', enableAudioOnInteraction);

    console.log('%c‚ú® OUR JOURNEY TOGETHER! ‚ú®', 'color: #ff6b6b; font-size: 20px; font-weight: bold;');
    console.log('%cEaster eggs:', 'color: #7aa2ff; font-size: 14px;');
    console.log('1. üñ±Ô∏è Klik judul 5x');
    console.log('2. üñ±Ô∏è Klik sesuai hari bersama untuk surprise!');
    console.log('3. üñ±Ô∏è Klik 50x untuk cursor trail');
    console.log('4. üñ±Ô∏è Klik 100x untuk rainbow mode (klik 100x lagi untuk off)');
    console.log('5. ‚å®Ô∏è Konami code: ‚Üë‚Üë‚Üì‚Üì‚Üê‚Üí‚Üê‚ÜíBA');
    console.log('6. üì± Double tap anywhere');
    console.log('7. üìä Click stats untuk surprise');
    console.log('8. üñºÔ∏è Click gallery items');
    console.log('9. üñ±Ô∏è Triple click anywhere');
    console.log('10. üì≥ Shake device (mobile)');
    console.log('11. ‚å®Ô∏è Type: iloveyou, sayang, journey, forever, kiss, hug');
    console.log('12. üñ±Ô∏è Long press on title (2 detik)');
    console.log('13. üìú Scroll banyak-banyak');
    console.log('14. üéØ Click stats urut: Days ‚Üí Memories ‚Üí Love');
    console.log('15. üñ±Ô∏è Hover subtitle 3x');
    console.log('16. üñ±Ô∏è Double click tanggal');
    console.log('17. ‚ö° Klik 10x dalam 1 detik');
    console.log('18. üïõ Auto-greeting based on time');
    console.log('19. üåü Random surprise tiap 5 menit');
    console.log('20. üíå Surat Terakhir dengan password di menu Penutup');
    console.log('%c‚å®Ô∏è SHORTCUT: Tekan ESC untuk toggle Rainbow Mode ON/OFF', 'color: #ffd93d; font-weight: bold;');
    console.log('%cüíå SPECIAL: Cari Surat Terakhir di menu Penutup - butuh kata kunci!', 'color: #ff6b9d; font-weight: bold;');
    console.log('%cDibuat dengan ‚ù§Ô∏è untuk perjalanan kita bersama', 'color: #9b7dff; font-style: italic;');


  </script>

<!-- ========================================== -->
<!-- üî• FIREBASE INTEGRATION -->
<!-- ========================================== -->

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-check-compat.js"></script>

<script>
  // ============================================
  // 1Ô∏è‚É£ FIREBASE CONFIGURATION
  // ============================================
  const firebaseConfig = {
    apiKey: "AIzaSyCyE_KyxgSn_oreFzkpvg9Gnfbv6FCZ2rM",
    authDomain: "project-8718719987786325599.firebaseapp.com",
    databaseURL: "https://project-8718719987786325599-default-rtdb.firebaseio.com",
    projectId: "project-8718719987786325599",
    storageBucket: "project-8718719987786325599.firebasestorage.app",
    messagingSenderId: "584913364315",
    appId: "1:584913364315:web:d9986ef8f6df183ea6267e"
  };

  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  
  // ============================================
  // üõ°Ô∏è FIREBASE APP CHECK (SECURITY)
  // ============================================
  const appCheck = firebase.appCheck();
  appCheck.activate(
    '6LcEtGUsAAAAAHyQLdvtKrYCO4zaKwsre_s7awzF', // reCAPTCHA site key
    true // Pass true to enable automatic refresh
  );
  
  const database = firebase.database();
  
  console.log('üî• Firebase connected successfully!');
  console.log('üõ°Ô∏è App Check enabled!');

  // ============================================
  // 2Ô∏è‚É£ MEMORY BOX FUNCTIONS
  // ============================================
  
  // Simpan memory baru
  async function addMemory() {
    const input = document.getElementById('newMemory');
    const text = input.value.trim();
    
    if (!text) {
      showNotification('‚ö†Ô∏è Memory tidak boleh kosong!');
      return;
    }
    
    try {
      const newMemoryRef = database.ref('memories').push();
      await newMemoryRef.set({
        text: text,
        timestamp: Date.now(),
        date: new Date().toLocaleDateString('id-ID'),
        dateTime: new Date().toISOString()
      });
      
      input.value = '';
      loadMemories();
      showNotification('‚ú® Memory tersimpan!');
      createConfetti();
    } catch (error) {
      console.error('Error adding memory:', error);
      showNotification('‚ùå Gagal menyimpan memory!');
    }
  }

  // Load semua memories
  function loadMemories() {
    const list = document.getElementById('memoryList');
    if (!list) return;
    
    database.ref('memories').orderByChild('timestamp').once('value', (snapshot) => {
      list.innerHTML = '';
      
      if (!snapshot.exists()) {
        list.innerHTML = '<div style="text-align: center; opacity: 0.6; padding: 20px;">Belum ada memory. Yuk tambahkan! üí≠</div>';
        return;
      }
      
      const memories = [];
      snapshot.forEach((childSnapshot) => {
        memories.push({
          id: childSnapshot.key,
          ...childSnapshot.val()
        });
      });
      
      // Sort descending (newest first)
      memories.reverse();
      
      memories.forEach(data => {
        const item = document.createElement('div');
        item.className = 'memory-item';
        item.style.cssText = 'background: rgba(16, 16, 28, 0.6); padding: 15px; border-radius: 12px; margin-bottom: 10px; display: flex; gap: 10px; align-items: center; border: 1px solid rgba(122, 162, 255, 0.1); transition: all 0.3s ease;';
        item.innerHTML = `
          <div style="flex: 1;">
            <div style="font-size: 14px; margin-bottom: 5px; line-height: 1.5;">${data.text}</div>
            <div style="font-size: 11px; opacity: 0.6;">${data.date}</div>
          </div>
          <button onclick="deleteMemory('${data.id}')" style="background: transparent; border: none; cursor: pointer; font-size: 18px; opacity: 0.6; transition: opacity 0.3s; padding: 5px;">üóëÔ∏è</button>
        `;
        list.appendChild(item);
      });
      
      // Update counter jika ada
      const counterEl = document.getElementById('totalMemories');
      if (counterEl) counterEl.textContent = memories.length;
    });
  }

  // Hapus memory
  async function deleteMemory(id) {
    if (!confirm('Hapus memory ini?')) return;
    
    try {
      await database.ref('memories/' + id).remove();
      loadMemories();
      showNotification('üóëÔ∏è Memory dihapus!');
    } catch (error) {
      console.error('Error deleting memory:', error);
    }
  }

  // ============================================
  // 3Ô∏è‚É£ LOVE LETTER FUNCTIONS
  // ============================================
  
  // Simpan love letter
  async function saveLetter() {
    const letterText = document.getElementById('generatedLetter');
    if (!letterText) return;
    
    const text = letterText.textContent || letterText.innerText;
    
    if (!text || text === 'Klik tombol untuk generate surat! üíå') {
      showNotification('‚ö†Ô∏è Generate surat dulu!');
      return;
    }
    
    try {
      const newLetterRef = database.ref('loveletters').push();
      await newLetterRef.set({
        text: text,
        timestamp: Date.now(),
        date: new Date().toLocaleDateString('id-ID'),
        dateTime: new Date().toISOString()
      });
      
      showNotification('üíæ Surat tersimpan!');
      createConfetti();
      loadSavedLetters();
    } catch (error) {
      console.error('Error saving letter:', error);
      showNotification('‚ùå Gagal menyimpan surat!');
    }
  }

  // Load saved letters
  function loadSavedLetters() {
    const list = document.getElementById('savedLettersList');
    if (!list) return;
    
    database.ref('loveletters').orderByChild('timestamp').limitToLast(10).once('value', (snapshot) => {
      list.innerHTML = '';
      
      if (!snapshot.exists()) {
        list.innerHTML = '<div style="text-align: center; opacity: 0.6; padding: 20px;">Belum ada surat tersimpan üíå</div>';
        return;
      }
      
      const letters = [];
      snapshot.forEach((childSnapshot) => {
        letters.push({
          id: childSnapshot.key,
          ...childSnapshot.val()
        });
      });
      
      // Sort descending
      letters.reverse();
      
      letters.forEach(data => {
        const item = document.createElement('div');
        item.style.cssText = 'background: rgba(16, 16, 28, 0.6); padding: 15px; border-radius: 12px; margin-bottom: 10px; display: flex; gap: 10px; align-items: center; border: 1px solid rgba(122, 162, 255, 0.1); cursor: pointer; transition: all 0.3s ease;';
        item.innerHTML = `
          <div style="flex: 1;" onclick="viewLetter('${data.id}')">
            <div style="font-size: 13px; opacity: 0.8; line-height: 1.5;">${data.text.substring(0, 100)}...</div>
            <div style="font-size: 11px; opacity: 0.5; margin-top: 5px;">${data.date}</div>
          </div>
          <button onclick="event.stopPropagation(); deleteLetter('${data.id}')" style="background: transparent; border: none; cursor: pointer; font-size: 16px; opacity: 0.6; padding: 5px;">üóëÔ∏è</button>
        `;
        list.appendChild(item);
      });
    });
  }

  // Hapus letter
  async function deleteLetter(id) {
    if (!confirm('Hapus surat ini?')) return;
    
    try {
      await database.ref('loveletters/' + id).remove();
      loadSavedLetters();
      showNotification('üóëÔ∏è Surat dihapus!');
    } catch (error) {
      console.error('Error deleting letter:', error);
    }
  }

  // View full letter
  function viewLetter(id) {
    database.ref('loveletters/' + id).once('value', (snapshot) => {
      if (snapshot.exists()) {
        const data = snapshot.val();
        
        // Buat popup untuk tampilkan full letter
        const popup = document.createElement('div');
        popup.style.cssText = 'position: fixed; inset: 0; background: rgba(0,0,0,0.9); display: flex; align-items: center; justify-content: center; z-index: 9999; padding: 20px;';
        popup.innerHTML = `
          <div style="background: linear-gradient(135deg, #1a1a28, #12121a); padding: 30px; border-radius: 20px; max-width: 600px; width: 100%; max-height: 80vh; overflow-y: auto; border: 2px solid rgba(122, 162, 255, 0.3);">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
              <h3 style="color: #7aa2ff; margin: 0;">üíå Love Letter</h3>
              <button onclick="this.parentElement.parentElement.parentElement.remove()" style="background: transparent; border: none; font-size: 24px; cursor: pointer; color: #fff; opacity: 0.6;">√ó</button>
            </div>
            <div style="font-size: 15px; line-height: 1.8; white-space: pre-wrap;">${data.text}</div>
            <div style="font-size: 12px; opacity: 0.5; margin-top: 20px; text-align: right;">${data.date}</div>
          </div>
        `;
        document.body.appendChild(popup);
        popup.onclick = (e) => {
          if (e.target === popup) popup.remove();
        };
      }
    });
  }

  // ============================================
  // 4Ô∏è‚É£ GAME SCORES FUNCTIONS
  // ============================================
  
  // Simpan game score
  async function saveGameScore(gameName, score, additionalData = {}) {
    try {
      const newScoreRef = database.ref('gamescores').push();
      await newScoreRef.set({
        game: gameName,
        score: score,
        timestamp: Date.now(),
        date: new Date().toLocaleDateString('id-ID'),
        dateTime: new Date().toISOString(),
        ...additionalData
      });
      
      console.log(`‚úÖ Score saved: ${gameName} - ${score}`);
    } catch (error) {
      console.error('Error saving score:', error);
    }
  }

  // Get high score untuk game tertentu
  function getHighScore(gameName, callback) {
    database.ref('gamescores')
      .orderByChild('game')
      .equalTo(gameName)
      .once('value', (snapshot) => {
        let highScore = 0;
        snapshot.forEach((childSnapshot) => {
          const data = childSnapshot.val();
          if (data.score > highScore) {
            highScore = data.score;
          }
        });
        callback(highScore);
      });
  }

  // Load leaderboard
  function loadLeaderboard(gameName, limit = 10, callback) {
    database.ref('gamescores')
      .orderByChild('game')
      .equalTo(gameName)
      .limitToLast(limit)
      .once('value', (snapshot) => {
        const leaderboard = [];
        snapshot.forEach((childSnapshot) => {
          leaderboard.push({
            id: childSnapshot.key,
            ...childSnapshot.val()
          });
        });
        
        // Sort by score descending
        leaderboard.sort((a, b) => b.score - a.score);
        callback(leaderboard);
      });
  }

  // ============================================
  // 5Ô∏è‚É£ CATATAN BERSAMA FUNCTIONS
  // ============================================
  
  // Global variables untuk pagination dan filter
  let allCatatanData = [];
  let displayedCatatanCount = 10; // Jumlah catatan yang ditampilkan per load
  const LOAD_MORE_INCREMENT = 10; // Jumlah tambahan saat load more

  // Folder-view state
  let currentCatatanView = 'folder'; // 'folder' | 'all'
  let activeFolderId = null;         // null = tampil grid folder, string = tampil isi folder
  let activeFolderName = '';
  let folderFilteredData = [];       // data catatan dalam folder yang sedang aktif
  let displayedFolderCount = 10;
  
  // Tambah catatan baru
  async function addCatatan() {
    const textarea = document.getElementById('catatanText');
    const folderSelect = document.getElementById('catatanFolder');
    const text = textarea.value.trim();
    const author = currentUser || localStorage.getItem('selectedUser'); // Auto dari user yang login
    const folderId = folderSelect.value;
    
    if (!author) {
      showNotification('‚ö†Ô∏è Silakan login terlebih dahulu!');
      return;
    }
    
    if (!text) {
      showNotification('‚ö†Ô∏è Tulis catatan dulu!');
      return;
    }
    
    if (text.length > 2000) {
      showNotification('‚ö†Ô∏è Catatan terlalu panjang! Maksimal 2000 karakter.');
      return;
    }
    
    try {
      const now = new Date();
      const newCatatanRef = database.ref('catatan').push();
      await newCatatanRef.set({
        text: text,
        author: author,
        folderId: folderId || null,
        timestamp: Date.now(),
        date: now.toLocaleDateString('id-ID'),
        dateTime: now.toISOString(),
        time: now.toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit' }),
        month: String(now.getMonth() + 1).padStart(2, '0'),
        year: String(now.getFullYear())
      });
      
      // Clear textarea
      textarea.value = '';
      
      // Reset character counter
      const charCount = document.getElementById('catatanCharCount');
      const charCounter = document.getElementById('catatanCharCounter');
      if (charCount) charCount.textContent = '0';
      if (charCounter) charCounter.classList.remove('warning', 'danger');
      
      showNotification('‚úÖ Catatan berhasil ditambahkan!');
      createConfetti();
    } catch (error) {
      console.error('Error adding catatan:', error);
      showNotification('‚ùå Gagal menambahkan catatan!');
    }
  }
  
  // Load catatan dengan real-time listener + pagination + filter
  function loadCatatan() {
    const list = document.getElementById('catatanList');
    if (!list) return;
    
    // Load folders first (for badge display)
    database.ref('folders').once('value', (folderSnapshot) => {
      const folders = {};
      if (folderSnapshot.exists()) {
        folderSnapshot.forEach((child) => {
          folders[child.key] = child.val();
        });
      }
      
      // Set up real-time listener for catatan
      database.ref('catatan').orderByChild('timestamp').on('value', (snapshot) => {
        allCatatanData = [];
        
        if (!snapshot.exists()) {
          list.innerHTML = `
            <div class="catatan-empty">
              <div class="catatan-empty-icon">üì≠</div>
              <p>Belum ada catatan. Yuk tulis catatan pertama!</p>
            </div>
          `;
          
          updateCatatanCounter(0);
          hideLoadMoreButton();
          return;
        }
        
        // Collect all data and attach folder name
        snapshot.forEach((childSnapshot) => {
          const data = childSnapshot.val();
          allCatatanData.push({
            id: childSnapshot.key,
            ...data,
            folderName: data.folderId && folders[data.folderId] ? folders[data.folderId].name : null
          });
        });
        
        // Sort descending (newest first)
        allCatatanData.reverse();
        
        // Populate year filter
        populateYearFilter();
        
        // Populate folder filter
        populateFolderFilter();
        
        // Render sesuai view aktif
        if (currentCatatanView === 'all') {
          applyFilters();
        } else {
          refreshCurrentView();
        }
      });
    });
  }
  
  // ============================================
  // üìÅ FOLDER VIEW FUNCTIONS
  // ============================================

  // Switch antara view Folder dan view Semua Catatan
  function switchCatatanView(view) {
    currentCatatanView = view;
    const folderArea = document.getElementById('folderViewArea');
    const allArea = document.getElementById('allCatatanArea');
    const btnFolder = document.getElementById('btnViewFolder');
    const btnAll = document.getElementById('btnViewAll');

    if (view === 'folder') {
      folderArea.style.display = 'block';
      allArea.style.display = 'none';
      btnFolder.classList.add('active');
      btnAll.classList.remove('active');
      // Reset ke grid folder saat switch ke view ini
      if (!activeFolderId) renderFolderGrid();
    } else {
      folderArea.style.display = 'none';
      allArea.style.display = 'block';
      btnFolder.classList.remove('active');
      btnAll.classList.add('active');
      applyFilters();
    }
  }

  // Render grid kartu folder
  function renderFolderGrid() {
    const grid = document.getElementById('folderViewGrid');
    const folderCatatanArea = document.getElementById('folderCatatanArea');
    const breadcrumb = document.getElementById('catatanBreadcrumb');
    if (!grid) return;

    // Sembunyikan catatan-dalam-folder, tampilkan grid
    folderCatatanArea.style.display = 'none';
    breadcrumb.style.display = 'none';
    grid.style.display = 'grid';
    activeFolderId = null;

    // Hitung catatan per folder
    const folderCountMap = {};
    let noneCount = 0;
    allCatatanData.forEach(c => {
      if (c.folderId) {
        folderCountMap[c.folderId] = (folderCountMap[c.folderId] || 0) + 1;
      } else {
        noneCount++;
      }
    });

    // Ambil data folder dari Firebase (sudah di-cache di allFoldersData)
    database.ref('folders').once('value', (snap) => {
      const folders = [];
      if (snap.exists()) {
        snap.forEach(child => {
          folders.push({ id: child.key, ...child.val() });
        });
        folders.sort((a, b) => a.name.localeCompare(b.name));
      }

      grid.innerHTML = '';

      // Render folder cards
      folders.forEach(folder => {
        const count = folderCountMap[folder.id] || 0;
        const card = document.createElement('div');
        card.className = 'folder-view-card';
        card.innerHTML = `
          <span class="folder-view-icon">üìÅ</span>
          <div class="folder-view-name">${escapeHtml(folder.name)}</div>
          <span class="folder-view-count">${count} catatan</span>
        `;
        card.onclick = () => openFolderView(folder.id, folder.name);
        grid.appendChild(card);
      });

      // Card "Tanpa Folder"
      if (noneCount > 0 || folders.length === 0) {
        const noneCard = document.createElement('div');
        noneCard.className = 'folder-view-card no-folder';
        noneCard.innerHTML = `
          <span class="folder-view-icon">üìÇ</span>
          <div class="folder-view-name">Random</div>
          <span class="folder-view-count">${noneCount} catatan</span>
        `;
        noneCard.onclick = () => openFolderView('__none__', 'Random');
        grid.appendChild(noneCard);
      }

      // Jika sama sekali tidak ada folder dan tidak ada catatan
      if (folders.length === 0 && noneCount === 0) {
        grid.innerHTML = `
          <div style="grid-column:1/-1; text-align:center; padding:50px 20px; opacity:0.5;">
            <div style="font-size:48px; margin-bottom:12px;">üì≠</div>
            <p>Belum ada catatan. Tulis catatan pertama!</p>
          </div>
        `;
      }
    });
  }

  // Buka isi catatan dalam satu folder
  function openFolderView(folderId, folderName) {
    activeFolderId = folderId;
    activeFolderName = folderName;
    displayedFolderCount = LOAD_MORE_INCREMENT;

    const grid = document.getElementById('folderViewGrid');
    const folderCatatanArea = document.getElementById('folderCatatanArea');
    const breadcrumb = document.getElementById('catatanBreadcrumb');
    const breadcrumbName = document.getElementById('breadcrumbFolderName');

    // Sembunyikan grid, tampilkan isi folder
    grid.style.display = 'none';
    folderCatatanArea.style.display = 'block';
    breadcrumb.style.display = 'flex';
    breadcrumbName.textContent = folderName;

    // Filter data sesuai folder
    if (folderId === '__none__') {
      folderFilteredData = allCatatanData.filter(c => !c.folderId);
    } else {
      folderFilteredData = allCatatanData.filter(c => c.folderId === folderId);
    }

    renderFolderCatatanList();
  }

  // Render catatan di dalam folder yang aktif
  function renderFolderCatatanList() {
    const list = document.getElementById('folderCatatanList');
    list.innerHTML = '';

    if (folderFilteredData.length === 0) {
      list.innerHTML = `
        <div class="catatan-empty">
          <div class="catatan-empty-icon">üì≠</div>
          <p>Folder ini masih kosong.</p>
        </div>
      `;
      document.getElementById('loadMoreContainerFolder').style.display = 'none';
      return;
    }

    const displayData = folderFilteredData.slice(0, displayedFolderCount);
    displayData.forEach(catatan => {
      const item = document.createElement('div');
      item.className = 'catatan-item';
      const authorIcon = catatan.author === 'BF' ? 'üë®' : 'üë©';
      item.innerHTML = `
        <div class="catatan-header">
          <div style="display:flex;align-items:center;flex-wrap:wrap;gap:8px;">
            <div class="catatan-author-badge">${authorIcon} ${escapeHtml(catatan.author || 'Anonymous')}</div>
          </div>
          <div style="display:flex;align-items:center;gap:10px;">
            <div class="catatan-timestamp">${catatan.date} ‚Ä¢ ${catatan.time}</div>
            <div class="catatan-menu">
              <button class="catatan-menu-btn" onclick="toggleCatatanMenu('${catatan.id}')">‚ãÆ</button>
              <div class="catatan-dropdown" id="menu-${catatan.id}">
                <div class="catatan-dropdown-item" onclick="copyCatatan('${catatan.id}')">üìã Copy</div>
                <div class="catatan-dropdown-item has-submenu" onclick="toggleSubmenu(event,'${catatan.id}')">
                  ‚úèÔ∏è Edit <span style="margin-left:auto;">‚ñ∂</span>
                  <div class="catatan-submenu" id="submenu-${catatan.id}">
                    <div class="catatan-submenu-item" onclick="editCatatanAuthor('${catatan.id}')">üë§ Edit Penulis</div>
                    <div class="catatan-submenu-item" onclick="editCatatanText('${catatan.id}')">üìù Edit Catatan</div>
                    <div class="catatan-submenu-item" onclick="editCatatanFolder('${catatan.id}')">üìÅ Edit Folder</div>
                  </div>
                </div>
                <div class="catatan-dropdown-item delete" onclick="deleteCatatan('${catatan.id}')">üóëÔ∏è Hapus</div>
              </div>
            </div>
          </div>
        </div>
        <div class="catatan-text">${escapeHtml(catatan.text)}</div>
      `;
      list.appendChild(item);
    });

    // Load more
    const lmContainer = document.getElementById('loadMoreContainerFolder');
    const lmInfo = document.getElementById('loadMoreInfoFolder');
    if (displayedFolderCount < folderFilteredData.length) {
      lmContainer.style.display = 'block';
      document.getElementById('loadMoreBtnFolder').disabled = false;
      lmInfo.textContent = `Menampilkan ${displayedFolderCount} dari ${folderFilteredData.length} catatan`;
    } else {
      lmContainer.style.display = 'none';
    }
  }

  // Load more catatan dalam folder
  function loadMoreFolderCatatan() {
    displayedFolderCount += LOAD_MORE_INCREMENT;
    renderFolderCatatanList();
  }

  // Kembali ke grid folder dari dalam folder
  function backToFolderView() {
    activeFolderId = null;
    activeFolderName = '';
    renderFolderGrid();
  }

  // Apply filters juga refresh folder grid jika sedang di view folder
  // (dipanggil saat data real-time update)
  function refreshCurrentView() {
    if (currentCatatanView === 'folder') {
      if (activeFolderId) {
        // Refresh isi folder yang sedang dibuka
        openFolderView(activeFolderId, activeFolderName);
      } else {
        renderFolderGrid();
      }
    }
    // View 'all' di-refresh via applyFilters() yang sudah dipanggil di loadCatatan
  }

  // Apply filters
  function applyFilters() {
    const monthFilter = document.getElementById('filterMonth').value;
    const yearFilter = document.getElementById('filterYear').value;
    const authorFilter = document.getElementById('filterAuthor').value;
    const folderFilter = document.getElementById('filterFolder').value;
    
    // Filter data
    let filteredData = allCatatanData.filter(catatan => {
      const matchMonth = !monthFilter || catatan.month === monthFilter;
      const matchYear = !yearFilter || catatan.year === yearFilter;
      const matchAuthor = !authorFilter || catatan.author === authorFilter;
      
      // Handle folder filter
      let matchFolder = true;
      if (folderFilter) {
        if (folderFilter === '__none__') {
          // Show only catatan without folder
          matchFolder = !catatan.folderId;
        } else {
          matchFolder = catatan.folderId === folderFilter;
        }
      }
      
      return matchMonth && matchYear && matchAuthor && matchFolder;
    });
    
    // Reset displayed count
    displayedCatatanCount = LOAD_MORE_INCREMENT;
    
    // Render filtered data
    renderCatatan(filteredData);
  }
  
  // Reset filters
  function resetFilters() {
    document.getElementById('filterMonth').value = '';
    document.getElementById('filterYear').value = '';
    document.getElementById('filterAuthor').value = '';
    document.getElementById('filterFolder').value = '';
    applyFilters();
  }
  
  // Render catatan dengan pagination
  function renderCatatan(data) {
    const list = document.getElementById('catatanList');
    list.innerHTML = '';
    
    if (data.length === 0) {
      list.innerHTML = `
        <div class="catatan-empty">
          <div class="catatan-empty-icon">üîç</div>
          <p>Tidak ada catatan yang sesuai filter.</p>
        </div>
      `;
      updateCatatanCounter(0);
      hideLoadMoreButton();
      return;
    }
    
    // Display only up to displayedCatatanCount
    const displayData = data.slice(0, displayedCatatanCount);
    
    displayData.forEach(catatan => {
      const item = document.createElement('div');
      item.className = 'catatan-item';
      
      // Tentukan icon berdasarkan author
      const authorIcon = catatan.author === 'BF' ? 'üë®' : 'üë©';
      
      // Folder badge (jika ada)
      const folderBadge = catatan.folderName 
        ? `<span class="catatan-folder-badge">üìÅ ${escapeHtml(catatan.folderName)}</span>`
        : '';
      
      item.innerHTML = `
        <div class="catatan-header">
          <div style="display: flex; align-items: center; flex-wrap: wrap; gap: 8px;">
            <div class="catatan-author-badge">
              ${authorIcon} ${escapeHtml(catatan.author || 'Anonymous')}
            </div>
            ${folderBadge}
          </div>
          <div style="display: flex; align-items: center; gap: 10px;">
            <div class="catatan-timestamp">${catatan.date} ‚Ä¢ ${catatan.time}</div>
            <div class="catatan-menu">
              <button class="catatan-menu-btn" onclick="toggleCatatanMenu('${catatan.id}')">‚ãÆ</button>
              <div class="catatan-dropdown" id="menu-${catatan.id}">
                <div class="catatan-dropdown-item" onclick="copyCatatan('${catatan.id}')">
                  üìã Copy
                </div>
                <div class="catatan-dropdown-item has-submenu" onclick="toggleSubmenu(event, '${catatan.id}')">
                  ‚úèÔ∏è Edit
                  <span style="margin-left: auto;">‚ñ∂</span>
                  <div class="catatan-submenu" id="submenu-${catatan.id}">
                    <div class="catatan-submenu-item" onclick="editCatatanAuthor('${catatan.id}')">
                      üë§ Edit Penulis
                    </div>
                    <div class="catatan-submenu-item" onclick="editCatatanText('${catatan.id}')">
                      üìù Edit Catatan
                    </div>
                    <div class="catatan-submenu-item" onclick="editCatatanFolder('${catatan.id}')">
                      üìÅ Edit Folder
                    </div>
                  </div>
                </div>
                <div class="catatan-dropdown-item delete" onclick="deleteCatatan('${catatan.id}')">
                  üóëÔ∏è Hapus
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="catatan-text">${escapeHtml(catatan.text)}</div>
      `;
      list.appendChild(item);
    });
    
    // Update counter
    updateCatatanCounter(data.length);
    
    // Show/hide load more button
    if (displayedCatatanCount < data.length) {
      showLoadMoreButton(displayedCatatanCount, data.length);
    } else {
      hideLoadMoreButton();
    }
  }
  
  // Load more catatan
  function loadMoreCatatan() {
    displayedCatatanCount += LOAD_MORE_INCREMENT;
    applyFilters();
  }
  
  // Show load more button
  function showLoadMoreButton(displayed, total) {
    const container = document.getElementById('loadMoreContainer');
    const btn = document.getElementById('loadMoreBtn');
    const info = document.getElementById('loadMoreInfo');
    
    container.style.display = 'block';
    btn.disabled = false;
    info.textContent = `Menampilkan ${displayed} dari ${total} catatan`;
  }
  
  // Hide load more button
  function hideLoadMoreButton() {
    const container = document.getElementById('loadMoreContainer');
    if (container) container.style.display = 'none';
  }
  
  // Update catatan counter
  function updateCatatanCounter(count) {
    const counterEl = document.getElementById('totalCatatan');
    if (counterEl) counterEl.textContent = count;
  }
  
  // Populate year filter dynamically
  function populateYearFilter() {
    const yearSelect = document.getElementById('filterYear');
    const currentYear = new Date().getFullYear();
    const years = new Set();
    
    // Collect unique years from data
    allCatatanData.forEach(catatan => {
      if (catatan.year) years.add(catatan.year);
    });
    
    // Add current year if not exists
    years.add(String(currentYear));
    
    // Sort years descending
    const sortedYears = Array.from(years).sort((a, b) => b - a);
    
    // Clear and populate
    yearSelect.innerHTML = '<option value="">Semua Tahun</option>';
    sortedYears.forEach(year => {
      const option = document.createElement('option');
      option.value = year;
      option.textContent = year;
      yearSelect.appendChild(option);
    });
  }
  
  // Populate folder filter dropdown
  function populateFolderFilter() {
    const folderSelect = document.getElementById('filterFolder');
    if (!folderSelect) return;
    
    database.ref('folders').on('value', (snapshot) => {
      folderSelect.innerHTML = '<option value="">Semua Folder</option>';
      folderSelect.innerHTML += '<option value="__none__">üìÇ Random</option>';
      
      if (snapshot.exists()) {
        const folders = [];
        snapshot.forEach((child) => {
          folders.push({
            id: child.key,
            ...child.val()
          });
        });
        
        folders.sort((a, b) => a.name.localeCompare(b.name));
        
        folders.forEach(folder => {
          const option = document.createElement('option');
          option.value = folder.id;
          option.textContent = `üìÅ ${folder.name}`;
          folderSelect.appendChild(option);
        });
      }
    });
  }
  
  // Toggle catatan menu (three dots)
  function toggleCatatanMenu(id) {
    const menu = document.getElementById('menu-' + id);
    const allMenus = document.querySelectorAll('.catatan-dropdown');
    
    // Close all other menus
    allMenus.forEach(m => {
      if (m.id !== 'menu-' + id) {
        m.classList.remove('show');
      }
    });
    
    // Toggle current menu
    menu.classList.toggle('show');
  }
  
  // Toggle submenu untuk Edit (untuk mobile)
  function toggleSubmenu(event, id) {
    // Untuk desktop, hover sudah handle submenu
    // Untuk mobile, kita perlu toggle manual
    if (window.innerWidth <= 768) {
      event.stopPropagation();
      const submenuParent = event.currentTarget;
      submenuParent.classList.toggle('active');
    }
  }
  
  // Close menus when clicking outside
  document.addEventListener('click', (e) => {
    if (!e.target.closest('.catatan-menu')) {
      document.querySelectorAll('.catatan-dropdown').forEach(menu => {
        menu.classList.remove('show');
      });
      document.querySelectorAll('.has-submenu').forEach(item => {
        item.classList.remove('active');
      });
    }
  });
  
  // Copy catatan to clipboard
  async function copyCatatan(id) {
    // Close menu
    toggleCatatanMenu(id);
    
    // Get catatan data
    database.ref('catatan/' + id).once('value', async (snapshot) => {
      if (!snapshot.exists()) return;
      
      const data = snapshot.val();
      const textToCopy = data.text;
      
      try {
        // Try modern clipboard API first
        if (navigator.clipboard && navigator.clipboard.writeText) {
          await navigator.clipboard.writeText(textToCopy);
          showNotification('üìã Catatan berhasil dicopy!');
        } else {
          // Fallback for older browsers
          const textarea = document.createElement('textarea');
          textarea.value = textToCopy;
          textarea.style.position = 'fixed';
          textarea.style.opacity = '0';
          document.body.appendChild(textarea);
          textarea.select();
          document.execCommand('copy');
          document.body.removeChild(textarea);
          showNotification('üìã Catatan berhasil dicopy!');
        }
      } catch (error) {
        console.error('Error copying:', error);
        showNotification('‚ùå Gagal copy catatan!');
      }
    });
  }
  
  // Edit catatan AUTHOR (Penulis)
  function editCatatanAuthor(id) {
    // Close all menus
    document.querySelectorAll('.catatan-dropdown').forEach(menu => {
      menu.classList.remove('show');
    });
    
    // Get catatan data
    database.ref('catatan/' + id).once('value', (snapshot) => {
      if (!snapshot.exists()) return;
      
      const data = snapshot.val();
      
      // Create edit modal for author
      const modal = document.createElement('div');
      modal.className = 'edit-modal';
      modal.innerHTML = `
        <div class="edit-modal-content">
          <div class="edit-modal-header">
            <h3>üë§ Edit Penulis</h3>
            <button class="edit-modal-close" onclick="this.closest('.edit-modal').remove()">√ó</button>
          </div>
          <div style="margin-bottom: 20px;">
            <label style="display: block; margin-bottom: 10px; font-size: 14px; opacity: 0.8;">Pilih Penulis:</label>
            <select id="editAuthor-${id}" class="catatan-author-select" style="width: 100%; padding: 12px 15px; font-size: 15px;">
              <option value="BF" ${data.author === 'BF' ? 'selected' : ''}>BF (Boyfriend)</option>
              <option value="GF" ${data.author === 'GF' ? 'selected' : ''}>GF (Girlfriend)</option>
            </select>
          </div>
          <div class="edit-modal-actions">
            <button class="edit-modal-btn cancel" onclick="this.closest('.edit-modal').remove()">Batal</button>
            <button class="edit-modal-btn save" onclick="saveCatatanAuthor('${id}')">üíæ Simpan</button>
          </div>
        </div>
      `;
      
      document.body.appendChild(modal);
      
      // Focus select
      document.getElementById('editAuthor-' + id).focus();
      
      // Close on backdrop click
      modal.addEventListener('click', (e) => {
        if (e.target === modal) modal.remove();
      });
    });
  }
  
  // Save catatan author edit
  async function saveCatatanAuthor(id) {
    const select = document.getElementById('editAuthor-' + id);
    const newAuthor = select.value;
    
    if (!newAuthor) {
      showNotification('‚ö†Ô∏è Pilih penulis!');
      return;
    }
    
    try {
      await database.ref('catatan/' + id).update({
        author: newAuthor,
        editedAt: Date.now(),
        editedDate: new Date().toLocaleString('id-ID')
      });
      
      // Close modal
      document.querySelector('.edit-modal').remove();
      
      showNotification('‚úÖ Penulis berhasil diupdate!');
    } catch (error) {
      console.error('Error updating author:', error);
      showNotification('‚ùå Gagal mengupdate penulis!');
    }
  }
  
  // Edit catatan TEXT (Isi Catatan)
  function editCatatanText(id) {
    // Close all menus
    document.querySelectorAll('.catatan-dropdown').forEach(menu => {
      menu.classList.remove('show');
    });
    
    // Get catatan data
    database.ref('catatan/' + id).once('value', (snapshot) => {
      if (!snapshot.exists()) return;
      
      const data = snapshot.val();
      
      // Create edit modal
      const modal = document.createElement('div');
      modal.className = 'edit-modal';
      modal.innerHTML = `
        <div class="edit-modal-content">
          <div class="edit-modal-header">
            <h3>üìù Edit Catatan</h3>
            <button class="edit-modal-close" onclick="this.closest('.edit-modal').remove()">√ó</button>
          </div>
          <textarea class="edit-modal-textarea" id="editText-${id}" maxlength="2000">${escapeHtml(data.text)}</textarea>
          <div class="char-counter" id="editCharCounter-${id}">
            <span id="editCharCount-${id}">${data.text.length}</span> / 2000 karakter
          </div>
          <div class="edit-modal-actions">
            <button class="edit-modal-btn cancel" onclick="this.closest('.edit-modal').remove()">Batal</button>
            <button class="edit-modal-btn save" onclick="saveCatatanText('${id}')">üíæ Simpan</button>
          </div>
        </div>
      `;
      
      document.body.appendChild(modal);
      
      // Focus textarea
      const editTextarea = document.getElementById('editText-' + id);
      const editCharCount = document.getElementById('editCharCount-' + id);
      const editCharCounter = document.getElementById('editCharCounter-' + id);
      
      editTextarea.focus();
      
      // Add character counter update
      editTextarea.addEventListener('input', () => {
        const length = editTextarea.value.length;
        editCharCount.textContent = length;
        
        // Change color based on length
        if (length >= 1800) {
          editCharCounter.classList.add('danger');
          editCharCounter.classList.remove('warning');
        } else if (length >= 1500) {
          editCharCounter.classList.add('warning');
          editCharCounter.classList.remove('danger');
        } else {
          editCharCounter.classList.remove('warning', 'danger');
        }
      });
      
      // Close on backdrop click
      modal.addEventListener('click', (e) => {
        if (e.target === modal) modal.remove();
      });
    });
  }
  
  // Save catatan text edit
  async function saveCatatanText(id) {
    const textarea = document.getElementById('editText-' + id);
    const newText = textarea.value.trim();
    
    if (!newText) {
      showNotification('‚ö†Ô∏è Catatan tidak boleh kosong!');
      return;
    }
    
    if (newText.length > 2000) {
      showNotification('‚ö†Ô∏è Catatan terlalu panjang! Maksimal 2000 karakter.');
      return;
    }
    
    try {
      await database.ref('catatan/' + id).update({
        text: newText,
        editedAt: Date.now(),
        editedDate: new Date().toLocaleString('id-ID')
      });
      
      // Close modal
      document.querySelector('.edit-modal').remove();
      
      showNotification('‚úÖ Catatan berhasil diupdate!');
    } catch (error) {
      console.error('Error updating catatan:', error);
      showNotification('‚ùå Gagal mengupdate catatan!');
    }
  }
  
  // Edit catatan FOLDER
  function editCatatanFolder(id) {
    // Close all menus
    document.querySelectorAll('.catatan-dropdown').forEach(menu => {
      menu.classList.remove('show');
    });
    
    // Get catatan data and folders
    Promise.all([
      database.ref('catatan/' + id).once('value'),
      database.ref('folders').once('value')
    ]).then(([catatanSnapshot, foldersSnapshot]) => {
      if (!catatanSnapshot.exists()) return;
      
      const data = catatanSnapshot.val();
      
      // Build folder options
      let folderOptions = '<option value="">-- Tidak ada folder --</option>';
      if (foldersSnapshot.exists()) {
        const folders = [];
        foldersSnapshot.forEach((child) => {
          folders.push({
            id: child.key,
            ...child.val()
          });
        });
        
        folders.sort((a, b) => a.name.localeCompare(b.name));
        
        folders.forEach(folder => {
          const selected = data.folderId === folder.id ? 'selected' : '';
          folderOptions += `<option value="${folder.id}" ${selected}>üìÅ ${escapeHtml(folder.name)}</option>`;
        });
      }
      
      // Create edit modal for folder
      const modal = document.createElement('div');
      modal.className = 'edit-modal';
      modal.innerHTML = `
        <div class="edit-modal-content">
          <div class="edit-modal-header">
            <h3>üìÅ Edit Folder</h3>
            <button class="edit-modal-close" onclick="this.closest('.edit-modal').remove()">√ó</button>
          </div>
          <div style="margin-bottom: 20px;">
            <label style="display: block; margin-bottom: 10px; font-size: 14px; opacity: 0.8;">Pilih Folder:</label>
            <select id="editFolder-${id}" class="catatan-folder-select" style="width: 100%; padding: 12px 15px; font-size: 15px;">
              ${folderOptions}
            </select>
            <div style="margin-top: 10px; font-size: 13px; opacity: 0.6;">
              üí° Tip: Kelola folder di tombol ‚öôÔ∏è pada form input catatan
            </div>
          </div>
          <div class="edit-modal-actions">
            <button class="edit-modal-btn cancel" onclick="this.closest('.edit-modal').remove()">Batal</button>
            <button class="edit-modal-btn save" onclick="saveCatatanFolder('${id}')">üíæ Simpan</button>
          </div>
        </div>
      `;
      
      document.body.appendChild(modal);
      
      // Focus select
      document.getElementById('editFolder-' + id).focus();
      
      // Close on backdrop click
      modal.addEventListener('click', (e) => {
        if (e.target === modal) modal.remove();
      });
    });
  }
  
  // Save catatan folder edit
  async function saveCatatanFolder(id) {
    const select = document.getElementById('editFolder-' + id);
    const newFolderId = select.value || null;
    
    try {
      await database.ref('catatan/' + id).update({
        folderId: newFolderId,
        editedAt: Date.now(),
        editedDate: new Date().toLocaleString('id-ID')
      });
      
      // Close modal
      document.querySelector('.edit-modal').remove();
      
      showNotification('‚úÖ Folder berhasil diupdate!');
    } catch (error) {
      console.error('Error updating folder:', error);
      showNotification('‚ùå Gagal mengupdate folder!');
    }
  }
  
  // Hapus catatan
  async function deleteCatatan(id) {
    // Close menu
    const menu = document.getElementById('menu-' + id);
    if (menu) menu.classList.remove('show');
    
    if (!confirm('Hapus catatan ini?')) return;
    
    try {
      await database.ref('catatan/' + id).remove();
      showNotification('üóëÔ∏è Catatan dihapus!');
    } catch (error) {
      console.error('Error deleting catatan:', error);
      showNotification('‚ùå Gagal menghapus catatan!');
    }
  }
  
  // ============================================
  // üìÅ FOLDER MANAGEMENT FUNCTIONS
  // ============================================
  
  // Load folders untuk dropdown dan filter
  function loadFolders() {
    const folderSelect = document.getElementById('catatanFolder');
    if (!folderSelect) return;
    
    database.ref('folders').on('value', (snapshot) => {
      // Keep default option
      folderSelect.innerHTML = '<option value="">-- Random --</option>';
      
      if (snapshot.exists()) {
        const folders = [];
        snapshot.forEach((child) => {
          folders.push({
            id: child.key,
            ...child.val()
          });
        });
        
        // Sort by name
        folders.sort((a, b) => a.name.localeCompare(b.name));
        
        folders.forEach(folder => {
          const option = document.createElement('option');
          option.value = folder.id;
          option.textContent = `üìÅ ${folder.name}`;
          folderSelect.appendChild(option);
        });
      }
    });
  }
  
  // ============================================
  // üîß QUICK FOLDER ADD FUNCTIONS
  // ============================================
  
  function toggleQuickFolderAdd() {
    const quickAdd = document.getElementById('quickFolderAdd');
    const input = document.getElementById('quickFolderName');
    
    if (quickAdd.style.display === 'none') {
      quickAdd.style.display = 'flex';
      input.focus();
    } else {
      quickAdd.style.display = 'none';
      input.value = '';
    }
  }
  
  async function createFolderQuick() {
    const input = document.getElementById('quickFolderName');
    const name = input.value.trim();
    
    if (!name) {
      showNotification('‚ö†Ô∏è Masukkan nama folder!');
      return;
    }
    
    if (name.length > 30) {
      showNotification('‚ö†Ô∏è Nama folder maksimal 30 karakter!');
      return;
    }
    
    try {
      const newFolderRef = database.ref('folders').push();
      const folderId = newFolderRef.key;
      
      await newFolderRef.set({
        name: name,
        createdAt: Date.now(),
        createdDate: new Date().toLocaleString('id-ID')
      });
      
      // Clear input and hide
      input.value = '';
      toggleQuickFolderAdd();
      
      // Auto-select the new folder (wait for real-time update)
      setTimeout(() => {
        document.getElementById('catatanFolder').value = folderId;
      }, 300);
      
      showNotification('‚úÖ Folder "' + name + '" berhasil dibuat!');
    } catch (error) {
      console.error('Error creating folder:', error);
      showNotification('‚ùå Gagal membuat folder!');
    }
  }
  
  // Enter key untuk quick folder add
  document.addEventListener('DOMContentLoaded', () => {
    const quickInput = document.getElementById('quickFolderName');
    if (quickInput) {
      quickInput.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
          e.preventDefault();
          createFolderQuick();
        } else if (e.key === 'Escape') {
          toggleQuickFolderAdd();
        }
      });
    }
  });

  // ============================================
  // üìÅ FOLDER MANAGER FUNCTIONS (Original)
  // ============================================
  
  function openFolderManager() {
    const modal = document.createElement('div');
    modal.className = 'folder-manager-modal';
    modal.id = 'folderManager';
    modal.innerHTML = `
      <div class="folder-manager-content">
        <div class="folder-manager-header">
          <h3>üìÅ Kelola Folder</h3>
          <button class="folder-manager-close" onclick="closeFolderManager()">√ó</button>
        </div>
        
        <div class="folder-create-area">
          <h4>‚ûï Buat Folder Baru</h4>
          <div class="folder-create-form">
            <input 
              type="text" 
              id="newFolderName" 
              class="folder-name-input" 
              placeholder="Nama folder (misal: Liburan Bali)"
              maxlength="50"
            />
            <button class="folder-create-btn" onclick="createFolder()">
              Buat
            </button>
          </div>
        </div>
        
        <div class="folder-list">
          <h4>üìÇ Folder Tersedia</h4>
          <div id="folderListContainer"></div>
        </div>
      </div>
    `;
    
    document.body.appendChild(modal);
    
    // Load existing folders
    loadFolderList();
    
    // Close on backdrop click
    modal.addEventListener('click', (e) => {
      if (e.target === modal) closeFolderManager();
    });
    
    // Focus input
    document.getElementById('newFolderName').focus();
    
    // Enter to create
    document.getElementById('newFolderName').addEventListener('keydown', (e) => {
      if (e.key === 'Enter') {
        e.preventDefault();
        createFolder();
      }
    });
  }
  
  // Close folder manager
  function closeFolderManager() {
    const modal = document.getElementById('folderManager');
    if (modal) modal.remove();
  }
  
  // Create new folder
  async function createFolder() {
    const input = document.getElementById('newFolderName');
    const name = input.value.trim();
    
    if (!name) {
      showNotification('‚ö†Ô∏è Masukkan nama folder!');
      return;
    }
    
    if (name.length > 50) {
      showNotification('‚ö†Ô∏è Nama folder terlalu panjang! Maksimal 50 karakter.');
      return;
    }
    
    try {
      const newFolderRef = database.ref('folders').push();
      await newFolderRef.set({
        name: name,
        createdAt: Date.now(),
        createdDate: new Date().toLocaleString('id-ID')
      });
      
      input.value = '';
      showNotification('‚úÖ Folder berhasil dibuat!');
      loadFolderList();
    } catch (error) {
      console.error('Error creating folder:', error);
      showNotification('‚ùå Gagal membuat folder!');
    }
  }
  
  // Load folder list for manager
  function loadFolderList() {
    const container = document.getElementById('folderListContainer');
    if (!container) return;
    
    database.ref('folders').once('value', async (snapshot) => {
      if (!snapshot.exists()) {
        container.innerHTML = `
          <div class="folder-empty-state">
            <div class="folder-empty-state-icon">üìÇ</div>
            <div>Belum ada folder. Buat folder baru di atas!</div>
          </div>
        `;
        return;
      }
      
      const folders = [];
      snapshot.forEach((child) => {
        folders.push({
          id: child.key,
          ...child.val()
        });
      });
      
      // Sort by name
      folders.sort((a, b) => a.name.localeCompare(b.name));
      
      // Get catatan count for each folder
      const catatanSnapshot = await database.ref('catatan').once('value');
      const catatanCounts = {};
      
      if (catatanSnapshot.exists()) {
        catatanSnapshot.forEach((child) => {
          const data = child.val();
          if (data.folderId) {
            catatanCounts[data.folderId] = (catatanCounts[data.folderId] || 0) + 1;
          }
        });
      }
      
      container.innerHTML = '';
      folders.forEach(folder => {
        const count = catatanCounts[folder.id] || 0;
        const item = document.createElement('div');
        item.className = 'folder-item';
        item.innerHTML = `
          <div class="folder-item-info">
            <div class="folder-item-icon">üìÅ</div>
            <div class="folder-item-details">
              <div class="folder-item-name">${escapeHtml(folder.name)}</div>
              <div class="folder-item-count">${count} catatan</div>
            </div>
          </div>
          <div class="folder-item-actions">
            <button class="folder-action-btn" onclick="renameFolder('${folder.id}', '${escapeHtml(folder.name)}')">
              ‚úèÔ∏è Edit
            </button>
            <button class="folder-action-btn delete" onclick="deleteFolder('${folder.id}', '${escapeHtml(folder.name)}')">
              üóëÔ∏è Hapus
            </button>
          </div>
        `;
        container.appendChild(item);
      });
    });
  }
  
  // Rename folder
  async function renameFolder(id, currentName) {
    const newName = prompt('Nama folder baru:', currentName);
    if (!newName || newName.trim() === '') return;
    if (newName.trim() === currentName) return;
    
    if (newName.length > 50) {
      showNotification('‚ö†Ô∏è Nama folder terlalu panjang! Maksimal 50 karakter.');
      return;
    }
    
    try {
      await database.ref('folders/' + id).update({
        name: newName.trim(),
        editedAt: Date.now()
      });
      
      showNotification('‚úÖ Folder berhasil diubah!');
      loadFolderList();
    } catch (error) {
      console.error('Error renaming folder:', error);
      showNotification('‚ùå Gagal mengubah folder!');
    }
  }
  
  // Delete folder
  async function deleteFolder(id, name) {
    // Check if folder has catatan
    const catatanSnapshot = await database.ref('catatan').orderByChild('folderId').equalTo(id).once('value');
    const count = catatanSnapshot.numChildren();
    
    let confirmMsg = `Hapus folder "${name}"?`;
    if (count > 0) {
      confirmMsg = `Folder "${name}" memiliki ${count} catatan. Catatan tidak akan dihapus, hanya folder-nya. Lanjutkan?`;
    }
    
    if (!confirm(confirmMsg)) return;
    
    try {
      // Remove folder
      await database.ref('folders/' + id).remove();
      
      // Remove folderId from all catatan in this folder
      if (count > 0) {
        const updates = {};
        catatanSnapshot.forEach((child) => {
          updates[`catatan/${child.key}/folderId`] = null;
        });
        await database.ref().update(updates);
      }
      
      showNotification('üóëÔ∏è Folder dihapus!');
      loadFolderList();
    } catch (error) {
      console.error('Error deleting folder:', error);
      showNotification('‚ùå Gagal menghapus folder!');
    }
  }
  
  // Helper function untuk escape HTML (mencegah XSS)
  function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
  }
  
  // Enter key untuk submit catatan
  document.addEventListener('DOMContentLoaded', () => {
    const catatanTextarea = document.getElementById('catatanText');
    const charCount = document.getElementById('catatanCharCount');
    const charCounter = document.getElementById('catatanCharCounter');
    
    if (catatanTextarea) {
      // Update character counter
      catatanTextarea.addEventListener('input', () => {
        const length = catatanTextarea.value.length;
        charCount.textContent = length;
        
        // Change color based on length
        if (length >= 1800) {
          charCounter.classList.add('danger');
          charCounter.classList.remove('warning');
        } else if (length >= 1500) {
          charCounter.classList.add('warning');
          charCounter.classList.remove('danger');
        } else {
          charCounter.classList.remove('warning', 'danger');
        }
      });
      
      // Ctrl/Cmd + Enter untuk submit
      catatanTextarea.addEventListener('keydown', (e) => {
        // Ctrl/Cmd + Enter untuk submit
        if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
          e.preventDefault();
          addCatatan();
        }
      });
    }
  });

  // ============================================
  // 6Ô∏è‚É£ AUTO-LOAD SAAT PAGE LOAD
  // ============================================
  
  // Load data ketika page selesai load
  window.addEventListener('load', () => {
    console.log('üöÄ Loading Firebase data...');
    
    setTimeout(() => {
      loadMemories();
      loadSavedLetters();
      loadCatatan(); // Load catatan bersama
      loadFolders(); // Load folders untuk dropdown
      // Default: tampilkan view folder
      switchCatatanView('folder');
    }, 1000);
  });

  // ============================================
  // 6Ô∏è‚É£ HELPER FUNCTIONS
  // ============================================
  
  // Clear all data (untuk testing)
  async function clearAllData() {
    if (!confirm('‚ö†Ô∏è Hapus SEMUA data? Ini tidak bisa di-undo!')) return;
    if (!confirm('Yakin banget?')) return;
    
    try {
      await database.ref('memories').remove();
      await database.ref('loveletters').remove();
      await database.ref('gamescores').remove();
      await database.ref('catatan').remove();
      await database.ref('folders').remove();
      
      showNotification('üóëÔ∏è Semua data dihapus!');
      loadMemories();
      loadSavedLetters();
      loadCatatan();
      loadFolders();
    } catch (error) {
      console.error('Error clearing data:', error);
    }
  }

  console.log('‚úÖ Firebase integration loaded!');
  console.log('üí° Available functions:');
  console.log('  - addMemory(), loadMemories(), deleteMemory(id)');
  console.log('  - saveLetter(), loadSavedLetters(), deleteLetter(id), viewLetter(id)');
  console.log('  - saveGameScore(name, score), getHighScore(name, callback)');
  console.log('  - addCatatan(), loadCatatan(), deleteCatatan(id)');
  console.log('  - clearAllData()');
</script>

</body>
</html>
